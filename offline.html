<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="theme-color" content="#0077b6">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="Farm Manager">
  <meta name="msapplication-TileColor" content="#0077b6">
  <meta name="msapplication-tap-highlight" content="no">
  <title>Farm Manager</title>
  <link rel="manifest" href="https://apphosting-vh.github.io/farmxv9/manifest.json">
  <link rel="icon" type="image/png" sizes="192x192" href="/icon-192.png">
  <link rel="apple-touch-icon" href="/icon-192.png">
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <style>
    * { box-sizing: border-box; }
    body { margin:0; padding:0; font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif; -webkit-font-smoothing:antialiased; overflow:hidden; overscroll-behavior-y:contain; }
    #root { height:100vh; width:100vw; overflow:auto; }
    #loading { position:fixed; top:0; left:0; right:0; bottom:0; background:linear-gradient(135deg,#0077b6 0%,#005f8e 100%); display:flex; flex-direction:column; align-items:center; justify-content:center; color:white; z-index:9999; }
    #loading h1 { font-size:32px; margin:0 0 16px 0; }
    .loading-spinner { width:50px; height:50px; border:4px solid rgba(255,255,255,0.3); border-top-color:white; border-radius:50%; animation:spin 1s linear infinite; }
    @keyframes spin { to { transform:rotate(360deg); } }
  </style>
</head>
<body>
  <div id="loading"><h1>ðŸŒ¾ Farm Manager</h1><div class="loading-spinner"></div><p style="margin-top:16px;opacity:0.9">Loading...</p></div>
  <div id="root"></div>
  <script type="text/babel">
// Farm Manager - Browser-Compatible Version
const { useState, useEffect } = React;

// Custom hook for localStorage persistence
const useLocalStorage = (key, initialValue) => {
  const [value, setValue] = useState(() => {
    try {
      const item = window.localStorage.getItem(key);
      return item ? JSON.parse(item) : initialValue;
    } catch {
      return initialValue;
    }
  });

  useEffect(() => {
    window.localStorage.setItem(key, JSON.stringify(value));
  }, [key, value]);

  return [value, setValue];
};

function FarmWageManager() {
  // Theme definitions
  const themes = {
    default: {
      name: 'Ocean Blue',
      primary: '#0077b6',
      secondary: '#005f8e',
      accent: '#00b4d8',
      background: 'linear-gradient(135deg, #caf0f8 0%, #90e0ef 100%)',
      cardBg: 'white',
      textPrimary: '#03045e',
      textSecondary: '#0096c7',
      success: '#1e7d32',
      warning: '#f9a825',
      danger: '#b71c1c',
      successLight: '#2e7d32',
      warningLight: '#fbc02d',
      dangerLight: '#c62828'
    },
    ocean: {
      name: 'Ocean Blue',
      primary: '#0077b6',
      secondary: '#005f8e',
      accent: '#00b4d8',
      background: 'linear-gradient(135deg, #caf0f8 0%, #90e0ef 100%)',
      cardBg: 'white',
      textPrimary: '#03045e',
      textSecondary: '#0096c7',
      success: '#1b5e20',
      warning: '#f9a825',
      danger: '#b71c1c',
      successLight: '#2e7d32',
      warningLight: '#fbc02d',
      dangerLight: '#c62828'
    },
    sunset: {
      name: 'Sunset Glow',
      primary: '#d84315',
      secondary: '#bf360c',
      accent: '#ff8a65',
      background: 'linear-gradient(135deg, #fff3e0 0%, #ffccbc 100%)',
      cardBg: 'white',
      textPrimary: '#3e2723',
      textSecondary: '#6d4c41',
      success: '#1b5e20',
      warning: '#f9a825', // Dark yellow for half day
      danger: '#b71c1c',
      successLight: '#2e7d32',
      warningLight: '#fbc02d',
      dangerLight: '#c62828'
    },
    forest: {
      name: 'Forest Green',
      primary: '#2e7d32',
      secondary: '#1b5e20',
      accent: '#66bb6a',
      background: 'linear-gradient(135deg, #e8f5e9 0%, #a5d6a7 100%)',
      cardBg: 'white',
      textPrimary: '#1b5e20',
      textSecondary: '#558b2f',
      success: '#1b5e20',
      warning: '#f9a825', // Dark yellow for half day
      danger: '#b71c1c',
      successLight: '#2e7d32',
      warningLight: '#fbc02d',
      dangerLight: '#c62828'
    },
    lavender: {
      name: 'Lavender Dreams',
      primary: '#6a1b9a',
      secondary: '#4a148c',
      accent: '#ba68c8',
      background: 'linear-gradient(135deg, #f3e5f5 0%, #ce93d8 100%)',
      cardBg: 'white',
      textPrimary: '#4a148c',
      textSecondary: '#7b1fa2',
      success: '#1b5e20',
      warning: '#f9a825', // Dark yellow for half day
      danger: '#b71c1c',
      successLight: '#2e7d32',
      warningLight: '#fbc02d',
      dangerLight: '#c62828'
    },
    midnight: {
      name: 'Midnight Blue',
      primary: '#1a237e',
      secondary: '#0d47a1',
      accent: '#5c6bc0',
      background: 'linear-gradient(135deg, #e8eaf6 0%, #9fa8da 100%)',
      cardBg: 'white',
      textPrimary: '#1a237e',
      textSecondary: '#283593',
      success: '#1b5e20',
      warning: '#f9a825', // Dark yellow for half day
      danger: '#b71c1c',
      successLight: '#2e7d32',
      warningLight: '#fbc02d',
      dangerLight: '#c62828'
    }
  };

  // Format date as YYYY-MM-DD in local timezone (avoid UTC conversion issues)
  const formatLocalDate = (date) => {
    const year = date.getFullYear();
    const month = String(date.getMonth() + 1).padStart(2, '0');
    const day = String(date.getDate()).padStart(2, '0');
    return `${year}-${month}-${day}`;
  };

  // Format date as YYYY-MM in local timezone (avoid UTC conversion issues)
  const formatLocalMonth = (date) => {
    const year = date.getFullYear();
    const month = String(date.getMonth() + 1).padStart(2, '0');
    return `${year}-${month}`;
  };

  const [workers, setWorkers] = useLocalStorage('farmWorkers', []);
  const [attendance, setAttendance] = useLocalStorage('farmAttendance', []);
  const [payments, setPayments] = useLocalStorage('farmPayments', []);
  const [specialNotes, setSpecialNotes] = useLocalStorage('farmSpecialNotes', []);
  const [seasonalWorks, setSeasonalWorks] = useLocalStorage('farmSeasonalWorks', []);
  const [expenses, setExpenses] = useLocalStorage('farmExpenses', []);
  const [currentTheme, setCurrentTheme] = useLocalStorage('farmTheme', 'ocean');
  const theme = themes[currentTheme] || themes.default;
  const [showInactiveWorkers, setShowInactiveWorkers] = useState(false);
  const [activeView, setActiveView] = useState('attendance');
  const [selectedDate, setSelectedDate] = useState(() => formatLocalDate(new Date()));
  const [showAddWorker, setShowAddWorker] = useState(false);
  const [editingWorker, setEditingWorker] = useState(null);
  const [newWorker, setNewWorker] = useState({ 
    name: '', 
    dailyWage: '', 
    phone: '', 
    openingBalance: '0',
    type: 'regular', // 'regular' or 'seasonal'
    active: true,
    createdAt: new Date().toISOString().split('T')[0] // Default to today in YYYY-MM-DD format
  });
  const [attendanceView, setAttendanceView] = useState('monthly'); // Only monthly now
  const [calendarDate, setCalendarDate] = useState(new Date());
  const [reportMonth, setReportMonth] = useState(new Date());
  const [reportType, setReportType] = useState('regular'); // 'regular' or 'seasonal'
  const [seasonalReportYear, setSeasonalReportYear] = useState(new Date().getFullYear());
  const [yearlySummaryYear, setYearlySummaryYear] = useState(new Date().getFullYear());
  const [showPaymentModal, setShowPaymentModal] = useState(false);
  const [selectedWorkerForPayment, setSelectedWorkerForPayment] = useState(null);
  const [paymentData, setPaymentData] = useState(() => ({ amount: '', notes: '', date: formatLocalDate(new Date()) }));
  const [editingPayment, setEditingPayment] = useState(null);
  const [paymentType, setPaymentType] = useState('payment'); // 'payment' or 'credit'
  const [showNoteModal, setShowNoteModal] = useState(false);
  const [noteData, setNoteData] = useState(() => ({ workerId: null, note: '', date: formatLocalDate(new Date()) }));
  const [showSeasonalModal, setShowSeasonalModal] = useState(false);
  const [editingSeasonalWork, setEditingSeasonalWork] = useState(null);
  const [seasonalData, setSeasonalData] = useState({ title: '', rateType: 'hourly', rate: '', startDate: '', endDate: '', totalConsumed: '', notes: '' });
  const [showExpenseModal, setShowExpenseModal] = useState(false);
  const [editingExpense, setEditingExpense] = useState(null);
  const [expenseData, setExpenseData] = useState(() => ({ title: '', cost: '', purchaseDate: formatLocalDate(new Date()), unit: '', quantity: '', notes: '' }));
  const [confirmDialog, setConfirmDialog] = useState({ show: false, message: '', onConfirm: null });
  
  // Phonebook state
  const [contacts, setContacts] = useLocalStorage('farmPhonebook', []);
  const [showContactModal, setShowContactModal] = useState(false);

  // General Notes state
  const [generalNotes, setGeneralNotes] = useLocalStorage('farmGeneralNotes', []);
  const [showGeneralNoteModal, setShowGeneralNoteModal] = useState(false);
  const [editingGeneralNote, setEditingGeneralNote] = useState(null);
  const [generalNoteData, setGeneralNoteData] = useState({ title: '', body: '' });
  const [editingContact, setEditingContact] = useState(null);
  const [contactData, setContactData] = useState({ name: '', location: '', phone: '', whatsapp: '', rate: '', notes: '' });
  const [contactSearch, setContactSearch] = useState('');

  // Contract Work state
  const [contractWorks, setContractWorks] = useLocalStorage('farmContractWorks', []);
  const [showContractModal, setShowContractModal] = useState(false);
  const [editingContract, setEditingContract] = useState(null);
  const [contractData, setContractData] = useState(() => ({ 
    workTitle: '', 
    supervisor: '', 
    numberOfPeople: '', 
    date: formatLocalDate(new Date()), 
    paymentDone: '', 
    contractCost: '',
    totalItemCost: '',
    totalLaborCost: '',
    notes: '',
    items: [{ name: '', qty: '', unit: '', cost: '' }]
  }));
  
  // Google Drive Picker state
  const [googleClientId, setGoogleClientId] = useLocalStorage('googleClientId', '');
  const [googleApiKey, setGoogleApiKey] = useLocalStorage('googleApiKey', '');
  const [googlePickerInited, setGooglePickerInited] = useState(false);
  const [googleAccessToken, setGoogleAccessToken] = useState('');
  const [showGoogleConfig, setShowGoogleConfig] = useState(false);

  // Add worker
  const addWorker = () => {
    if (!newWorker.name || !newWorker.dailyWage) return;
    
    if (editingWorker) {
      setWorkers(workers.map(w => 
        w.id === editingWorker.id 
          ? { 
              ...w, 
              ...newWorker, 
              dailyWage: parseFloat(newWorker.dailyWage),
              openingBalance: parseFloat(newWorker.openingBalance || 0),
              type: newWorker.type || 'regular',
              active: newWorker.active !== undefined ? newWorker.active : true,
              createdAt: newWorker.createdAt ? new Date(newWorker.createdAt).toISOString() : w.createdAt
            }
          : w
      ));
      setEditingWorker(null);
    } else {
      setWorkers([...workers, {
        id: Date.now(),
        ...newWorker,
        dailyWage: parseFloat(newWorker.dailyWage),
        openingBalance: parseFloat(newWorker.openingBalance || 0),
        type: newWorker.type || 'regular',
        active: true,
        createdAt: newWorker.createdAt ? new Date(newWorker.createdAt).toISOString() : new Date().toISOString()
      }]);
    }
    
    setNewWorker({ 
      name: '', 
      dailyWage: '', 
      phone: '', 
      openingBalance: '0', 
      type: 'regular', 
      active: true,
      createdAt: new Date().toISOString().split('T')[0] // Reset to today
    });
    setShowAddWorker(false);
  };

  // Delete worker
  const deleteWorker = (id) => {
    const worker = workers.find(w => w.id === id);
    setConfirmDialog({
      show: true,
      message: `Sure, you want to Delete ${worker?.name || 'this worker'}?`,
      onConfirm: () => {
        setWorkers(workers.filter(w => w.id !== id));
        setAttendance(attendance.filter(a => a.workerId !== id));
        setPayments(payments.filter(p => p.workerId !== id));
        setConfirmDialog({ show: false, message: '', onConfirm: null });
      }
    });
  };

  // Toggle worker active status
  const toggleWorkerStatus = (workerId) => {
    setWorkers(workers.map(w =>
      w.id === workerId ? { ...w, active: !w.active } : w
    ));
  };

  // Seasonal Work Management
  const addSeasonalWorkFromModal = () => {
    if (!seasonalData.title || !seasonalData.rate || !seasonalData.startDate || !seasonalData.endDate || !seasonalData.totalConsumed) {
      alert('Please fill in all required fields');
      return;
    }
    
    if (editingSeasonalWork) {
      // Update existing seasonal work
      setSeasonalWorks(seasonalWorks.map(sw =>
        sw.id === editingSeasonalWork.id
          ? {
              ...sw,
              title: seasonalData.title,
              rateType: seasonalData.rateType,
              rate: parseFloat(seasonalData.rate),
              startDate: seasonalData.startDate,
              endDate: seasonalData.endDate,
              totalConsumed: parseFloat(seasonalData.totalConsumed),
              notes: seasonalData.notes
            }
          : sw
      ));
      setEditingSeasonalWork(null);
    } else {
      // Add new seasonal work
      addSeasonalWork({
        title: seasonalData.title,
        rateType: seasonalData.rateType,
        rate: parseFloat(seasonalData.rate),
        startDate: seasonalData.startDate,
        endDate: seasonalData.endDate,
        totalConsumed: parseFloat(seasonalData.totalConsumed),
        notes: seasonalData.notes,
        assignedWorkers: []
      });
    }
    
    setSeasonalData({ title: '', rateType: 'hourly', rate: '', startDate: '', endDate: '', totalConsumed: '', notes: '' });
    setShowSeasonalModal(false);
  };

  const addSeasonalWork = (workData) => {
    setSeasonalWorks([...seasonalWorks, {
      id: Date.now(),
      ...workData,
      createdAt: new Date().toISOString()
    }]);
  };

  const editSeasonalWork = (work) => {
    setEditingSeasonalWork(work);
    setSeasonalData({
      title: work.title,
      rateType: work.rateType,
      rate: work.rate.toString(),
      startDate: work.startDate,
      endDate: work.endDate,
      totalConsumed: work.totalConsumed.toString(),
      notes: work.notes || ''
    });
    setShowSeasonalModal(true);
  };

  const deleteSeasonalWork = (id) => {
    setConfirmDialog({
      show: true,
      message: 'Sure, you want to Delete this seasonal work?',
      onConfirm: () => {
        setSeasonalWorks(seasonalWorks.filter(sw => sw.id !== id));
        setConfirmDialog({ show: false, message: '', onConfirm: null });
      }
    });
  };

  // Expense Management
  const addExpenseFromModal = () => {
    if (!expenseData.title || !expenseData.cost || !expenseData.unit || !expenseData.quantity) {
      alert('Please fill in all required fields');
      return;
    }
    
    if (editingExpense) {
      // Update existing expense
      setExpenses(expenses.map(e => 
        e.id === editingExpense.id
          ? {
              ...e,
              title: expenseData.title,
              cost: parseFloat(expenseData.cost),
              purchaseDate: expenseData.purchaseDate,
              unit: expenseData.unit,
              quantity: parseFloat(expenseData.quantity),
              notes: expenseData.notes
            }
          : e
      ));
      setEditingExpense(null);
    } else {
      // Add new expense
      addExpense({
        title: expenseData.title,
        cost: parseFloat(expenseData.cost),
        purchaseDate: expenseData.purchaseDate,
        unit: expenseData.unit,
        quantity: parseFloat(expenseData.quantity),
        notes: expenseData.notes
      });
    }
    
    setExpenseData({ title: '', cost: '', purchaseDate: formatLocalDate(new Date()), unit: '', quantity: '', notes: '' });
    setShowExpenseModal(false);
  };

  const addExpense = (expenseDataParam) => {
    setExpenses([...expenses, {
      id: Date.now(),
      ...expenseDataParam,
      createdAt: new Date().toISOString()
    }]);
  };

  const deleteExpense = (id) => {
    setConfirmDialog({
      show: true,
      message: 'Sure, you want to Delete this expense?',
      onConfirm: () => {
        setExpenses(expenses.filter(e => e.id !== id));
        setConfirmDialog({ show: false, message: '', onConfirm: null });
      }
    });
  };

  // General Notes Functions
  const saveGeneralNote = () => {
    if (!generalNoteData.title.trim() && !generalNoteData.body.trim()) {
      alert('Please enter a title or note content');
      return;
    }
    if (editingGeneralNote) {
      setGeneralNotes(generalNotes.map(n =>
        n.id === editingGeneralNote.id
          ? { ...n, title: generalNoteData.title, body: generalNoteData.body, updatedAt: new Date().toISOString() }
          : n
      ));
      setEditingGeneralNote(null);
    } else {
      setGeneralNotes([{
        id: Date.now().toString(),
        title: generalNoteData.title,
        body: generalNoteData.body,
        createdAt: new Date().toISOString(),
        updatedAt: new Date().toISOString()
      }, ...generalNotes]);
    }
    setGeneralNoteData({ title: '', body: '' });
    setShowGeneralNoteModal(false);
  };

  const editGeneralNote = (note) => {
    setEditingGeneralNote(note);
    setGeneralNoteData({ title: note.title, body: note.body });
    setShowGeneralNoteModal(true);
  };

  const deleteGeneralNote = (id) => {
    setConfirmDialog({
      show: true,
      message: 'Sure, you want to delete this note?',
      onConfirm: () => {
        setGeneralNotes(generalNotes.filter(n => n.id !== id));
        setConfirmDialog({ show: false, message: '', onConfirm: null });
      }
    });
  };

  // Phonebook Functions
  const saveContact = () => {
    if (!contactData.name.trim()) {
      alert('Please enter a contact name');
      return;
    }
    if (editingContact) {
      setContacts(contacts.map(c =>
        c.id === editingContact.id ? { ...c, ...contactData } : c
      ));
      setEditingContact(null);
    } else {
      setContacts([...contacts, {
        id: Date.now().toString(),
        ...contactData,
        createdAt: new Date().toISOString()
      }]);
    }
    setContactData({ name: '', location: '', phone: '', whatsapp: '', rate: '', notes: '' });
    setShowContactModal(false);
  };

  const editContactFn = (contact) => {
    setEditingContact(contact);
    setContactData({
      name: contact.name || '',
      location: contact.location || '',
      phone: contact.phone || '',
      whatsapp: contact.whatsapp || '',
      rate: contact.rate || '',
      notes: contact.notes || ''
    });
    setShowContactModal(true);
  };

  const deleteContact = (id) => {
    setConfirmDialog({
      show: true,
      message: 'Sure, you want to delete this contact?',
      onConfirm: () => {
        setContacts(contacts.filter(c => c.id !== id));
        setConfirmDialog({ show: false, message: '', onConfirm: null });
      }
    });
  };

  // Contract Work Functions
  const addContractWork = () => {
    if (!contractData.workTitle || !contractData.date) {
      alert('Please fill in Work Title and Date');
      return;
    }

    const paymentDone = parseFloat(contractData.paymentDone) || 0;

    const contractPayload = {
      workTitle: contractData.workTitle,
      supervisor: contractData.supervisor,
      numberOfPeople: contractData.numberOfPeople,
      date: contractData.date,
      paymentDone: paymentDone,
      contractCost: parseFloat(contractData.contractCost) || 0,
      totalItemCost: parseFloat(contractData.totalItemCost) || 0,
      totalLaborCost: parseFloat(contractData.totalLaborCost) || 0,
      notes: contractData.notes,
      items: contractData.items.filter(i => i.name.trim() !== '')
    };

    if (editingContract) {
      setContractWorks(contractWorks.map(cw =>
        cw.id === editingContract.id ? { ...cw, ...contractPayload } : cw
      ));
      setEditingContract(null);
    } else {
      setContractWorks([...contractWorks, {
        id: Date.now().toString(),
        ...contractPayload,
        createdAt: new Date().toISOString()
      }]);
    }

    // Reset form and close modal
    setContractData({
      workTitle: '',
      supervisor: '',
      numberOfPeople: '',
      date: formatLocalDate(new Date()),
      paymentDone: '',
      contractCost: '',
      totalItemCost: '',
      totalLaborCost: '',
      notes: '',
      items: [{ name: '', qty: '', unit: '', cost: '' }]
    });
    setShowContractModal(false);
  };

  const editContract = (contract) => {
    setEditingContract(contract);
    setContractData({
      workTitle: contract.workTitle,
      supervisor: contract.supervisor,
      numberOfPeople: contract.numberOfPeople,
      date: contract.date,
      paymentDone: (contract.paymentDone || 0).toString(),
      contractCost: (contract.contractCost || 0).toString(),
      totalItemCost: (contract.totalItemCost || 0).toString(),
      totalLaborCost: (contract.totalLaborCost || 0).toString(),
      notes: contract.notes || '',
      items: (contract.items && contract.items.length > 0)
        ? contract.items
        : [{ name: '', qty: '', unit: '', cost: '' }]
    });
    setShowContractModal(true);
  };

  const deleteContract = (id) => {
    setConfirmDialog({
      show: true,
      message: 'Sure, you want to Delete this contract work?',
      onConfirm: () => {
        setContractWorks(contractWorks.filter(cw => cw.id !== id));
        setConfirmDialog({ show: false, message: '', onConfirm: null });
      }
    });
  };

  // Add payment
  const addPayment = () => {
    if (!paymentData.amount || !selectedWorkerForPayment) return;
    
    if (editingPayment) {
      // Update existing payment
      setPayments(payments.map(p => 
        p.id === editingPayment.id 
          ? { ...p, amount: parseFloat(paymentData.amount), notes: paymentData.notes, date: paymentData.date }
          : p
      ));
      setEditingPayment(null);
    } else {
      // Add new payment or credit
      setPayments([...payments, {
        id: Date.now(),
        workerId: selectedWorkerForPayment.id,
        amount: parseFloat(paymentData.amount),
        notes: paymentData.notes,
        date: paymentData.date,
        type: paymentType, // 'payment' or 'credit'
        createdAt: new Date().toISOString()
      }]);
    }
    
    setPaymentData({ amount: '', notes: '', date: formatLocalDate(new Date()) });
    setSelectedWorkerForPayment(null);
    setShowPaymentModal(false);
    setPaymentType('payment');
  };

  // Delete payment
  const deletePayment = (paymentId) => {
    setConfirmDialog({
      show: true,
      message: 'Sure, you want to Delete this payment record?',
      onConfirm: () => {
        setPayments(payments.filter(p => p.id !== paymentId));
        setConfirmDialog({ show: false, message: '', onConfirm: null });
      }
    });
  };

  // Add special note
  const addSpecialNote = () => {
    if (!noteData.note || !noteData.workerId) return;
    
    setSpecialNotes([...specialNotes, {
      id: Date.now(),
      workerId: noteData.workerId,
      note: noteData.note,
      date: noteData.date,
      createdAt: new Date().toISOString()
    }]);
    
    setNoteData({ workerId: null, note: '', date: formatLocalDate(new Date()) });
    setShowNoteModal(false);
  };

  // Delete special note
  const deleteSpecialNote = (noteId) => {
    setConfirmDialog({
      show: true,
      message: 'Sure, you want to Delete this note?',
      onConfirm: () => {
        setSpecialNotes(specialNotes.filter(n => n.id !== noteId));
        setConfirmDialog({ show: false, message: '', onConfirm: null });
      }
    });
  };

  // Get special notes for a date
  const getSpecialNotes = (workerId, date) => {
    return specialNotes.filter(n => n.workerId === workerId && n.date === date);
  };

  // Get payments for a worker in a specific month
  const getWorkerPayments = (workerId, month) => {
    const monthStr = formatLocalMonth(month);
    return payments.filter(p => 
      p.workerId === workerId && p.date.startsWith(monthStr)
    );
  };

  // Calculate balance carried forward from previous months
  // ===== BALANCE CALCULATION SYSTEM =====
  // Terminology:
  // O (Opening Balance) = What we owed or what worker owes us at start of month
  // E (Earnings) = Worker earns, increases what we owe (+)
  // P (Payments) = We pay worker, decreases what we owe (-)
  // D (Credit Deposit) = Worker gives us money, decreases what we owe (-)
  // C (Closing Balance) = Net closing balance at end of month
  //
  // Formula: C = O + E - P - D
  // Positive C (GREEN) = We owe worker
  // Negative C (RED) = Worker owes us
  // Closing Balance (C) of current month becomes Opening Balance (O) of next month

  // Calculate Opening Balance (O) for a specific month
  const getOpeningBalance = (workerId, forMonth) => {
    const worker = workers.find(w => w.id === workerId);
    if (!worker) return 0;

    const monthDate = new Date(forMonth);
    monthDate.setDate(1);
    monthDate.setHours(0, 0, 0, 0);
    
    // For worker's first month, Opening Balance is the initial opening balance
    const workerCreated = new Date(worker.createdAt);
    const createdMonth = new Date(workerCreated.getFullYear(), workerCreated.getMonth(), 1);
    createdMonth.setHours(0, 0, 0, 0);
    
    // If requested month is the creation month, return initial opening balance
    if (monthDate.getTime() === createdMonth.getTime()) {
      return (worker.openingBalance || 0);
    }
    
    // If requested month is BEFORE creation month, return 0 (worker didn't exist yet)
    if (monthDate < createdMonth) {
      return 0;
    }
    
    // For subsequent months, Opening Balance = Previous month's Closing Balance
    const previousMonth = new Date(monthDate);
    previousMonth.setMonth(previousMonth.getMonth() - 1);
    
    return getClosingBalance(workerId, previousMonth);
  };

  // Calculate Closing Balance (C) for a specific month
  // Formula: C = O + E - P - D
  const getClosingBalance = (workerId, forMonth) => {
    const worker = workers.find(w => w.id === workerId);
    if (!worker) return 0;

    const monthDate = new Date(forMonth);
    const monthStr = formatLocalMonth(monthDate);
    
    // O (Opening Balance)
    const O = getOpeningBalance(workerId, monthDate);
    
    // E (Earnings) - Total wage earnings for the month
    const monthAttendance = attendance.filter(a => 
      a.workerId === workerId && a.date.startsWith(monthStr)
    );
    const fullDays = monthAttendance.filter(a => a.status === 'present').length;
    const halfDays = monthAttendance.filter(a => a.status === 'half_day').length;
    const E = (fullDays * worker.dailyWage) + (halfDays * worker.dailyWage * 0.5);
    
    // P (Payments) - Amount paid to worker in the month
    const monthPayments = payments.filter(p => 
      p.workerId === workerId && p.date.startsWith(monthStr) && p.type === 'payment'
    );
    const P = monthPayments.reduce((sum, p) => sum + p.amount, 0);
    
    // D (Credit Deposit) - Credit deposit amount from worker in the month
    const monthCredits = payments.filter(p => 
      p.workerId === workerId && p.date.startsWith(monthStr) && p.type === 'credit'
    );
    const D = monthCredits.reduce((sum, p) => sum + p.amount, 0);
    
    // C (Closing Balance) = O + E - P - D
    const C = O + E - P - D;
    
    return C;
  };

  // Get Opening Balance for display (Closing Balance of previous month)
  const getPreviousMonthsBalance = (workerId, currentMonth) => {
    const worker = workers.find(w => w.id === workerId);
    if (!worker) return 0;

    const currentMonthDate = new Date(currentMonth);
    currentMonthDate.setDate(1);
    currentMonthDate.setHours(0, 0, 0, 0);
    
    // Return Opening Balance for this month (which is Closing Balance of previous month)
    return getOpeningBalance(workerId, currentMonthDate);
  };

  // Keep old function name for compatibility
  const getCarriedForwardBalance = getPreviousMonthsBalance;

  // Mark attendance
  const markAttendance = (workerId, status, date = selectedDate) => {
    const existingIndex = attendance.findIndex(
      a => a.workerId === workerId && a.date === date
    );

    if (existingIndex >= 0) {
      const newAttendance = [...attendance];
      if (status === null) {
        newAttendance.splice(existingIndex, 1);
      } else {
        newAttendance[existingIndex] = { ...newAttendance[existingIndex], status };
      }
      setAttendance(newAttendance);
    } else if (status !== null) {
      setAttendance([...attendance, {
        id: Date.now(),
        workerId,
        date: date,
        status
      }]);
    }
  };

  // Get attendance for date
  const getAttendance = (workerId, date) => {
    return attendance.find(a => a.workerId === workerId && a.date === date);
  };

  // Calculate statistics
  const getStats = () => {
    const today = formatLocalDate(new Date());
    const todayAttendance = attendance.filter(a => a.date === today && (a.status === 'present' || a.status === 'half_day'));
    
    const currentDate = new Date();
    const thisMonth = `${currentDate.getFullYear()}-${String(currentDate.getMonth() + 1).padStart(2, '0')}`;
    const monthAttendance = attendance.filter(a => a.date.startsWith(thisMonth));
    
    const totalPaid = monthAttendance.reduce((sum, a) => {
      const worker = workers.find(w => w.id === a.workerId);
      if (a.status === 'present') {
        return sum + (worker?.dailyWage || 0);
      } else if (a.status === 'half_day') {
        return sum + (worker?.dailyWage || 0) * 0.5;
      }
      return sum;
    }, 0);

    return {
      totalWorkers: workers.length,
      presentToday: todayAttendance.length,
      monthlyPaid: totalPaid,
      avgDailyWage: workers.length > 0 
        ? workers.reduce((sum, w) => sum + w.dailyWage, 0) / workers.length 
        : 0
    };
  };

  // Calculate worker's earnings
  const getWorkerEarnings = (workerId, period = 'month', specificMonth = null) => {
    const periodDate = specificMonth 
      ? formatLocalMonth(specificMonth)
      : (period === 'month' 
        ? formatLocalMonth(new Date())
        : formatLocalDate(new Date()));
    
    const workerAttendance = attendance.filter(a => 
      a.workerId === workerId && 
      (a.status === 'present' || a.status === 'half_day') &&
      a.date.startsWith(periodDate)
    );

    const worker = workers.find(w => w.id === workerId);
    
    const fullDays = workerAttendance.filter(a => a.status === 'present').length;
    const halfDays = workerAttendance.filter(a => a.status === 'half_day').length;
    const totalDays = fullDays + (halfDays * 0.5);
    
    // E (Earnings) - Total wage earnings for the month
    const E = (fullDays * (worker?.dailyWage || 0)) + (halfDays * (worker?.dailyWage || 0) * 0.5);
    
    // O (Opening Balance) for this month
    const currentMonth = new Date(periodDate + '-01');
    const O = getOpeningBalance(workerId, currentMonth);
    
    // P (Payments) - Amount paid to worker this month
    const monthPayments = payments.filter(p => 
      p.workerId === workerId && p.date.startsWith(periodDate) && p.type === 'payment'
    );
    const P = monthPayments.reduce((sum, p) => sum + p.amount, 0);
    
    // D (Credit Deposit) - Credit deposit from worker this month
    const monthCredits = payments.filter(p => 
      p.workerId === workerId && p.date.startsWith(periodDate) && p.type === 'credit'
    );
    const D = monthCredits.reduce((sum, p) => sum + p.amount, 0);
    
    // C (Closing Balance) = O + E - P - D
    const C = O + E - P - D;
    
    return {
      days: totalDays,
      fullDays,
      halfDays,
      // New terminology
      O,              // Opening Balance
      E,              // Earnings
      P,              // Payments
      D,              // Credit Deposits
      C,              // Closing Balance
      // Legacy compatibility names
      earnings: E,
      openingBalance: O,
      paymentsTotal: P,
      creditsTotal: D,
      closingBalance: C,
      amount: E,
      carriedForward: O,
      totalPaid: P,
      totalCredits: D,
      finalBalance: C
    };
  };

  const stats = getStats();

  // Get week dates
  const getWeekDates = (date) => {
    const current = new Date(date);
    const day = current.getDay();
    const diff = current.getDate() - day; // Start from Sunday
    const sunday = new Date(current.setDate(diff));
    
    const dates = [];
    for (let i = 0; i < 7; i++) {
      const d = new Date(sunday);
      d.setDate(sunday.getDate() + i);
      dates.push(formatLocalDate(d));
    }
    return dates;
  };

  // Get month dates
  const getMonthDates = (date) => {
    const year = date.getFullYear();
    const month = date.getMonth();
    const firstDay = new Date(year, month, 1);
    const lastDay = new Date(year, month + 1, 0);
    
    const dates = [];
    
    // Add padding days from previous month to start week on Sunday
    const firstDayOfWeek = firstDay.getDay(); // 0 = Sunday, 1 = Monday, etc.
    
    // Add previous month's padding days
    for (let i = 0; i < firstDayOfWeek; i++) {
      const paddingDate = new Date(year, month, 0 - (firstDayOfWeek - 1 - i));
      dates.push(formatLocalDate(paddingDate));
    }
    
    // Add actual month days
    for (let d = 1; d <= lastDay.getDate(); d++) {
      const current = new Date(year, month, d);
      dates.push(formatLocalDate(current));
    }
    
    // Add padding days from next month to complete the grid (ensure multiple of 7)
    const remainingDays = 7 - (dates.length % 7);
    if (remainingDays < 7) {
      for (let i = 1; i <= remainingDays; i++) {
        const paddingDate = new Date(year, month + 1, i);
        dates.push(formatLocalDate(paddingDate));
      }
    }
    
    return dates;
  };

  // Navigate calendar
  const navigateCalendar = (direction) => {
    const newDate = new Date(calendarDate);
    if (attendanceView === 'weekly') {
      newDate.setDate(newDate.getDate() + (direction === 'next' ? 7 : -7));
    } else if (attendanceView === 'monthly') {
      newDate.setMonth(newDate.getMonth() + (direction === 'next' ? 1 : -1));
    }
    setCalendarDate(newDate);
  };

  // Navigate report month
  const navigateReportMonth = (direction) => {
    const newDate = new Date(reportMonth);
    newDate.setMonth(newDate.getMonth() + (direction === 'next' ? 1 : -1));
    setReportMonth(newDate);
  };

  // Backup data
  const backupData = () => {
    const data = {
      workers,
      attendance,
      payments,
      specialNotes,
      seasonalWorks,
      expenses,
      contractWorks,
      contacts,
      generalNotes,
      exportDate: new Date().toISOString(),
      version: '2.0'
    };
    const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = `farm-wage-backup-${formatLocalDate(new Date())}.json`;
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
    URL.revokeObjectURL(url);
  };

  // Restore data
  const restoreData = (event) => {
    const file = event.target.files[0];
    if (!file) return;

    const reader = new FileReader();
    reader.onload = (e) => {
      try {
        const data = JSON.parse(e.target.result);
        if (data.workers && data.attendance) {
          setConfirmDialog({
            show: true,
            message: 'Sure, you want to Restore? This will replace all current data.',
            onConfirm: () => {
              setWorkers(data.workers);
              setAttendance(data.attendance);
              setPayments(data.payments || []);
              setSpecialNotes(data.specialNotes || []);
              setSeasonalWorks(data.seasonalWorks || []);
              setExpenses(data.expenses || []);
              setContractWorks(data.contractWorks || []);
              setContacts(data.contacts || []);
              setGeneralNotes(data.generalNotes || []);
              setConfirmDialog({ show: false, message: '', onConfirm: null });
              alert('Data restored successfully!');
              // Reset file input
              event.target.value = '';
            }
          });
        } else {
          alert('Invalid backup file format');
          event.target.value = '';
        }
      } catch (error) {
        alert('Error reading backup file: ' + error.message);
        event.target.value = '';
      }
    };
    reader.readAsText(file);
  };

  // Google Drive Picker Integration
  
  // Load Google API scripts
  React.useEffect(() => {
    if (googleClientId && googleApiKey) {
      // Load Google API script
      const script1 = document.createElement('script');
      script1.src = 'https://apis.google.com/js/api.js';
      script1.onload = () => {
        window.gapi.load('picker', () => {
          setGooglePickerInited(true);
        });
      };
      document.body.appendChild(script1);

      // Load Google Identity Services
      const script2 = document.createElement('script');
      script2.src = 'https://accounts.google.com/gsi/client';
      document.body.appendChild(script2);
    }
  }, [googleClientId, googleApiKey]);

  // Authenticate with Google
  const authenticateGoogle = () => {
    return new Promise((resolve, reject) => {
      try {
        const client = window.google.accounts.oauth2.initTokenClient({
          client_id: googleClientId,
          scope: 'https://www.googleapis.com/auth/drive.file',
          callback: (response) => {
            if (response.access_token) {
              setGoogleAccessToken(response.access_token);
              resolve(response.access_token);
            } else {
              reject(new Error('No access token received'));
            }
          },
        });
        client.requestAccessToken();
      } catch (error) {
        reject(error);
      }
    });
  };

  // Save backup to Google Drive using Picker
  const saveToGoogleDrive = async () => {
    if (!googleClientId || !googleApiKey) {
      alert('Please configure Google Drive credentials first. Click "Configure Google Drive" button.');
      setShowGoogleConfig(true);
      return;
    }

    if (!googlePickerInited) {
      alert('Google Picker is loading. Please try again in a moment.');
      return;
    }

    try {
      // Get access token if not already authenticated
      let token = googleAccessToken;
      if (!token) {
        token = await authenticateGoogle();
      }

      // Create backup data
      const backupData = {
        workers,
        attendance,
        payments,
        specialNotes,
        seasonalWorks,
        expenses,
        contractWorks,
        exportDate: new Date().toISOString(),
        version: '1.0'
      };

      const blob = new Blob([JSON.stringify(backupData, null, 2)], { type: 'application/json' });
      const fileName = `farm-wage-backup-${new Date().toISOString().split('T')[0]}.json`;

      // Upload to Google Drive
      const metadata = {
        name: fileName,
        mimeType: 'application/json'
      };

      const form = new FormData();
      form.append('metadata', new Blob([JSON.stringify(metadata)], { type: 'application/json' }));
      form.append('file', blob);

      const response = await fetch('https://www.googleapis.com/upload/drive/v3/files?uploadType=multipart', {
        method: 'POST',
        headers: {
          'Authorization': `Bearer ${token}`
        },
        body: form
      });

      if (response.ok) {
        alert('âœ… Backup saved to Google Drive successfully!');
      } else {
        const error = await response.json();
        throw new Error(error.error?.message || 'Upload failed');
      }
    } catch (error) {
      console.error('Google Drive save error:', error);
      alert('Failed to save to Google Drive: ' + error.message);
      setGoogleAccessToken(''); // Clear token to force re-auth
    }
  };

  // Restore from Google Drive using Picker
  const restoreFromGoogleDrive = async () => {
    if (!googleClientId || !googleApiKey) {
      alert('Please configure Google Drive credentials first. Click "Configure Google Drive" button.');
      setShowGoogleConfig(true);
      return;
    }

    if (!googlePickerInited) {
      alert('Google Picker is loading. Please try again in a moment.');
      return;
    }

    try {
      // Get access token if not already authenticated
      let token = googleAccessToken;
      if (!token) {
        token = await authenticateGoogle();
      }

      // Create and show picker
      const picker = new window.google.picker.PickerBuilder()
        .addView(
          new window.google.picker.DocsView()
            .setMimeTypes('application/json')
            .setMode(window.google.picker.DocsViewMode.LIST)
        )
        .setOAuthToken(token)
        .setDeveloperKey(googleApiKey)
        .setCallback(async (data) => {
          if (data.action === window.google.picker.Action.PICKED) {
            const fileId = data.docs[0].id;
            
            // Download file from Google Drive
            const response = await fetch(`https://www.googleapis.com/drive/v3/files/${fileId}?alt=media`, {
              headers: {
                'Authorization': `Bearer ${token}`
              }
            });

            if (response.ok) {
              const backupData = await response.json();
              
              setConfirmDialog({
                show: true,
                message: 'Sure, you want to Restore? This will replace all current data.',
                onConfirm: () => {
                  setWorkers(backupData.workers);
                  setAttendance(backupData.attendance);
                  setPayments(backupData.payments || []);
                  setSpecialNotes(backupData.specialNotes || []);
                  setSeasonalWorks(backupData.seasonalWorks || []);
                  setExpenses(backupData.expenses || []);
                  setContractWorks(backupData.contractWorks || []);
                  setContacts(backupData.contacts || []);
                  setGeneralNotes(backupData.generalNotes || []);
                  setConfirmDialog({ show: false, message: '', onConfirm: null });
                  alert('âœ… Data restored successfully from Google Drive!');
                }
              });
            } else {
              throw new Error('Failed to download file');
            }
          }
        })
        .build();
      
      picker.setVisible(true);
    } catch (error) {
      console.error('Google Drive restore error:', error);
      alert('Failed to restore from Google Drive: ' + error.message);
      setGoogleAccessToken(''); // Clear token to force re-auth
    }
  };

  // Clear all data
  const clearAllData = () => {
    setConfirmDialog({
      show: true,
      message: 'Sure, you want to Reset all data? This will delete all workers, attendance, payments, notes, seasonal work, expenses, contract work and contacts. This cannot be undone.',
      onConfirm: () => {
        setWorkers([]);
        setAttendance([]);
        setPayments([]);
        setSpecialNotes([]);
        setSeasonalWorks([]);
        setExpenses([]);
        setContractWorks([]);
        setContacts([]);
        setGeneralNotes([]);
        setConfirmDialog({ show: false, message: '', onConfirm: null });
        alert('All data cleared successfully');
      }
    });
  };

  // Get report data for a specific month
  const getMonthReport = (month, workerType = null) => {
    const monthStr = formatLocalMonth(month);
    const filteredWorkers = workerType 
      ? workers.filter(w => w.type === workerType && w.active !== false)
      : workers.filter(w => w.active !== false);
    
    return filteredWorkers.map(worker => {
      const monthAttendance = attendance.filter(a => 
        a.workerId === worker.id && a.date.startsWith(monthStr)
      );
      
      const fullDays = monthAttendance.filter(a => a.status === 'present').length;
      const halfDays = monthAttendance.filter(a => a.status === 'half_day').length;
      const absentDays = monthAttendance.filter(a => a.status === 'absent').length;
      const totalDays = fullDays + (halfDays * 0.5);
      
      // E (Earnings) - Total wage earnings for the month
      const E = (fullDays * worker.dailyWage) + (halfDays * worker.dailyWage * 0.5);
      
      // O (Opening Balance)
      const O = getOpeningBalance(worker.id, month);
      
      // P (Payments) - Amount paid to worker this month
      const monthPayments = payments.filter(p => 
        p.workerId === worker.id && p.date.startsWith(monthStr) && p.type === 'payment'
      );
      const P = monthPayments.reduce((sum, p) => sum + p.amount, 0);
      
      // D (Credit Deposit) - Credit deposit from worker this month
      const monthCredits = payments.filter(p => 
        p.workerId === worker.id && p.date.startsWith(monthStr) && p.type === 'credit'
      );
      const D = monthCredits.reduce((sum, p) => sum + p.amount, 0);
      
      // C (Closing Balance) = O + E - P - D
      const C = O + E - P - D;

      return {
        worker,
        fullDays,
        halfDays,
        absentDays,
        totalDays,
        // New terminology
        O,              // Opening Balance
        E,              // Earnings
        P,              // Payments
        D,              // Credit Deposits
        C,              // Closing Balance
        payments: monthPayments,
        credits: monthCredits,
        // Legacy compatibility
        earned: E,
        carriedForward: O,
        totalPaid: P,
        totalCredits: D,
        finalBalance: C
      };
    });
  };

  // Format date as DD-MM-YYYY
  const formatDate = (dateString) => {
    const date = new Date(dateString);
    const day = String(date.getDate()).padStart(2, '0');
    const month = String(date.getMonth() + 1).padStart(2, '0');
    const year = date.getFullYear();
    return `${day}-${month}-${year}`;
  };

  return (
    <div style={{
      minHeight: '100vh',
      background: theme.background,
      fontFamily: '"Quicksand", "Segoe UI", system-ui, sans-serif',
      paddingLeft: '80px' // Space for left sidebar
    }}>
      {/* Header */}
      <div style={{
        background: `linear-gradient(135deg, ${theme.primary} 0%, ${theme.secondary} 100%)`,
        padding: '24px 20px',
        color: 'white',
        boxShadow: '0 4px 20px rgba(0,0,0,0.15)',
        position: 'sticky',
        top: 0,
        zIndex: 100
      }}>
        <div style={{
          display: 'flex',
          alignItems: 'center',
          gap: '12px',
          marginBottom: '8px'
        }}>
          <div style={{
            width: '40px',
            height: '40px',
            background: 'rgba(255,255,255,0.2)',
            borderRadius: '12px',
            display: 'flex',
            alignItems: 'center',
            justifyContent: 'center',
            fontSize: '24px'
          }}>ðŸŒ¾</div>
          <div>
            <h1 style={{
              margin: 0,
              fontSize: '24px',
              fontWeight: '700',
              letterSpacing: '-0.5px'
            }}>Farm Manager</h1>
            <p style={{
              margin: '2px 0 0 0',
              fontSize: '13px',
              opacity: 0.85,
              fontWeight: '500'
            }}>One Stop Solution for Farming Expense Management</p>
          </div>
        </div>
      </div>

      {/* Dashboard View */}
      {activeView === 'dashboard' && (
        <div style={{ padding: '20px' }}>
          <h1 style={{
            margin: '0 0 24px 0',
            fontSize: '28px',
            fontWeight: '700',
            color: '#2c3e50',
            textAlign: 'center'
          }}>
            ðŸŒ¾ Farm Manager
          </h1>

          {/* Quick Actions */}
          <div style={{
            background: 'white',
            borderRadius: '16px',
            padding: '20px',
            boxShadow: '0 2px 12px rgba(0,0,0,0.08)'
          }}>
            <h2 style={{
              margin: '0 0 20px 0',
              fontSize: '20px',
              fontWeight: '700',
              color: '#2c3e50'
            }}>Quick Actions</h2>
            
            <div style={{ 
              display: 'grid', 
              gridTemplateColumns: 'repeat(2, 1fr)',
              gap: '12px' 
            }}>
              <ActionButton
                icon={<span style={{fontSize:"20px"}}>ðŸ‘¥</span>}
                label="Workers"
                onClick={() => setActiveView('workers')}
                color="#9b59b6"
              />
              <ActionButton
                icon={<span style={{fontSize:"20px"}}>ðŸ“…</span>}
                label="Attendance"
                onClick={() => setActiveView('attendance')}
                color="#3498db"
              />
              <ActionButton
                icon={<span style={{fontSize:"20px"}}>ðŸ’°</span>}
                label="Payments"
                onClick={() => setActiveView('payments')}
                color="#e67e22"
              />
              <ActionButton
                icon="ðŸ“"
                label="Worker Notes"
                onClick={() => setActiveView('notes')}
                color="#8e44ad"
              />
              <ActionButton
                icon="ðŸŒ¾"
                label="Seasonal Work"
                onClick={() => setActiveView('seasonal')}
                color="#f39c12"
              />
              <ActionButton
                icon="ðŸ’°"
                label="Expenses"
                onClick={() => setActiveView('expenses')}
                color="#e74c3c"
              />
              <ActionButton
                icon="ðŸ“‹"
                label="Project Works"
                onClick={() => setActiveView('contract')}
                color="#9b59b6"
              />
              <ActionButton
                icon="ðŸ“ž"
                label="Phonebook"
                onClick={() => setActiveView('phonebook')}
                color="#1abc9c"
              />
              <ActionButton
                icon="ðŸ“Š"
                label="Reports"
                onClick={() => setActiveView('reports')}
                color="#16a085"
              />
              <ActionButton
                icon="ðŸ—’ï¸"
                label="General Notes"
                onClick={() => setActiveView('generalnotes')}
                color="#f39c12"
              />
              <ActionButton
                icon="âš™ï¸"
                label="Settings"
                onClick={() => setActiveView('settings')}
                color="#95a5a6"
              />
            </div>
          </div>
        </div>
      )}

      {/* Workers View */}
      {activeView === 'workers' && (
        <div style={{ padding: '20px' }}>
          <div style={{
            display: 'flex',
            justifyContent: 'space-between',
            alignItems: 'center',
            marginBottom: '16px'
          }}>
            <h2 style={{ margin: 0, fontSize: '22px', fontWeight: '700', color: '#2c3e50' }}>
              Workers ({workers.filter(w => showInactiveWorkers || w.active !== false).length})
            </h2>
            <button
              onClick={() => setShowAddWorker(true)}
              style={{
                background: 'linear-gradient(135deg, #0077b6 0%, #005f8e 100%)',
                color: 'white',
                border: 'none',
                padding: '12px 20px',
                borderRadius: '12px',
                display: 'flex',
                alignItems: 'center',
                gap: '8px',
                fontSize: '15px',
                fontWeight: '600',
                cursor: 'pointer',
                boxShadow: '0 4px 12px rgba(0,119,182,0.3)'
              }}
            >
              <span style={{fontSize:"20px"}}>+</span> Add Worker
            </button>
          </div>

          {/* Filter Toggle */}
          <div style={{
            background: 'white',
            borderRadius: '12px',
            padding: '12px 16px',
            marginBottom: '16px',
            boxShadow: '0 2px 8px rgba(0,0,0,0.06)',
            display: 'flex',
            justifyContent: 'space-between',
            alignItems: 'center'
          }}>
            <span style={{ fontSize: '14px', fontWeight: '600', color: '#2c3e50' }}>
              Show Inactive Workers
            </span>
            <label style={{ display: 'flex', alignItems: 'center', cursor: 'pointer' }}>
              <input
                type="checkbox"
                checked={showInactiveWorkers}
                onChange={(e) => setShowInactiveWorkers(e.target.checked)}
                style={{
                  width: '20px',
                  height: '20px',
                  cursor: 'pointer'
                }}
              />
            </label>
          </div>

          {workers.length === 0 ? (
            <div style={{
              background: 'white',
              borderRadius: '16px',
              padding: '60px 20px',
              textAlign: 'center',
              boxShadow: '0 2px 12px rgba(0,0,0,0.08)'
            }}>
              <div style={{ fontSize: '48px', marginBottom: '16px' }}>ðŸ‘·</div>
              <h3 style={{ margin: '0 0 8px 0', color: '#2c3e50' }}>No Workers Yet</h3>
              <p style={{ margin: 0, color: '#7f8c8d' }}>Add your first worker to get started</p>
            </div>
          ) : (
            <div style={{ display: 'flex', flexDirection: 'column', gap: '12px' }}>
              {workers
                .filter(w => showInactiveWorkers || w.active !== false)
                .map(worker => {
                const earnings = getWorkerEarnings(worker.id);
                return (
                  <div key={worker.id} style={{
                    background: 'white',
                    borderRadius: '16px',
                    padding: '16px',
                    boxShadow: '0 2px 12px rgba(0,0,0,0.08)',
                    opacity: worker.active === false ? 0.6 : 1,
                    position: 'relative'
                  }}>
                    {/* Action buttons - positioned at top-right */}
                    <div style={{
                      position: 'absolute',
                      top: '12px',
                      right: '12px',
                      display: 'flex',
                      gap: '6px',
                      zIndex: 10
                    }}>
                      <button
                        onClick={() => toggleWorkerStatus(worker.id)}
                        title={worker.active === false ? 'Activate Worker' : 'Deactivate Worker'}
                        style={{
                          background: worker.active === false ? '#0077b6' : '#f39c12',
                          color: 'white',
                          border: 'none',
                          padding: '8px',
                          borderRadius: '8px',
                          cursor: 'pointer',
                          display: 'flex',
                          alignItems: 'center',
                          justifyContent: 'center',
                          width: '36px',
                          height: '36px',
                          flexShrink: 0
                        }}
                      >
                        {worker.active === false ? <span style={{fontSize:"18px"}}>âœ“</span> : <span style={{fontSize:"16px"}}>â¸ï¸</span>}
                      </button>
                      <button
                        onClick={() => {
                          setEditingWorker(worker);
                          setNewWorker({
                            name: worker.name,
                            dailyWage: worker.dailyWage.toString(),
                            phone: worker.phone || '',
                            openingBalance: (worker.openingBalance || 0).toString(),
                            type: worker.type || 'regular',
                            active: worker.active !== false,
                            createdAt: worker.createdAt ? new Date(worker.createdAt).toISOString().split('T')[0] : new Date().toISOString().split('T')[0]
                          });
                          setShowAddWorker(true);
                        }}
                        style={{
                          background: '#3498db',
                          color: 'white',
                          border: 'none',
                          padding: '8px',
                          borderRadius: '8px',
                          cursor: 'pointer',
                          display: 'flex',
                          alignItems: 'center',
                          justifyContent: 'center',
                          width: '36px',
                          height: '36px',
                          flexShrink: 0
                        }}
                      >
                        <span style={{fontSize:"18px"}}>âœï¸</span>
                      </button>
                      <button
                        onClick={() => deleteWorker(worker.id)}
                        style={{
                          background: '#e74c3c',
                          color: 'white',
                          border: 'none',
                          padding: '8px',
                          borderRadius: '8px',
                          cursor: 'pointer',
                          display: 'flex',
                          alignItems: 'center',
                          justifyContent: 'center',
                          width: '36px',
                          height: '36px',
                          flexShrink: 0
                        }}
                      >
                        <span style={{fontSize:"18px"}}>ðŸ—‘ï¸</span>
                      </button>
                    </div>

                    {/* Worker info - with padding-right to avoid button overlap */}
                    <div style={{ paddingRight: '120px', marginBottom: '12px' }}>
                      <div style={{ display: 'flex', alignItems: 'flex-start', gap: '6px', marginBottom: '6px', flexWrap: 'wrap' }}>
                        <h3 style={{ margin: 0, fontSize: '17px', fontWeight: '700', color: '#2c3e50', lineHeight: '1.3' }}>
                          {worker.name}
                        </h3>
                        <span style={{
                          fontSize: '10px',
                          padding: '3px 8px',
                          borderRadius: '10px',
                          background: worker.type === 'seasonal' ? '#fff3cd' : '#d4edda',
                          color: worker.type === 'seasonal' ? '#856404' : '#155724',
                          fontWeight: '700',
                          whiteSpace: 'nowrap'
                        }}>
                          {worker.type === 'seasonal' ? 'ðŸŒ¾ SEASONAL' : 'ðŸ‘· REGULAR'}
                        </span>
                        {worker.active === false && (
                          <span style={{
                            fontSize: '10px',
                            padding: '3px 8px',
                            borderRadius: '10px',
                            background: '#f8d7da',
                            color: '#721c24',
                            fontWeight: '700',
                            whiteSpace: 'nowrap'
                          }}>
                            â¸ï¸ INACTIVE
                          </span>
                        )}
                      </div>
                      {worker.phone && (
                        <p style={{ margin: 0, fontSize: '13px', color: '#7f8c8d' }}>
                          ðŸ“ž {worker.phone}
                        </p>
                      )}
                    </div>
                    
                    <div style={{
                      display: 'grid',
                      gridTemplateColumns: 'repeat(2, 1fr)',
                      gap: '12px',
                      padding: '14px',
                      background: '#f8f9fa',
                      borderRadius: '12px'
                    }}>
                      <div>
                        <div style={{ fontSize: '12px', color: '#7f8c8d', marginBottom: '4px' }}>
                          Daily Wage
                        </div>
                        <div style={{ fontSize: '18px', fontWeight: '700', color: '#0077b6' }}>
                          â‚¹{worker.dailyWage}
                        </div>
                      </div>
                      <div>
                        <div style={{ fontSize: '12px', color: '#7f8c8d', marginBottom: '4px' }}>
                          Current Balance
                        </div>
                        <div style={{ 
                          fontSize: '18px', 
                          fontWeight: '700', 
                          color: earnings.finalBalance > 0 ? '#0077b6' : earnings.finalBalance < 0 ? '#e74c3c' : '#7f8c8d'
                        }}>
                          â‚¹{Math.round(earnings.finalBalance)}
                        </div>
                      </div>
                      <div>
                        <div style={{ fontSize: '12px', color: '#7f8c8d', marginBottom: '4px' }}>
                          Earned This Month
                        </div>
                        <div style={{ fontSize: '18px', fontWeight: '700', color: '#8b6f47' }}>
                          â‚¹{Math.round(earnings.amount)}
                        </div>
                      </div>
                      {earnings.totalPaid > 0 && (
                        <div>
                          <div style={{ fontSize: '12px', color: '#7f8c8d', marginBottom: '4px' }}>
                            Paid This Month
                          </div>
                          <div style={{ fontSize: '18px', fontWeight: '700', color: '#e74c3c' }}>
                            â‚¹{Math.round(earnings.totalPaid)}
                          </div>
                        </div>
                      )}
                    </div>
                  </div>
                );
              })}
            </div>
          )}
        </div>
      )}

      {/* Attendance View */}
      {activeView === 'attendance' && (
        <div style={{ padding: '20px' }}>
          <h2 style={{ margin: '0 0 20px 0', fontSize: '22px', fontWeight: '700', color: '#2c3e50' }}>
            Mark Attendance
          </h2>

          {workers.length === 0 ? (
            <div style={{
              background: 'white',
              borderRadius: '16px',
              padding: '60px 20px',
              textAlign: 'center',
              boxShadow: '0 2px 12px rgba(0,0,0,0.08)'
            }}>
              <div style={{ fontSize: '48px', marginBottom: '16px' }}>ðŸ‘·</div>
              <h3 style={{ margin: '0 0 8px 0', color: '#2c3e50' }}>No Workers</h3>
              <p style={{ margin: '0 0 16px 0', color: '#7f8c8d' }}>Add workers first to mark attendance</p>
              <button
                onClick={() => setActiveView('workers')}
                style={{
                  background: 'linear-gradient(135deg, #3498db 0%, #2980b9 100%)',
                  color: 'white',
                  border: 'none',
                  padding: '12px 24px',
                  borderRadius: '12px',
                  fontSize: '15px',
                  fontWeight: '600',
                  cursor: 'pointer'
                }}
              >
                Go to Workers
              </button>
            </div>
          ) : (
            <>
              {/* Month Navigation */}
              <div style={{
                background: 'white',
                borderRadius: '16px',
                padding: '16px',
                marginBottom: '20px',
                display: 'flex',
                justifyContent: 'space-between',
                alignItems: 'center',
                boxShadow: '0 2px 12px rgba(0,0,0,0.08)'
              }}>
                <button
                  onClick={() => navigateCalendar('prev')}
                  style={{
                    background: '#8b6f47',
                    color: 'white',
                    border: 'none',
                    padding: '10px 16px',
                    borderRadius: '10px',
                    fontSize: '14px',
                    fontWeight: '600',
                    cursor: 'pointer'
                  }}
                >
                  â† Previous
                </button>
                <div style={{ fontSize: '18px', fontWeight: '700', color: '#2c3e50' }}>
                  {calendarDate.toLocaleDateString('en-IN', { month: 'long', year: 'numeric' })}
                </div>
                <button
                  onClick={() => navigateCalendar('next')}
                  disabled={calendarDate.getMonth() >= new Date().getMonth() && calendarDate.getFullYear() >= new Date().getFullYear()}
                  style={{
                    background: (calendarDate.getMonth() >= new Date().getMonth() && calendarDate.getFullYear() >= new Date().getFullYear()) ? '#bdc3c7' : '#8b6f47',
                    color: 'white',
                    border: 'none',
                    padding: '10px 16px',
                    borderRadius: '10px',
                    fontSize: '14px',
                    fontWeight: '600',
                    cursor: (calendarDate.getMonth() >= new Date().getMonth() && calendarDate.getFullYear() >= new Date().getFullYear()) ? 'not-allowed' : 'pointer'
                  }}
                >
                  Next â†’
                </button>
              </div>

              {/* Worker-wise Monthly View */}
              <div style={{ display: 'flex', flexDirection: 'column', gap: '16px' }}>
                {workers.filter(w => w.active !== false).map(worker => {
                  const monthDates = getMonthDates(calendarDate);
                  const workerEarnings = getWorkerEarnings(worker.id, 'month', calendarDate);
                  
                  return (
                    <div key={worker.id} style={{
                      background: 'white',
                      borderRadius: '16px',
                      padding: '20px',
                      boxShadow: '0 2px 12px rgba(0,0,0,0.08)'
                    }}>
                      <div style={{
                        display: 'flex',
                        justifyContent: 'space-between',
                        alignItems: 'center',
                        marginBottom: '16px'
                      }}>
                        <div>
                          <h3 style={{ margin: '0 0 4px 0', fontSize: '17px', fontWeight: '700', color: '#2c3e50' }}>
                            {worker.name}
                          </h3>
                          <p style={{ margin: 0, fontSize: '13px', color: '#7f8c8d' }}>
                            â‚¹{worker.dailyWage}/day
                          </p>
                        </div>
                        <div style={{ textAlign: 'right' }}>
                          <div style={{ fontSize: '20px', fontWeight: '700', color: '#0077b6' }}>
                            â‚¹{Math.round(workerEarnings.amount)}
                          </div>
                          <div style={{ fontSize: '12px', color: '#7f8c8d' }}>
                            {workerEarnings.days} days
                          </div>
                        </div>
                      </div>

                      {/* Day Headers */}
                      <div style={{
                        display: 'grid',
                        gridTemplateColumns: 'repeat(7, 1fr)',
                        gap: '6px',
                        marginBottom: '8px'
                      }}>
                        {['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'].map(day => (
                          <div key={day} style={{
                            fontSize: '11px',
                            fontWeight: '700',
                            color: '#7f8c8d',
                            textAlign: 'center',
                            padding: '4px 0'
                          }}>
                            {day}
                          </div>
                        ))}
                      </div>

                      {/* Calendar Grid */}
                      <div style={{
                        display: 'grid',
                        gridTemplateColumns: 'repeat(7, 1fr)',
                        gap: '6px'
                      }}>
                        {monthDates.map(date => {
                          const d = new Date(date);
                          const att = getAttendance(worker.id, date);
                          const isFuture = d > new Date();
                          const isToday = date === formatLocalDate(new Date());
                          const dayNotes = getSpecialNotes(worker.id, date);
                          const isCurrentMonth = d.getMonth() === calendarDate.getMonth() && d.getFullYear() === calendarDate.getFullYear();

                          return (
                            <MonthCell
                              key={date}
                              date={date}
                              day={d.getDate()}
                              status={att?.status}
                              isFuture={isFuture}
                              isToday={isToday}
                              isCurrentMonth={isCurrentMonth}
                              workerId={worker.id}
                              workers={workers}
                              getCarriedForwardBalance={getCarriedForwardBalance}
                              specialNotes={dayNotes}
                              onClick={(status) => !isFuture && isCurrentMonth && markAttendance(worker.id, status === att?.status ? null : status, date)}
                            />
                          );
                        })}
                      </div>
                    </div>
                  );
                })}
              </div>

              {/* Legend */}
              <div style={{
                display: 'flex',
                gap: '12px',
                justifyContent: 'center',
                marginTop: '16px',
                flexWrap: 'wrap',
                fontSize: '13px'
              }}>
                <div style={{ display: 'flex', alignItems: 'center', gap: '6px' }}>
                  <span>â—</span> Full Day
                </div>
                <div style={{ display: 'flex', alignItems: 'center', gap: '6px' }}>
                  <span>â—</span> Half Day
                </div>
                <div style={{ display: 'flex', alignItems: 'center', gap: '6px' }}>
                  <span>â—‹</span> Absent
                </div>
                <div style={{ display: 'flex', alignItems: 'center', gap: '6px' }}>
                  ðŸ’° Balance Info
                </div>
                <div style={{ display: 'flex', alignItems: 'center', gap: '6px' }}>
                  ðŸ“ Special Note
                </div>
              </div>
            </>
          )}
        </div>
      )}
      {/* Payments View */}
      {activeView === 'payments' && (
        <div style={{ padding: '20px' }}>
          <h2 style={{ margin: '0 0 20px 0', fontSize: '22px', fontWeight: '700', color: '#2c3e50' }}>
            Payment History
          </h2>

          {workers.length === 0 ? (
            <div style={{
              background: 'white',
              borderRadius: '16px',
              padding: '60px 20px',
              textAlign: 'center',
              boxShadow: '0 2px 12px rgba(0,0,0,0.08)'
            }}>
              <div style={{ fontSize: '48px', marginBottom: '16px' }}>ðŸ’°</div>
              <h3 style={{ margin: '0 0 8px 0', color: '#2c3e50' }}>No Payment Data</h3>
              <p style={{ margin: 0, color: '#7f8c8d' }}>Add workers to see payment history</p>
            </div>
          ) : (
            <div style={{ display: 'flex', flexDirection: 'column', gap: '12px' }}>
              {workers.filter(w => w.active !== false).map(worker => {
                const earnings = getWorkerEarnings(worker.id);
                const currentMonthStr = formatLocalMonth(new Date());
                const presentDays = attendance.filter(a => 
                  a.workerId === worker.id && 
                  (a.status === 'present' || a.status === 'half_day') &&
                  a.date.startsWith(currentMonthStr)
                );

                return (
                  <div key={worker.id} style={{
                    background: 'white',
                    borderRadius: '16px',
                    padding: '20px',
                    boxShadow: '0 2px 12px rgba(0,0,0,0.08)'
                  }}>
                    <div style={{
                      display: 'flex',
                      justifyContent: 'space-between',
                      alignItems: 'flex-start',
                      marginBottom: '16px'
                    }}>
                      <div>
                        <h3 style={{ margin: '0 0 4px 0', fontSize: '18px', fontWeight: '700', color: '#2c3e50' }}>
                          {worker.name}
                        </h3>
                        <p style={{ margin: 0, fontSize: '14px', color: '#7f8c8d' }}>
                          â‚¹{worker.dailyWage}/day
                        </p>
                      </div>
                      <div style={{ textAlign: 'right' }}>
                        <div style={{ 
                          fontSize: '24px', 
                          fontWeight: '700', 
                          color: earnings.finalBalance > 0 ? '#0077b6' : earnings.finalBalance < 0 ? '#e74c3c' : '#7f8c8d'
                        }}>
                          â‚¹{Math.round(earnings.finalBalance)}
                        </div>
                        <div style={{ fontSize: '12px', color: '#7f8c8d' }}>
                          {earnings.finalBalance > 0 ? 'To Pay' : earnings.finalBalance < 0 ? 'To Receive' : 'Settled'}
                        </div>
                      </div>
                    </div>

                    {/* Balance Breakdown */}
                    <div style={{
                      padding: '16px',
                      background: '#f8f9fa',
                      borderRadius: '12px',
                      marginBottom: '12px'
                    }}>
                      <div style={{ marginBottom: '12px' }}>
                        {earnings.carriedForward !== 0 && (
                          <div style={{
                            display: 'flex',
                            justifyContent: 'space-between',
                            alignItems: 'center',
                            marginBottom: '8px'
                          }}>
                            <span style={{ fontSize: '14px', color: '#7f8c8d' }}>Opening Balance (O)</span>
                            <span style={{ 
                              fontSize: '16px', 
                              fontWeight: '700',
                              color: earnings.carriedForward > 0 ? '#0077b6' : '#e74c3c'
                            }}>
                              â‚¹{Math.round(earnings.carriedForward)}
                            </span>
                          </div>
                        )}
                        <div style={{
                          display: 'flex',
                          justifyContent: 'space-between',
                          alignItems: 'center',
                          marginBottom: '8px'
                        }}>
                          <span style={{ fontSize: '14px', color: '#7f8c8d' }}>Earnings (E)</span>
                          <span style={{ fontSize: '16px', fontWeight: '700', color: '#0077b6' }}>
                            +â‚¹{Math.round(earnings.amount)}
                          </span>
                        </div>
                        {earnings.totalPaid > 0 && (
                          <div style={{
                            display: 'flex',
                            justifyContent: 'space-between',
                            alignItems: 'center',
                            marginBottom: '8px'
                          }}>
                            <span style={{ fontSize: '14px', color: '#7f8c8d' }}>Payments (P)</span>
                            <span style={{ fontSize: '16px', fontWeight: '700', color: '#e74c3c' }}>
                              -â‚¹{Math.round(earnings.totalPaid)}
                            </span>
                          </div>
                        )}
                        {earnings.totalCredits > 0 && (
                          <div style={{
                            display: 'flex',
                            justifyContent: 'space-between',
                            alignItems: 'center',
                            marginBottom: '8px'
                          }}>
                            <span style={{ fontSize: '14px', color: '#7f8c8d' }}>Credit Deposit (D)</span>
                            <span style={{ fontSize: '16px', fontWeight: '700', color: '#e74c3c' }}>
                              -â‚¹{Math.round(earnings.totalCredits)}
                            </span>
                          </div>
                        )}
                        <div style={{
                          borderTop: '2px solid #e0e0e0',
                          paddingTop: '8px',
                          marginTop: '8px'
                        }}>
                          <div style={{
                            display: 'flex',
                            justifyContent: 'space-between',
                            alignItems: 'center'
                          }}>
                            <span style={{ fontSize: '15px', fontWeight: '600', color: '#2c3e50' }}>
                              Closing Balance (C)
                            </span>
                            <span style={{ 
                              fontSize: '18px', 
                              fontWeight: '700',
                              color: earnings.finalBalance > 0 ? '#0077b6' : earnings.finalBalance < 0 ? '#e74c3c' : '#7f8c8d'
                            }}>
                              â‚¹{Math.round(earnings.finalBalance)}
                            </span>
                          </div>
                        </div>
                      </div>
                    </div>

                    {/* New Payment and Credit Buttons */}
                    <div style={{ display: 'flex', gap: '8px', marginBottom: '12px' }}>
                      <button
                        onClick={() => {
                          setSelectedWorkerForPayment(worker);
                          setPaymentType('payment');
                          setShowPaymentModal(true);
                        }}
                        style={{
                          flex: 1,
                          padding: '14px',
                          border: 'none',
                          background: 'linear-gradient(135deg, #3498db 0%, #2980b9 100%)',
                          borderRadius: '12px',
                          color: 'white',
                          fontSize: '15px',
                          fontWeight: '600',
                          cursor: 'pointer',
                          display: 'flex',
                          alignItems: 'center',
                          justifyContent: 'center',
                          gap: '8px',
                          boxShadow: '0 4px 12px rgba(52,152,219,0.3)'
                        }}
                      >
                        ðŸ’° New Payment
                      </button>
                      <button
                        onClick={() => {
                          setSelectedWorkerForPayment(worker);
                          setPaymentType('credit');
                          setShowPaymentModal(true);
                        }}
                        style={{
                          flex: 1,
                          padding: '14px',
                          border: 'none',
                          background: 'linear-gradient(135deg, #0077b6 0%, #005f8e 100%)',
                          borderRadius: '12px',
                          color: 'white',
                          fontSize: '15px',
                          fontWeight: '600',
                          cursor: 'pointer',
                          display: 'flex',
                          alignItems: 'center',
                          justifyContent: 'center',
                          gap: '8px',
                          boxShadow: '0 4px 12px rgba(0,119,182,0.3)'
                        }}
                      >
                        ðŸ“¥ Credit Deposit
                      </button>
                    </div>

                    {/* Recent Transactions */}
                    {(() => {
                      const workerPayments = payments.filter(p => 
                        p.workerId === worker.id
                      ).sort((a, b) => new Date(b.date) - new Date(a.date))
                       .slice(0, 10); // Show only last 10 transactions
                      
                      if (workerPayments.length > 0) {
                        return (
                          <div style={{
                            padding: '16px',
                            background: '#f8f9fa',
                            borderRadius: '12px',
                            marginBottom: '12px'
                          }}>
                            <h4 style={{
                              margin: '0 0 12px 0',
                              fontSize: '14px',
                              fontWeight: '600',
                              color: '#2c3e50'
                            }}>
                              Recent Transactions
                            </h4>
                            <div style={{ display: 'flex', flexDirection: 'column', gap: '8px' }}>
                              {workerPayments.map(payment => (
                                <div key={payment.id} style={{
                                  background: 'white',
                                  padding: '12px',
                                  borderRadius: '8px',
                                  borderLeft: payment.type === 'credit' ? '4px solid #0077b6' : '4px solid #3498db'
                                }}>
                                  <div style={{
                                    display: 'flex',
                                    justifyContent: 'space-between',
                                    alignItems: 'flex-start',
                                    marginBottom: payment.notes ? '8px' : '0'
                                  }}>
                                    <div style={{ flex: 1 }}>
                                      <div style={{ display: 'flex', alignItems: 'center', gap: '8px', marginBottom: '4px' }}>
                                        <span style={{ 
                                          fontSize: '16px', 
                                          fontWeight: '700', 
                                          color: payment.type === 'credit' ? '#0077b6' : '#3498db'
                                        }}>
                                          {payment.type === 'credit' ? 'ðŸ“¥' : 'ðŸ’°'} â‚¹{payment.amount}
                                        </span>
                                        <span style={{
                                          fontSize: '11px',
                                          padding: '2px 8px',
                                          borderRadius: '10px',
                                          background: payment.type === 'credit' ? '#d4edda' : '#ebf5fb',
                                          color: payment.type === 'credit' ? '#155724' : '#2874a6',
                                          fontWeight: '600'
                                        }}>
                                          {payment.type === 'credit' ? 'CREDIT' : 'PAYMENT'}
                                        </span>
                                      </div>
                                      <div style={{ fontSize: '12px', color: '#7f8c8d' }}>
                                        {new Date(payment.date).toLocaleDateString('en-IN', { 
                                          day: 'numeric', 
                                          month: 'short', 
                                          year: 'numeric' 
                                        })}
                                      </div>
                                    </div>
                                    <div style={{ display: 'flex', gap: '4px' }}>
                                      <button
                                        onClick={() => {
                                          setEditingPayment(payment);
                                          setPaymentData({
                                            amount: payment.amount.toString(),
                                            notes: payment.notes || '',
                                            date: payment.date
                                          });
                                          setSelectedWorkerForPayment(worker);
                                          setPaymentType(payment.type || 'payment');
                                          setShowPaymentModal(true);
                                        }}
                                        style={{
                                          padding: '6px 8px',
                                          border: 'none',
                                          background: '#f39c12',
                                          color: 'white',
                                          borderRadius: '6px',
                                          cursor: 'pointer',
                                          fontSize: '12px',
                                          fontWeight: '600'
                                        }}
                                      >
                                        âœï¸
                                      </button>
                                      <button
                                        onClick={() => deletePayment(payment.id)}
                                        style={{
                                          padding: '6px 8px',
                                          border: 'none',
                                          background: '#e74c3c',
                                          color: 'white',
                                          borderRadius: '6px',
                                          cursor: 'pointer',
                                          fontSize: '12px',
                                          fontWeight: '600'
                                        }}
                                      >
                                        ðŸ—‘ï¸
                                      </button>
                                    </div>
                                  </div>
                                  {payment.notes && (
                                    <div style={{
                                      fontSize: '13px',
                                      color: '#2c3e50',
                                      fontStyle: 'italic',
                                      paddingTop: '8px',
                                      borderTop: '1px solid #e0e0e0'
                                    }}>
                                      ðŸ’¬ {payment.notes}
                                    </div>
                                  )}
                                </div>
                              ))}
                            </div>
                          </div>
                        );
                      }
                      return null;
                    })()}

                    {(earnings.fullDays > 0 || earnings.halfDays > 0) && (
                      <div style={{
                        padding: '16px',
                        background: '#f8f9fa',
                        borderRadius: '12px',
                        marginBottom: '12px'
                      }}>
                        <div style={{
                          display: 'grid',
                          gridTemplateColumns: 'repeat(2, 1fr)',
                          gap: '12px',
                          marginBottom: '12px'
                        }}>
                          <div>
                            <div style={{ fontSize: '13px', color: '#7f8c8d', marginBottom: '4px' }}>
                              Full Days
                            </div>
                            <div style={{ fontSize: '18px', fontWeight: '700', color: '#0077b6' }}>
                              {earnings.fullDays}
                            </div>
                          </div>
                          <div>
                            <div style={{ fontSize: '13px', color: '#7f8c8d', marginBottom: '4px' }}>
                              Half Days
                            </div>
                            <div style={{ fontSize: '18px', fontWeight: '700', color: '#f39c12' }}>
                              {earnings.halfDays}
                            </div>
                          </div>
                        </div>
                      </div>
                    )}
                  </div>
                );
              })}
            </div>
          )}
        </div>
      )}

      {/* Add/Edit Worker Modal */}
      {showAddWorker && (
        <div style={{
          position: 'fixed',
          top: 0,
          left: 0,
          right: 0,
          bottom: 0,
          background: 'rgba(0,0,0,0.5)',
          display: 'flex',
          alignItems: 'center',
          justifyContent: 'center',
          zIndex: 1000,
          padding: '20px'
        }}>
          <div style={{
            background: 'white',
            borderRadius: '20px',
            padding: '24px',
            maxWidth: '400px',
            width: '100%',
            boxShadow: '0 10px 40px rgba(0,0,0,0.2)',
            maxHeight: '90vh',
            overflowY: 'auto'
          }}>
            <h3 style={{ margin: '0 0 20px 0', fontSize: '20px', fontWeight: '700', color: '#2c3e50' }}>
              {editingWorker ? 'Edit Worker' : 'Add New Worker'}
            </h3>

            <div style={{ marginBottom: '16px' }}>
              <label style={{
                display: 'block',
                fontSize: '14px',
                fontWeight: '600',
                color: '#2c3e50',
                marginBottom: '8px'
              }}>
                Name *
              </label>
              <input
                type="text"
                value={newWorker.name}
                onChange={(e) => setNewWorker({ ...newWorker, name: e.target.value })}
                placeholder="Enter worker name"
                style={{
                  width: '100%',
                  padding: '14px',
                  border: '2px solid #e0e0e0',
                  borderRadius: '12px',
                  fontSize: '16px',
                  fontFamily: 'inherit',
                  outline: 'none'
                }}
              />
            </div>

            <div style={{ marginBottom: '16px' }}>
              <label style={{
                display: 'block',
                fontSize: '14px',
                fontWeight: '600',
                color: '#2c3e50',
                marginBottom: '8px'
              }}>
                Daily Wage (â‚¹) *
              </label>
              <input
                type="number"
                value={newWorker.dailyWage}
                onChange={(e) => setNewWorker({ ...newWorker, dailyWage: e.target.value })}
                placeholder="Enter daily wage"
                style={{
                  width: '100%',
                  padding: '14px',
                  border: '2px solid #e0e0e0',
                  borderRadius: '12px',
                  fontSize: '16px',
                  fontFamily: 'inherit',
                  outline: 'none'
                }}
              />
            </div>

            <div style={{ marginBottom: '24px' }}>
              <label style={{
                display: 'block',
                fontSize: '14px',
                fontWeight: '600',
                color: '#2c3e50',
                marginBottom: '8px'
              }}>
                Phone Number
              </label>
              <input
                type="tel"
                value={newWorker.phone}
                onChange={(e) => setNewWorker({ ...newWorker, phone: e.target.value })}
                placeholder="Enter phone number (optional)"
                style={{
                  width: '100%',
                  padding: '14px',
                  border: '2px solid #e0e0e0',
                  borderRadius: '12px',
                  fontSize: '16px',
                  fontFamily: 'inherit',
                  outline: 'none'
                }}
              />
            </div>

            <div style={{ marginBottom: '24px' }}>
              <label style={{
                display: 'block',
                fontSize: '14px',
                fontWeight: '600',
                color: '#2c3e50',
                marginBottom: '8px'
              }}>
                Opening Balance (â‚¹)
              </label>
              <input
                type="number"
                value={newWorker.openingBalance}
                onChange={(e) => setNewWorker({ ...newWorker, openingBalance: e.target.value })}
                placeholder="Enter opening balance (optional)"
                style={{
                  width: '100%',
                  padding: '14px',
                  border: '2px solid #e0e0e0',
                  borderRadius: '12px',
                  fontSize: '16px',
                  fontFamily: 'inherit',
                  outline: 'none'
                }}
              />
              <p style={{
                margin: '8px 0 0 0',
                fontSize: '12px',
                color: '#7f8c8d',
                lineHeight: '1.4'
              }}>
                Positive: You owe worker money (shown in green)<br/>
                Negative: Worker owes you money (shown in red, use minus sign)
              </p>
            </div>

            <div style={{ marginBottom: '24px' }}>
              <label style={{
                display: 'block',
                fontSize: '14px',
                fontWeight: '600',
                color: '#2c3e50',
                marginBottom: '8px'
              }}>
                Date of Worker Creation *
              </label>
              <input
                type="date"
                value={newWorker.createdAt}
                max={new Date().toISOString().split('T')[0]}
                onChange={(e) => setNewWorker({ ...newWorker, createdAt: e.target.value })}
                style={{
                  width: '100%',
                  padding: '14px',
                  border: '2px solid #e0e0e0',
                  borderRadius: '12px',
                  fontSize: '16px',
                  fontFamily: 'inherit',
                  outline: 'none'
                }}
              />
              <p style={{
                margin: '8px 0 0 0',
                fontSize: '12px',
                color: '#7f8c8d',
                lineHeight: '1.4'
              }}>
                Select the date when this worker joined. Defaults to today. Can be set to past dates.
              </p>
            </div>

            <div style={{ marginBottom: '16px' }}>
              <label style={{
                display: 'block',
                fontSize: '14px',
                fontWeight: '600',
                color: '#2c3e50',
                marginBottom: '8px'
              }}>
                Worker Type
              </label>
              <div style={{ display: 'flex', gap: '12px' }}>
                <button
                  type="button"
                  onClick={() => setNewWorker({ ...newWorker, type: 'regular' })}
                  style={{
                    flex: 1,
                    padding: '12px',
                    border: newWorker.type === 'regular' ? '2px solid #0077b6' : '2px solid #e0e0e0',
                    background: newWorker.type === 'regular' ? '#d4edda' : 'white',
                    borderRadius: '10px',
                    fontSize: '14px',
                    fontWeight: '600',
                    color: newWorker.type === 'regular' ? '#155724' : '#7f8c8d',
                    cursor: 'pointer'
                  }}
                >
                  ðŸ‘· Regular
                </button>
                <button
                  type="button"
                  onClick={() => setNewWorker({ ...newWorker, type: 'seasonal' })}
                  style={{
                    flex: 1,
                    padding: '12px',
                    border: newWorker.type === 'seasonal' ? '2px solid #f39c12' : '2px solid #e0e0e0',
                    background: newWorker.type === 'seasonal' ? '#fff3cd' : 'white',
                    borderRadius: '10px',
                    fontSize: '14px',
                    fontWeight: '600',
                    color: newWorker.type === 'seasonal' ? '#856404' : '#7f8c8d',
                    cursor: 'pointer'
                  }}
                >
                  ðŸŒ¾ Seasonal
                </button>
              </div>
            </div>

            {editingWorker && (
              <div style={{ marginBottom: '24px' }}>
                <label style={{
                  display: 'flex',
                  alignItems: 'center',
                  gap: '12px',
                  cursor: 'pointer',
                  padding: '12px',
                  background: '#f8f9fa',
                  borderRadius: '10px'
                }}>
                  <input
                    type="checkbox"
                    checked={newWorker.active}
                    onChange={(e) => setNewWorker({ ...newWorker, active: e.target.checked })}
                    style={{
                      width: '20px',
                      height: '20px',
                      cursor: 'pointer'
                    }}
                  />
                  <span style={{
                    fontSize: '14px',
                    fontWeight: '600',
                    color: '#2c3e50'
                  }}>
                    Worker is Active
                  </span>
                </label>
                <p style={{
                  margin: '8px 0 0 0',
                  fontSize: '12px',
                  color: '#7f8c8d'
                }}>
                  Inactive workers won't appear in attendance or reports
                </p>
              </div>
            )}

            <div style={{ display: 'flex', gap: '12px' }}>
              <button
                onClick={() => {
                  setShowAddWorker(false);
                  setEditingWorker(null);
                  setNewWorker({ name: '', dailyWage: '', phone: '', openingBalance: '0', type: 'regular', active: true });
                }}
                style={{
                  flex: 1,
                  padding: '14px',
                  border: '2px solid #e0e0e0',
                  background: 'white',
                  borderRadius: '12px',
                  fontSize: '15px',
                  fontWeight: '600',
                  color: '#2c3e50',
                  cursor: 'pointer'
                }}
              >
                Cancel
              </button>
              <button
                onClick={addWorker}
                disabled={!newWorker.name || !newWorker.dailyWage}
                style={{
                  flex: 1,
                  padding: '14px',
                  border: 'none',
                  background: !newWorker.name || !newWorker.dailyWage 
                    ? '#bdc3c7' 
                    : 'linear-gradient(135deg, #0077b6 0%, #005f8e 100%)',
                  borderRadius: '12px',
                  fontSize: '15px',
                  fontWeight: '600',
                  color: 'white',
                  cursor: !newWorker.name || !newWorker.dailyWage ? 'not-allowed' : 'pointer',
                  boxShadow: !newWorker.name || !newWorker.dailyWage 
                    ? 'none' 
                    : '0 4px 12px rgba(0,119,182,0.3)'
                }}
              >
                {editingWorker ? 'Update' : 'Add Worker'}
              </button>
            </div>
          </div>
        </div>
      )}

      {/* Payment Modal */}
      {showPaymentModal && selectedWorkerForPayment && (
        <div style={{
          position: 'fixed',
          top: 0,
          left: 0,
          right: 0,
          bottom: 0,
          background: 'rgba(0,0,0,0.5)',
          display: 'flex',
          alignItems: 'center',
          justifyContent: 'center',
          zIndex: 1000,
          padding: '20px'
        }}>
          <div style={{
            background: 'white',
            borderRadius: '20px',
            padding: '24px',
            maxWidth: '400px',
            width: '100%',
            boxShadow: '0 10px 40px rgba(0,0,0,0.2)'
          }}>
            <h3 style={{ margin: '0 0 16px 0', fontSize: '20px', fontWeight: '700', color: '#2c3e50' }}>
              {editingPayment ? 'Edit Payment' : paymentType === 'credit' ? 'Record Credit Deposit' : 'Record Payment'}
            </h3>
            
            <div style={{
              padding: '12px 16px',
              background: '#f8f9fa',
              borderRadius: '12px',
              marginBottom: '20px'
            }}>
              <div style={{ fontSize: '14px', color: '#7f8c8d', marginBottom: '4px' }}>
                Worker
              </div>
              <div style={{ fontSize: '18px', fontWeight: '700', color: '#2c3e50' }}>
                {selectedWorkerForPayment.name}
              </div>
            </div>

            {!editingPayment && (
              <div style={{ marginBottom: '16px' }}>
                <label style={{
                  display: 'block',
                  fontSize: '14px',
                  fontWeight: '600',
                  color: '#2c3e50',
                  marginBottom: '8px'
                }}>
                  Transaction Type
                </label>
                <div style={{ display: 'flex', gap: '8px' }}>
                  <button
                    onClick={() => setPaymentType('payment')}
                    style={{
                      flex: 1,
                      padding: '12px',
                      border: paymentType === 'payment' ? '2px solid #3498db' : '2px solid #e0e0e0',
                      background: paymentType === 'payment' ? '#ebf5fb' : 'white',
                      borderRadius: '10px',
                      fontSize: '14px',
                      fontWeight: '600',
                      color: paymentType === 'payment' ? '#2874a6' : '#7f8c8d',
                      cursor: 'pointer'
                    }}
                  >
                    ðŸ’° Payment
                  </button>
                  <button
                    onClick={() => setPaymentType('credit')}
                    style={{
                      flex: 1,
                      padding: '12px',
                      border: paymentType === 'credit' ? '2px solid #0077b6' : '2px solid #e0e0e0',
                      background: paymentType === 'credit' ? '#d4edda' : 'white',
                      borderRadius: '10px',
                      fontSize: '14px',
                      fontWeight: '600',
                      color: paymentType === 'credit' ? '#155724' : '#7f8c8d',
                      cursor: 'pointer'
                    }}
                  >
                    ðŸ“¥ Credit
                  </button>
                </div>
                <p style={{
                  margin: '8px 0 0 0',
                  fontSize: '12px',
                  color: '#7f8c8d',
                  lineHeight: '1.4'
                }}>
                  {paymentType === 'payment' 
                    ? 'Record money paid to worker' 
                    : 'Record money deposited by worker (reduces their balance)'}
                </p>
              </div>
            )}

            <div style={{ marginBottom: '16px' }}>
              <label style={{
                display: 'block',
                fontSize: '14px',
                fontWeight: '600',
                color: '#2c3e50',
                marginBottom: '8px'
              }}>
                Amount (â‚¹) *
              </label>
              <input
                type="number"
                value={paymentData.amount}
                onChange={(e) => setPaymentData({ ...paymentData, amount: e.target.value })}
                placeholder="Enter amount"
                style={{
                  width: '100%',
                  padding: '14px',
                  border: '2px solid #e0e0e0',
                  borderRadius: '12px',
                  fontSize: '16px',
                  fontFamily: 'inherit',
                  outline: 'none'
                }}
              />
            </div>

            <div style={{ marginBottom: '16px' }}>
              <label style={{
                display: 'block',
                fontSize: '14px',
                fontWeight: '600',
                color: '#2c3e50',
                marginBottom: '8px'
              }}>
                Date
              </label>
              <input
                type="date"
                value={paymentData.date}
                onChange={(e) => setPaymentData({ ...paymentData, date: e.target.value })}
                max={formatLocalDate(new Date())}
                style={{
                  width: '100%',
                  padding: '14px',
                  border: '2px solid #e0e0e0',
                  borderRadius: '12px',
                  fontSize: '16px',
                  fontFamily: 'inherit',
                  outline: 'none'
                }}
              />
            </div>

            <div style={{ marginBottom: '24px' }}>
              <label style={{
                display: 'block',
                fontSize: '14px',
                fontWeight: '600',
                color: '#2c3e50',
                marginBottom: '8px'
              }}>
                Notes / Comments
              </label>
              <textarea
                value={paymentData.notes}
                onChange={(e) => setPaymentData({ ...paymentData, notes: e.target.value })}
                placeholder="Add any notes about this transaction (optional)"
                rows={3}
                style={{
                  width: '100%',
                  padding: '14px',
                  border: '2px solid #e0e0e0',
                  borderRadius: '12px',
                  fontSize: '16px',
                  fontFamily: 'inherit',
                  outline: 'none',
                  resize: 'vertical'
                }}
              />
            </div>

            <div style={{ display: 'flex', gap: '12px' }}>
              <button
                onClick={() => {
                  setShowPaymentModal(false);
                  setSelectedWorkerForPayment(null);
                  setEditingPayment(null);
                  setPaymentData({ amount: '', notes: '', date: formatLocalDate(new Date()) });
                  setPaymentType('payment');
                }}
                style={{
                  flex: 1,
                  padding: '14px',
                  border: '2px solid #e0e0e0',
                  background: 'white',
                  borderRadius: '12px',
                  fontSize: '15px',
                  fontWeight: '600',
                  color: '#2c3e50',
                  cursor: 'pointer'
                }}
              >
                Cancel
              </button>
              <button
                onClick={addPayment}
                disabled={!paymentData.amount}
                style={{
                  flex: 1,
                  padding: '14px',
                  border: 'none',
                  background: !paymentData.amount 
                    ? '#bdc3c7' 
                    : paymentType === 'credit'
                    ? 'linear-gradient(135deg, #0077b6 0%, #005f8e 100%)'
                    : 'linear-gradient(135deg, #3498db 0%, #2980b9 100%)',
                  borderRadius: '12px',
                  fontSize: '15px',
                  fontWeight: '600',
                  color: 'white',
                  cursor: !paymentData.amount ? 'not-allowed' : 'pointer',
                  boxShadow: !paymentData.amount 
                    ? 'none' 
                    : paymentType === 'credit'
                    ? '0 4px 12px rgba(0,119,182,0.3)'
                    : '0 4px 12px rgba(52,152,219,0.3)'
                }}
              >
                {editingPayment ? 'Update' : paymentType === 'credit' ? 'Record Credit' : 'Record Payment'}
              </button>
            </div>
          </div>
        </div>
      )}

      {/* Special Notes Modal */}
      {showNoteModal && (
        <div style={{
          position: 'fixed',
          top: 0,
          left: 0,
          right: 0,
          bottom: 0,
          background: 'rgba(0,0,0,0.5)',
          display: 'flex',
          alignItems: 'center',
          justifyContent: 'center',
          zIndex: 1000,
          padding: '20px'
        }}>
          <div style={{
            background: 'white',
            borderRadius: '20px',
            padding: '24px',
            maxWidth: '400px',
            width: '100%',
            boxShadow: '0 10px 40px rgba(0,0,0,0.2)'
          }}>
            <h3 style={{ margin: '0 0 20px 0', fontSize: '20px', fontWeight: '700', color: '#2c3e50' }}>
              Add Special Note
            </h3>

            <div style={{ marginBottom: '16px' }}>
              <label style={{
                display: 'block',
                fontSize: '14px',
                fontWeight: '600',
                color: '#2c3e50',
                marginBottom: '8px'
              }}>
                Worker *
              </label>
              <select
                value={noteData.workerId || ''}
                onChange={(e) => setNoteData({ ...noteData, workerId: parseInt(e.target.value) || null })}
                style={{
                  width: '100%',
                  padding: '14px',
                  border: '2px solid #e0e0e0',
                  borderRadius: '12px',
                  fontSize: '16px',
                  fontFamily: 'inherit',
                  outline: 'none',
                  background: 'white'
                }}
              >
                <option value="">Select a worker</option>
                {workers.filter(w => w.active !== false).map(w => (
                  <option key={w.id} value={w.id}>{w.name}</option>
                ))}
              </select>
            </div>

            <div style={{ marginBottom: '16px' }}>
              <label style={{
                display: 'block',
                fontSize: '14px',
                fontWeight: '600',
                color: '#2c3e50',
                marginBottom: '8px'
              }}>
                Date
              </label>
              <input
                type="date"
                value={noteData.date}
                onChange={(e) => setNoteData({ ...noteData, date: e.target.value })}
                style={{
                  width: '100%',
                  padding: '14px',
                  border: '2px solid #e0e0e0',
                  borderRadius: '12px',
                  fontSize: '16px',
                  fontFamily: 'inherit',
                  outline: 'none'
                }}
              />
            </div>

            <div style={{ marginBottom: '24px' }}>
              <label style={{
                display: 'block',
                fontSize: '14px',
                fontWeight: '600',
                color: '#2c3e50',
                marginBottom: '8px'
              }}>
                Note *
              </label>
              <textarea
                value={noteData.note}
                onChange={(e) => setNoteData({ ...noteData, note: e.target.value })}
                placeholder="Enter your note or comment"
                rows={4}
                style={{
                  width: '100%',
                  padding: '14px',
                  border: '2px solid #e0e0e0',
                  borderRadius: '12px',
                  fontSize: '16px',
                  fontFamily: 'inherit',
                  outline: 'none',
                  resize: 'vertical'
                }}
              />
            </div>

            <div style={{ display: 'flex', gap: '12px' }}>
              <button
                onClick={() => {
                  setShowNoteModal(false);
                  setNoteData({ workerId: null, note: '', date: formatLocalDate(new Date()) });
                }}
                style={{
                  flex: 1,
                  padding: '14px',
                  border: '2px solid #e0e0e0',
                  background: 'white',
                  borderRadius: '12px',
                  fontSize: '15px',
                  fontWeight: '600',
                  color: '#2c3e50',
                  cursor: 'pointer'
                }}
              >
                Cancel
              </button>
              <button
                onClick={addSpecialNote}
                disabled={!noteData.note || !noteData.workerId}
                style={{
                  flex: 1,
                  padding: '14px',
                  border: 'none',
                  background: (!noteData.note || !noteData.workerId)
                    ? '#bdc3c7' 
                    : 'linear-gradient(135deg, #9b59b6 0%, #8e44ad 100%)',
                  borderRadius: '12px',
                  fontSize: '15px',
                  fontWeight: '600',
                  color: 'white',
                  cursor: (!noteData.note || !noteData.workerId) ? 'not-allowed' : 'pointer',
                  boxShadow: (!noteData.note || !noteData.workerId)
                    ? 'none' 
                    : '0 4px 12px rgba(155,89,182,0.3)'
                }}
              >
                Add Note
              </button>
            </div>
          </div>
        </div>
      )}

      {/* Seasonal Work Modal */}
      {showSeasonalModal && (
        <div style={{
          position: 'fixed',
          top: 0,
          left: 0,
          right: 0,
          bottom: 0,
          background: 'rgba(0,0,0,0.5)',
          display: 'flex',
          alignItems: 'center',
          justifyContent: 'center',
          zIndex: 1000,
          padding: '20px'
        }}>
          <div style={{
            background: 'white',
            borderRadius: '20px',
            padding: '24px',
            maxWidth: '500px',
            width: '100%',
            boxShadow: '0 10px 40px rgba(0,0,0,0.2)',
            maxHeight: '90vh',
            overflowY: 'auto'
          }}>
            <h3 style={{ margin: '0 0 20px 0', fontSize: '20px', fontWeight: '700', color: '#2c3e50' }}>
              {editingSeasonalWork ? 'Edit Seasonal Work' : 'Add Seasonal Work'}
            </h3>

            <div style={{ marginBottom: '16px' }}>
              <label style={{
                display: 'block',
                fontSize: '14px',
                fontWeight: '600',
                color: '#2c3e50',
                marginBottom: '8px'
              }}>
                Work Title *
              </label>
              <input
                type="text"
                value={seasonalData.title}
                onChange={(e) => setSeasonalData({ ...seasonalData, title: e.target.value })}
                placeholder="e.g., Harvest Season, Planting"
                style={{
                  width: '100%',
                  padding: '14px',
                  border: '2px solid #e0e0e0',
                  borderRadius: '12px',
                  fontSize: '16px',
                  fontFamily: 'inherit',
                  outline: 'none'
                }}
              />
            </div>

            <div style={{ marginBottom: '16px' }}>
              <label style={{
                display: 'block',
                fontSize: '14px',
                fontWeight: '600',
                color: '#2c3e50',
                marginBottom: '8px'
              }}>
                Rate Type *
              </label>
              <div style={{ display: 'flex', gap: '12px' }}>
                <button
                  type="button"
                  onClick={() => setSeasonalData({ ...seasonalData, rateType: 'hourly' })}
                  style={{
                    flex: 1,
                    padding: '12px',
                    border: seasonalData.rateType === 'hourly' ? '2px solid #f39c12' : '2px solid #e0e0e0',
                    background: seasonalData.rateType === 'hourly' ? '#fff3cd' : 'white',
                    borderRadius: '10px',
                    fontSize: '14px',
                    fontWeight: '600',
                    color: seasonalData.rateType === 'hourly' ? '#856404' : '#7f8c8d',
                    cursor: 'pointer'
                  }}
                >
                  â±ï¸ Hourly
                </button>
                <button
                  type="button"
                  onClick={() => setSeasonalData({ ...seasonalData, rateType: 'daily' })}
                  style={{
                    flex: 1,
                    padding: '12px',
                    border: seasonalData.rateType === 'daily' ? '2px solid #f39c12' : '2px solid #e0e0e0',
                    background: seasonalData.rateType === 'daily' ? '#fff3cd' : 'white',
                    borderRadius: '10px',
                    fontSize: '14px',
                    fontWeight: '600',
                    color: seasonalData.rateType === 'daily' ? '#856404' : '#7f8c8d',
                    cursor: 'pointer'
                  }}
                >
                  ðŸ“… Daily
                </button>
              </div>
            </div>

            <div style={{ marginBottom: '16px' }}>
              <label style={{
                display: 'block',
                fontSize: '14px',
                fontWeight: '600',
                color: '#2c3e50',
                marginBottom: '8px'
              }}>
                Rate (â‚¹) *
              </label>
              <input
                type="number"
                value={seasonalData.rate}
                onChange={(e) => setSeasonalData({ ...seasonalData, rate: e.target.value })}
                placeholder={`Enter ${seasonalData.rateType === 'hourly' ? 'hourly' : 'daily'} rate`}
                style={{
                  width: '100%',
                  padding: '14px',
                  border: '2px solid #e0e0e0',
                  borderRadius: '12px',
                  fontSize: '16px',
                  fontFamily: 'inherit',
                  outline: 'none'
                }}
              />
            </div>

            <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '12px', marginBottom: '16px' }}>
              <div>
                <label style={{
                  display: 'block',
                  fontSize: '14px',
                  fontWeight: '600',
                  color: '#2c3e50',
                  marginBottom: '8px'
                }}>
                  Start Date *
                </label>
                <input
                  type="date"
                  value={seasonalData.startDate}
                  onChange={(e) => setSeasonalData({ ...seasonalData, startDate: e.target.value })}
                  style={{
                    width: '100%',
                    padding: '14px',
                    border: '2px solid #e0e0e0',
                    borderRadius: '12px',
                    fontSize: '16px',
                    fontFamily: 'inherit',
                    outline: 'none'
                  }}
                />
              </div>
              <div>
                <label style={{
                  display: 'block',
                  fontSize: '14px',
                  fontWeight: '600',
                  color: '#2c3e50',
                  marginBottom: '8px'
                }}>
                  End Date *
                </label>
                <input
                  type="date"
                  value={seasonalData.endDate}
                  onChange={(e) => setSeasonalData({ ...seasonalData, endDate: e.target.value })}
                  style={{
                    width: '100%',
                    padding: '14px',
                    border: '2px solid #e0e0e0',
                    borderRadius: '12px',
                    fontSize: '16px',
                    fontFamily: 'inherit',
                    outline: 'none'
                  }}
                />
              </div>
            </div>

            <div style={{ marginBottom: '24px' }}>
              <label style={{
                display: 'block',
                fontSize: '14px',
                fontWeight: '600',
                color: '#2c3e50',
                marginBottom: '8px'
              }}>
                Total {seasonalData.rateType === 'hourly' ? 'Hours' : 'Days'} Consumed *
              </label>
              <input
                type="number"
                value={seasonalData.totalConsumed}
                onChange={(e) => setSeasonalData({ ...seasonalData, totalConsumed: e.target.value })}
                placeholder={`Enter total ${seasonalData.rateType === 'hourly' ? 'hours' : 'days'}`}
                style={{
                  width: '100%',
                  padding: '14px',
                  border: '2px solid #e0e0e0',
                  borderRadius: '12px',
                  fontSize: '16px',
                  fontFamily: 'inherit',
                  outline: 'none'
                }}
              />
              {seasonalData.rate && seasonalData.totalConsumed && (
                <p style={{
                  margin: '8px 0 0 0',
                  fontSize: '14px',
                  color: '#f39c12',
                  fontWeight: '600'
                }}>
                  Total Cost: â‚¹{(parseFloat(seasonalData.rate) * parseFloat(seasonalData.totalConsumed)).toFixed(2)}
                </p>
              )}
            </div>

            {/* Notes Field */}
            <div style={{ marginBottom: '24px' }}>
              <label style={{
                display: 'block',
                fontSize: '14px',
                fontWeight: '600',
                color: '#2c3e50',
                marginBottom: '8px'
              }}>
                Notes
              </label>
              <textarea
                value={seasonalData.notes}
                onChange={(e) => setSeasonalData({ ...seasonalData, notes: e.target.value })}
                placeholder="Additional notes or comments about this seasonal work..."
                rows="3"
                style={{
                  width: '100%',
                  padding: '14px',
                  border: '2px solid #e0e0e0',
                  borderRadius: '12px',
                  fontSize: '16px',
                  fontFamily: 'inherit',
                  outline: 'none',
                  resize: 'vertical'
                }}
              />
            </div>

            <div style={{ display: 'flex', gap: '12px' }}>
              <button
                onClick={() => {
                  setShowSeasonalModal(false);
                  setEditingSeasonalWork(null);
                  setSeasonalData({ title: '', rateType: 'hourly', rate: '', startDate: '', endDate: '', totalConsumed: '', notes: '' });
                }}
                style={{
                  flex: 1,
                  padding: '14px',
                  border: '2px solid #e0e0e0',
                  background: 'white',
                  borderRadius: '12px',
                  fontSize: '15px',
                  fontWeight: '600',
                  color: '#2c3e50',
                  cursor: 'pointer'
                }}
              >
                Cancel
              </button>
              <button
                onClick={addSeasonalWorkFromModal}
                style={{
                  flex: 1,
                  padding: '14px',
                  border: 'none',
                  background: 'linear-gradient(135deg, #f39c12 0%, #e67e22 100%)',
                  borderRadius: '12px',
                  fontSize: '15px',
                  fontWeight: '600',
                  color: 'white',
                  cursor: 'pointer',
                  boxShadow: '0 4px 12px rgba(243,156,18,0.3)'
                }}
              >
                {editingSeasonalWork ? 'Update Work' : 'Add Work'}
              </button>
            </div>
          </div>
        </div>
      )}

      {/* Expense Modal */}
      {showExpenseModal && (
        <div style={{
          position: 'fixed',
          top: 0,
          left: 0,
          right: 0,
          bottom: 0,
          background: 'rgba(0,0,0,0.5)',
          display: 'flex',
          alignItems: 'center',
          justifyContent: 'center',
          zIndex: 1000,
          padding: '20px'
        }}>
          <div style={{
            background: 'white',
            borderRadius: '20px',
            padding: '24px',
            maxWidth: '400px',
            width: '100%',
            boxShadow: '0 10px 40px rgba(0,0,0,0.2)'
          }}>
            <h3 style={{ margin: '0 0 20px 0', fontSize: '20px', fontWeight: '700', color: '#2c3e50' }}>
              {editingExpense ? 'Edit Expense' : 'Add Farming Expense'}
            </h3>

            <div style={{ marginBottom: '16px' }}>
              <label style={{
                display: 'block',
                fontSize: '14px',
                fontWeight: '600',
                color: '#2c3e50',
                marginBottom: '8px'
              }}>
                Expense Title *
              </label>
              <input
                type="text"
                value={expenseData.title}
                onChange={(e) => setExpenseData({ ...expenseData, title: e.target.value })}
                placeholder="e.g., Fertilizer, Seeds, Equipment"
                style={{
                  width: '100%',
                  padding: '14px',
                  border: '2px solid #e0e0e0',
                  borderRadius: '12px',
                  fontSize: '16px',
                  fontFamily: 'inherit',
                  outline: 'none'
                }}
              />
            </div>

            <div style={{ marginBottom: '16px' }}>
              <label style={{
                display: 'block',
                fontSize: '14px',
                fontWeight: '600',
                color: '#2c3e50',
                marginBottom: '8px'
              }}>
                Total Cost (â‚¹) *
              </label>
              <input
                type="number"
                value={expenseData.cost}
                onChange={(e) => setExpenseData({ ...expenseData, cost: e.target.value })}
                placeholder="Enter total cost"
                style={{
                  width: '100%',
                  padding: '14px',
                  border: '2px solid #e0e0e0',
                  borderRadius: '12px',
                  fontSize: '16px',
                  fontFamily: 'inherit',
                  outline: 'none'
                }}
              />
            </div>

            <div style={{ marginBottom: '16px' }}>
              <label style={{
                display: 'block',
                fontSize: '14px',
                fontWeight: '600',
                color: '#2c3e50',
                marginBottom: '8px'
              }}>
                Purchase Date *
              </label>
              <input
                type="date"
                value={expenseData.purchaseDate}
                onChange={(e) => setExpenseData({ ...expenseData, purchaseDate: e.target.value })}
                max={formatLocalDate(new Date())}
                style={{
                  width: '100%',
                  padding: '14px',
                  border: '2px solid #e0e0e0',
                  borderRadius: '12px',
                  fontSize: '16px',
                  fontFamily: 'inherit',
                  outline: 'none'
                }}
              />
            </div>

            <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '12px', marginBottom: '24px' }}>
              <div>
                <label style={{
                  display: 'block',
                  fontSize: '14px',
                  fontWeight: '600',
                  color: '#2c3e50',
                  marginBottom: '8px'
                }}>
                  Unit *
                </label>
                <input
                  type="text"
                  value={expenseData.unit}
                  onChange={(e) => setExpenseData({ ...expenseData, unit: e.target.value })}
                  placeholder="e.g., kg, bags"
                  style={{
                    width: '100%',
                    padding: '14px',
                    border: '2px solid #e0e0e0',
                    borderRadius: '12px',
                    fontSize: '16px',
                    fontFamily: 'inherit',
                    outline: 'none'
                  }}
                />
              </div>
              <div>
                <label style={{
                  display: 'block',
                  fontSize: '14px',
                  fontWeight: '600',
                  color: '#2c3e50',
                  marginBottom: '8px'
                }}>
                  Quantity *
                </label>
                <input
                  type="number"
                  value={expenseData.quantity}
                  onChange={(e) => setExpenseData({ ...expenseData, quantity: e.target.value })}
                  placeholder="Enter quantity"
                  style={{
                    width: '100%',
                    padding: '14px',
                    border: '2px solid #e0e0e0',
                    borderRadius: '12px',
                    fontSize: '16px',
                    fontFamily: 'inherit',
                    outline: 'none'
                  }}
                />
              </div>
            </div>

            {/* Notes Field */}
            <div style={{ marginBottom: '20px' }}>
              <label style={{
                display: 'block',
                fontSize: '14px',
                fontWeight: '600',
                color: '#2c3e50',
                marginBottom: '8px'
              }}>
                Notes
              </label>
              <textarea
                value={expenseData.notes}
                onChange={(e) => setExpenseData({ ...expenseData, notes: e.target.value })}
                placeholder="Additional notes or comments about this expense..."
                rows="3"
                style={{
                  width: '100%',
                  padding: '14px',
                  border: '2px solid #e0e0e0',
                  borderRadius: '12px',
                  fontSize: '16px',
                  fontFamily: 'inherit',
                  outline: 'none',
                  resize: 'vertical'
                }}
              />
            </div>

            <div style={{ display: 'flex', gap: '12px' }}>
              <button
                onClick={() => {
                  setShowExpenseModal(false);
                  setEditingExpense(null);
                  setExpenseData({ title: '', cost: '', purchaseDate: formatLocalDate(new Date()), unit: '', quantity: '', notes: '' });
                }}
                style={{
                  flex: 1,
                  padding: '14px',
                  border: '2px solid #e0e0e0',
                  background: 'white',
                  borderRadius: '12px',
                  fontSize: '15px',
                  fontWeight: '600',
                  color: '#2c3e50',
                  cursor: 'pointer'
                }}
              >
                Cancel
              </button>
              <button
                onClick={addExpenseFromModal}
                style={{
                  flex: 1,
                  padding: '14px',
                  border: 'none',
                  background: 'linear-gradient(135deg, #e74c3c 0%, #c0392b 100%)',
                  borderRadius: '12px',
                  fontSize: '15px',
                  fontWeight: '600',
                  color: 'white',
                  cursor: 'pointer',
                  boxShadow: '0 4px 12px rgba(231,76,60,0.3)'
                }}
              >
                {editingExpense ? 'Update Expense' : 'Add Expense'}
              </button>
            </div>
          </div>
        </div>
      )}

      {/* Contract Work Modal */}
      {showContractModal && (
        <div style={{
          position: 'fixed',
          top: 0,
          left: 0,
          right: 0,
          bottom: 0,
          background: 'rgba(0,0,0,0.5)',
          display: 'flex',
          alignItems: 'center',
          justifyContent: 'center',
          zIndex: 1000,
          padding: '20px'
        }}>
          <div style={{
            background: 'white',
            borderRadius: '20px',
            width: '100%',
            maxWidth: '600px',
            maxHeight: '90vh',
            overflow: 'auto',
            boxShadow: '0 10px 40px rgba(0,0,0,0.3)'
          }}>
            <div style={{
              padding: '24px',
              borderBottom: '2px solid #f0f0f0',
              position: 'sticky',
              top: 0,
              background: 'white',
              zIndex: 1
            }}>
              <h3 style={{
                margin: 0,
                fontSize: '24px',
                fontWeight: '700',
                color: '#2c3e50'
              }}>
                {editingContract ? 'Edit Project' : 'Add Project'}
              </h3>
            </div>

            <div style={{ padding: '24px' }}>
              <div style={{ display: 'flex', flexDirection: 'column', gap: '16px' }}>
                {/* Work Title */}
                <div>
                  <label style={{
                    display: 'block',
                    marginBottom: '8px',
                    fontSize: '14px',
                    fontWeight: '600',
                    color: '#2c3e50'
                  }}>
                    Work Title *
                  </label>
                  <input
                    type="text"
                    value={contractData.workTitle}
                    onChange={(e) => setContractData({...contractData, workTitle: e.target.value})}
                    placeholder="e.g., Field Plowing, Harvesting"
                    style={{
                      width: '100%',
                      padding: '12px',
                      border: '2px solid #e0e0e0',
                      borderRadius: '12px',
                      fontSize: '15px',
                      fontFamily: 'inherit'
                    }}
                  />
                </div>

                {/* Supervisor */}
                <div>
                  <label style={{
                    display: 'block',
                    marginBottom: '8px',
                    fontSize: '14px',
                    fontWeight: '600',
                    color: '#2c3e50'
                  }}>
                    Supervisor
                  </label>
                  <input
                    type="text"
                    value={contractData.supervisor}
                    onChange={(e) => setContractData({...contractData, supervisor: e.target.value})}
                    placeholder="e.g., Ramesh Kumar"
                    style={{
                      width: '100%',
                      padding: '12px',
                      border: '2px solid #e0e0e0',
                      borderRadius: '12px',
                      fontSize: '15px',
                      fontFamily: 'inherit'
                    }}
                  />
                </div>

                {/* Number of People */}
                <div>
                  <label style={{
                    display: 'block',
                    marginBottom: '8px',
                    fontSize: '14px',
                    fontWeight: '600',
                    color: '#2c3e50'
                  }}>
                    No. of People
                  </label>
                  <input
                    type="text"
                    value={contractData.numberOfPeople}
                    onChange={(e) => setContractData({...contractData, numberOfPeople: e.target.value})}
                    placeholder="e.g., 5, 10 workers"
                    style={{
                      width: '100%',
                      padding: '12px',
                      border: '2px solid #e0e0e0',
                      borderRadius: '12px',
                      fontSize: '15px',
                      fontFamily: 'inherit'
                    }}
                  />
                </div>

                {/* Date */}
                <div>
                  <label style={{
                    display: 'block',
                    marginBottom: '8px',
                    fontSize: '14px',
                    fontWeight: '600',
                    color: '#2c3e50'
                  }}>
                    Date *
                  </label>
                  <input
                    type="date"
                    value={contractData.date}
                    onChange={(e) => setContractData({...contractData, date: e.target.value})}
                    style={{
                      width: '100%',
                      padding: '12px',
                      border: '2px solid #e0e0e0',
                      borderRadius: '12px',
                      fontSize: '15px',
                      fontFamily: 'inherit'
                    }}
                  />
                </div>

                {/* Quantity and Unit REMOVED - replaced by Items table below */}

                {/* Items Inventory Table */}
                <div style={{
                  padding: '16px',
                  background: '#f0f4ff',
                  borderRadius: '12px',
                  border: '2px solid #c7d2fe'
                }}>
                  <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '12px' }}>
                    <h4 style={{ margin: 0, fontSize: '15px', fontWeight: '700', color: '#2c3e50' }}>
                      ðŸ“¦ Items / Inventory Used
                    </h4>
                    <button
                      onClick={() => setContractData({
                        ...contractData,
                        items: [...contractData.items, { name: '', qty: '', unit: '', cost: '' }]
                      })}
                      style={{
                        padding: '6px 14px', border: 'none',
                        background: 'linear-gradient(135deg, #6366f1 0%, #4f46e5 100%)',
                        color: 'white', borderRadius: '8px', cursor: 'pointer',
                        fontSize: '13px', fontWeight: '600', display: 'flex', alignItems: 'center', gap: '4px'
                      }}
                    >
                      <span style={{ fontSize: '16px' }}>+</span> Add Item
                    </button>
                  </div>

                  {/* Table header */}
                  <div style={{
                    display: 'grid',
                    gridTemplateColumns: '2fr 1fr 1fr 1fr 36px',
                    gap: '6px', marginBottom: '6px', padding: '0 4px'
                  }}>
                    {['Item Name', 'Qty', 'Unit', 'Cost (â‚¹)', ''].map((h, i) => (
                      <div key={i} style={{ fontSize: '11px', fontWeight: '700', color: '#6366f1', textTransform: 'uppercase', letterSpacing: '0.4px' }}>{h}</div>
                    ))}
                  </div>

                  {/* Item rows */}
                  <div style={{ display: 'flex', flexDirection: 'column', gap: '6px' }}>
                    {contractData.items.map((item, idx) => (
                      <div key={idx} style={{
                        display: 'grid',
                        gridTemplateColumns: '2fr 1fr 1fr 1fr 36px',
                        gap: '6px', alignItems: 'center'
                      }}>
                        <input
                          type="text"
                          value={item.name}
                          onChange={(e) => {
                            const items = [...contractData.items];
                            items[idx] = { ...items[idx], name: e.target.value };
                            setContractData({ ...contractData, items });
                          }}
                          placeholder={`Item ${idx + 1}`}
                          style={{ padding: '9px', border: '1.5px solid #c7d2fe', borderRadius: '8px', fontSize: '13px', fontFamily: 'inherit', width: '100%' }}
                        />
                        <input
                          type="text"
                          value={item.qty}
                          onChange={(e) => {
                            const items = [...contractData.items];
                            items[idx] = { ...items[idx], qty: e.target.value };
                            setContractData({ ...contractData, items });
                          }}
                          placeholder="0"
                          style={{ padding: '9px', border: '1.5px solid #c7d2fe', borderRadius: '8px', fontSize: '13px', fontFamily: 'inherit', width: '100%' }}
                        />
                        <input
                          type="text"
                          value={item.unit}
                          onChange={(e) => {
                            const items = [...contractData.items];
                            items[idx] = { ...items[idx], unit: e.target.value };
                            setContractData({ ...contractData, items });
                          }}
                          placeholder="kg / L"
                          style={{ padding: '9px', border: '1.5px solid #c7d2fe', borderRadius: '8px', fontSize: '13px', fontFamily: 'inherit', width: '100%' }}
                        />
                        <input
                          type="number"
                          value={item.cost}
                          onChange={(e) => {
                            const items = [...contractData.items];
                            items[idx] = { ...items[idx], cost: e.target.value };
                            setContractData({ ...contractData, items });
                          }}
                          placeholder="0"
                          style={{ padding: '9px', border: '1.5px solid #c7d2fe', borderRadius: '8px', fontSize: '13px', fontFamily: 'inherit', width: '100%' }}
                        />
                        <button
                          onClick={() => {
                            const items = contractData.items.filter((_, i) => i !== idx);
                            setContractData({ ...contractData, items: items.length ? items : [{ name: '', qty: '', unit: '', cost: '' }] });
                          }}
                          style={{
                            width: '32px', height: '32px', border: 'none', background: '#fee2e2',
                            color: '#e74c3c', borderRadius: '6px', cursor: 'pointer',
                            fontSize: '16px', display: 'flex', alignItems: 'center', justifyContent: 'center', flexShrink: 0
                          }}
                        >Ã—</button>
                      </div>
                    ))}
                  </div>
                </div>

                {/* Total Item Cost & Total Labor Cost */}
                <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '12px' }}>
                  <div>
                    <label style={{ display: 'block', marginBottom: '8px', fontSize: '14px', fontWeight: '600', color: '#2c3e50' }}>
                      Total Item Cost (â‚¹)
                    </label>
                    <input
                      type="number"
                      value={contractData.totalItemCost}
                      onChange={(e) => setContractData({ ...contractData, totalItemCost: e.target.value })}
                      placeholder="0"
                      style={{ width: '100%', padding: '12px', border: '2px solid #e0e0e0', borderRadius: '12px', fontSize: '15px', fontFamily: 'inherit' }}
                    />
                  </div>
                  <div>
                    <label style={{ display: 'block', marginBottom: '8px', fontSize: '14px', fontWeight: '600', color: '#2c3e50' }}>
                      Total Labor Cost (â‚¹)
                    </label>
                    <input
                      type="number"
                      value={contractData.totalLaborCost}
                      onChange={(e) => setContractData({ ...contractData, totalLaborCost: e.target.value })}
                      placeholder="0"
                      style={{ width: '100%', padding: '12px', border: '2px solid #e0e0e0', borderRadius: '12px', fontSize: '15px', fontFamily: 'inherit' }}
                    />
                  </div>
                </div>

                {/* Contract Cost */}
                <div>
                  <label style={{
                    display: 'block',
                    marginBottom: '8px',
                    fontSize: '14px',
                    fontWeight: '600',
                    color: '#2c3e50'
                  }}>
                    Contract Cost (â‚¹)
                  </label>
                  <input
                    type="number"
                    value={contractData.contractCost}
                    onChange={(e) => setContractData({...contractData, contractCost: e.target.value})}
                    placeholder="e.g., 100000"
                    style={{
                      width: '100%',
                      padding: '12px',
                      border: '2px solid #e0e0e0',
                      borderRadius: '12px',
                      fontSize: '15px',
                      fontFamily: 'inherit'
                    }}
                  />
                </div>

                {/* Notes */}
                <div>
                  <label style={{
                    display: 'block',
                    marginBottom: '8px',
                    fontSize: '14px',
                    fontWeight: '600',
                    color: '#2c3e50'
                  }}>
                    Notes
                  </label>
                  <textarea
                    value={contractData.notes}
                    onChange={(e) => setContractData({...contractData, notes: e.target.value})}
                    placeholder="Additional notes or comments about this contract work..."
                    rows="3"
                    style={{
                      width: '100%',
                      padding: '12px',
                      border: '2px solid #e0e0e0',
                      borderRadius: '12px',
                      fontSize: '15px',
                      fontFamily: 'inherit',
                      resize: 'vertical'
                    }}
                  />
                </div>

                {/* Financial Details - only Advance Amount */}
                <div style={{
                  padding: '16px',
                  background: '#f8f9fa',
                  borderRadius: '12px',
                  border: '2px solid #e9ecef'
                }}>
                  <h4 style={{
                    margin: '0 0 16px 0',
                    fontSize: '16px',
                    fontWeight: '700',
                    color: '#2c3e50'
                  }}>
                    Financial Details
                  </h4>
                  <div>
                    <label style={{
                      display: 'block',
                      marginBottom: '6px',
                      fontSize: '13px',
                      fontWeight: '600',
                      color: '#2c3e50'
                    }}>
                      Advance Amount (â‚¹)
                    </label>
                    <input
                      type="number"
                      value={contractData.paymentDone}
                      onChange={(e) => setContractData({ ...contractData, paymentDone: e.target.value })}
                      placeholder="0"
                      style={{
                        width: '100%',
                        padding: '10px',
                        border: '2px solid #e0e0e0',
                        borderRadius: '8px',
                        fontSize: '15px',
                        fontFamily: 'inherit'
                      }}
                    />
                  </div>
                </div>
              </div>
            </div>

            {/* Modal Actions */}
            <div style={{
              padding: '20px 24px',
              borderTop: '2px solid #f0f0f0',
              display: 'flex',
              gap: '12px',
              position: 'sticky',
              bottom: 0,
              background: 'white'
            }}>
              <button
                onClick={() => {
                  setShowContractModal(false);
                  setEditingContract(null);
                  setContractData({
                    workTitle: '',
                    supervisor: '',
                    numberOfPeople: '',
                    date: formatLocalDate(new Date()),
                    paymentDone: '',
                    contractCost: '',
                    totalItemCost: '',
                    totalLaborCost: '',
                    notes: '',
                    items: [{ name: '', qty: '', unit: '', cost: '' }]
                  });
                }}
                style={{
                  flex: 1,
                  padding: '14px',
                  border: '2px solid #e0e0e0',
                  background: 'white',
                  borderRadius: '12px',
                  fontSize: '15px',
                  fontWeight: '600',
                  color: '#2c3e50',
                  cursor: 'pointer'
                }}
              >
                Cancel
              </button>
              <button
                onClick={addContractWork}
                style={{
                  flex: 1,
                  padding: '14px',
                  border: 'none',
                  background: 'linear-gradient(135deg, #9b59b6 0%, #8e44ad 100%)',
                  borderRadius: '12px',
                  fontSize: '15px',
                  fontWeight: '600',
                  color: 'white',
                  cursor: 'pointer',
                  boxShadow: '0 4px 12px rgba(155,89,182,0.3)'
                }}
              >
                {editingContract ? 'Update Project' : 'Add Project'}
              </button>
            </div>
          </div>
        </div>
      )}

      {/* Special Notes View */}
      {activeView === 'notes' && (
        <div style={{ padding: '20px' }}>
          <div style={{
            display: 'flex',
            justifyContent: 'space-between',
            alignItems: 'center',
            marginBottom: '20px'
          }}>
            <h2 style={{ margin: 0, fontSize: '22px', fontWeight: '700', color: '#2c3e50' }}>
              ðŸ“ Worker Notes
            </h2>
            <button
              onClick={() => setShowNoteModal(true)}
              style={{
                background: 'linear-gradient(135deg, #9b59b6 0%, #8e44ad 100%)',
                color: 'white',
                border: 'none',
                padding: '12px 20px',
                borderRadius: '12px',
                display: 'flex',
                alignItems: 'center',
                gap: '8px',
                fontSize: '15px',
                fontWeight: '600',
                cursor: 'pointer',
                boxShadow: '0 4px 12px rgba(155,89,182,0.3)'
              }}
            >
              <span style={{fontSize:"20px"}}>+</span> Add Note
            </button>
          </div>

          {specialNotes.length === 0 ? (
            <div style={{
              background: 'white',
              borderRadius: '16px',
              padding: '60px 20px',
              textAlign: 'center',
              boxShadow: '0 2px 12px rgba(0,0,0,0.08)'
            }}>
              <div style={{ fontSize: '48px', marginBottom: '16px' }}>ðŸ“</div>
              <h3 style={{ margin: '0 0 8px 0', color: '#2c3e50' }}>No Special Notes</h3>
              <p style={{ margin: 0, color: '#7f8c8d' }}>Add notes to track important events or reminders</p>
            </div>
          ) : (
            <div style={{ display: 'flex', flexDirection: 'column', gap: '16px' }}>
              {workers.filter(w => w.active !== false).map(worker => {
                const workerNotes = specialNotes.filter(n => n.workerId === worker.id)
                  .sort((a, b) => new Date(b.date) - new Date(a.date));
                
                if (workerNotes.length === 0) return null;

                return (
                  <div key={worker.id} style={{
                    background: 'white',
                    borderRadius: '16px',
                    padding: '20px',
                    boxShadow: '0 2px 12px rgba(0,0,0,0.08)'
                  }}>
                    <h3 style={{
                      margin: '0 0 16px 0',
                      fontSize: '18px',
                      fontWeight: '700',
                      color: '#2c3e50',
                      paddingBottom: '12px',
                      borderBottom: '2px solid #f0f0f0'
                    }}>
                      {worker.name}
                    </h3>

                    <div style={{ display: 'flex', flexDirection: 'column', gap: '12px' }}>
                      {workerNotes.map(note => (
                        <div key={note.id} style={{
                          background: '#f8f9fa',
                          padding: '16px',
                          borderRadius: '12px',
                          borderLeft: '4px solid #9b59b6'
                        }}>
                          <div style={{
                            display: 'flex',
                            justifyContent: 'space-between',
                            alignItems: 'flex-start',
                            marginBottom: '8px'
                          }}>
                            <div style={{ fontSize: '13px', color: '#7f8c8d', fontWeight: '600' }}>
                              ðŸ“… {new Date(note.date).toLocaleDateString('en-IN', { 
                                day: 'numeric', 
                                month: 'short', 
                                year: 'numeric' 
                              })}
                            </div>
                            <button
                              onClick={() => deleteSpecialNote(note.id)}
                              style={{
                                padding: '4px 8px',
                                border: 'none',
                                background: '#e74c3c',
                                color: 'white',
                                borderRadius: '6px',
                                cursor: 'pointer',
                                fontSize: '12px',
                                fontWeight: '600'
                              }}
                            >
                              ðŸ—‘ï¸ Delete
                            </button>
                          </div>
                          <div style={{
                            fontSize: '15px',
                            color: '#2c3e50',
                            lineHeight: '1.5'
                          }}>
                            {note.note}
                          </div>
                        </div>
                      ))}
                    </div>
                  </div>
                );
              })}
            </div>
          )}
        </div>
      )}

      {/* Seasonal Work Tab */}
      {activeView === 'seasonal' && (
        <div style={{ padding: '20px' }}>
          <div style={{
            display: 'flex',
            justifyContent: 'space-between',
            alignItems: 'center',
            marginBottom: '20px'
          }}>
            <h2 style={{ margin: 0, fontSize: '22px', fontWeight: '700', color: '#2c3e50' }}>
              Seasonal Work
            </h2>
            <button
              onClick={() => {
                setEditingSeasonalWork(null);
                setSeasonalData({ title: '', rateType: 'hourly', rate: '', startDate: '', endDate: '', totalConsumed: '', notes: '' });
                setShowSeasonalModal(true);
              }}
              style={{
                background: 'linear-gradient(135deg, #f39c12 0%, #e67e22 100%)',
                color: 'white',
                border: 'none',
                padding: '12px 20px',
                borderRadius: '12px',
                display: 'flex',
                alignItems: 'center',
                gap: '8px',
                fontSize: '15px',
                fontWeight: '600',
                cursor: 'pointer',
                boxShadow: '0 4px 12px rgba(243,156,18,0.3)'
              }}
            >
              <span style={{fontSize:"20px"}}>+</span> Add Seasonal Work
            </button>
          </div>

          {seasonalWorks.length === 0 ? (
            <div style={{
              background: 'white',
              borderRadius: '16px',
              padding: '60px 20px',
              textAlign: 'center',
              boxShadow: '0 2px 12px rgba(0,0,0,0.08)'
            }}>
              <div style={{ fontSize: '48px', marginBottom: '16px' }}>ðŸŒ¾</div>
              <h3 style={{ margin: '0 0 8px 0', color: '#2c3e50' }}>No Seasonal Work</h3>
              <p style={{ margin: 0, color: '#7f8c8d' }}>Add seasonal work to track special projects</p>
            </div>
          ) : (
            <div style={{ display: 'flex', flexDirection: 'column', gap: '16px' }}>
              {seasonalWorks.map(work => (
                <div key={work.id} style={{
                  background: 'white',
                  borderRadius: '16px',
                  padding: '20px',
                  boxShadow: '0 2px 12px rgba(0,0,0,0.08)'
                }}>
                  <div style={{
                    display: 'flex',
                    justifyContent: 'space-between',
                    alignItems: 'flex-start',
                    marginBottom: '16px'
                  }}>
                    <div>
                      <h3 style={{ margin: '0 0 8px 0', fontSize: '18px', fontWeight: '700', color: '#2c3e50' }}>
                        {work.title}
                      </h3>
                      <div style={{ fontSize: '14px', color: '#7f8c8d', marginBottom: '4px' }}>
                        ðŸ“… {new Date(work.startDate).toLocaleDateString()} - {new Date(work.endDate).toLocaleDateString()}
                      </div>
                      <div style={{ fontSize: '14px', color: '#7f8c8d' }}>
                        ðŸ’° â‚¹{work.rate}/{work.rateType === 'hourly' ? 'hour' : 'day'}
                      </div>
                    </div>
                    <div style={{ display: 'flex', gap: '8px' }}>
                      <button
                        onClick={() => editSeasonalWork(work)}
                        style={{
                          background: '#3498db',
                          color: 'white',
                          border: 'none',
                          padding: '8px',
                          borderRadius: '8px',
                          cursor: 'pointer'
                        }}
                      >
                        <span style={{fontSize:"18px"}}>âœï¸</span>
                      </button>
                      <button
                        onClick={() => deleteSeasonalWork(work.id)}
                        style={{
                          background: '#e74c3c',
                          color: 'white',
                          border: 'none',
                          padding: '8px',
                          borderRadius: '8px',
                          cursor: 'pointer'
                        }}
                      >
                        <span style={{fontSize:"18px"}}>ðŸ—‘ï¸</span>
                      </button>
                    </div>
                  </div>

                  <div style={{
                    padding: '16px',
                    background: '#f8f9fa',
                    borderRadius: '12px',
                    marginBottom: '12px'
                  }}>
                    <div style={{
                      display: 'flex',
                      justifyContent: 'space-between',
                      alignItems: 'center',
                      marginBottom: '8px'
                    }}>
                      <span style={{ fontSize: '14px', color: '#7f8c8d' }}>
                        Total {work.rateType === 'hourly' ? 'Hours' : 'Days'}
                      </span>
                      <span style={{ fontSize: '18px', fontWeight: '700', color: '#2c3e50' }}>
                        {work.totalConsumed}
                      </span>
                    </div>
                    <div style={{
                      borderTop: '2px solid #e0e0e0',
                      paddingTop: '8px',
                      marginTop: '8px'
                    }}>
                      <div style={{
                        display: 'flex',
                        justifyContent: 'space-between',
                        alignItems: 'center'
                      }}>
                        <span style={{ fontSize: '15px', fontWeight: '600', color: '#2c3e50' }}>
                          Total Cost
                        </span>
                        <span style={{ fontSize: '24px', fontWeight: '700', color: '#f39c12' }}>
                          â‚¹{(work.rate * work.totalConsumed).toFixed(2)}
                        </span>
                      </div>
                    </div>
                  </div>

                  {/* Notes */}
                  {work.notes && (
                    <div style={{
                      padding: '12px',
                      background: '#fff9e6',
                      borderRadius: '8px',
                      marginTop: '12px',
                      border: '2px solid #ffd54f'
                    }}>
                      <div style={{
                        fontSize: '14px',
                        color: '#5d4037',
                        fontWeight: '600',
                        marginBottom: '6px',
                        display: 'flex',
                        alignItems: 'center',
                        gap: '6px'
                      }}>
                        <span style={{fontSize:'16px'}}>ðŸ“</span>
                        Notes
                      </div>
                      <div style={{
                        fontSize: '14px',
                        color: '#4e342e',
                        lineHeight: '1.5',
                        whiteSpace: 'pre-wrap'
                      }}>
                        {work.notes}
                      </div>
                    </div>
                  )}
                </div>
              ))}
            </div>
          )}
        </div>
      )}

      {/* Expenses Tab */}
      {activeView === 'expenses' && (
        <div style={{ padding: '20px' }}>
          <div style={{
            display: 'flex',
            justifyContent: 'space-between',
            alignItems: 'center',
            marginBottom: '20px'
          }}>
            <h2 style={{ margin: 0, fontSize: '22px', fontWeight: '700', color: '#2c3e50' }}>
              Farming Expenses
            </h2>
            <button
              onClick={() => setShowExpenseModal(true)}
              style={{
                background: 'linear-gradient(135deg, #e74c3c 0%, #c0392b 100%)',
                color: 'white',
                border: 'none',
                padding: '12px 20px',
                borderRadius: '12px',
                display: 'flex',
                alignItems: 'center',
                gap: '8px',
                fontSize: '15px',
                fontWeight: '600',
                cursor: 'pointer',
                boxShadow: '0 4px 12px rgba(231,76,60,0.3)'
              }}
            >
              <span style={{fontSize:"20px"}}>+</span> Add Expense
            </button>
          </div>

          {/* Summary Card */}
          {expenses.length > 0 && (
            <div style={{
              background: 'white',
              borderRadius: '16px',
              padding: '20px',
              marginBottom: '20px',
              boxShadow: '0 2px 12px rgba(0,0,0,0.08)'
            }}>
              <h3 style={{ margin: '0 0 16px 0', fontSize: '16px', fontWeight: '700', color: '#2c3e50' }}>
                Summary
              </h3>
              <div style={{
                display: 'grid',
                gridTemplateColumns: 'repeat(2, 1fr)',
                gap: '16px'
              }}>
                <div>
                  <div style={{ fontSize: '14px', color: '#7f8c8d', marginBottom: '4px' }}>
                    Total Expenses
                  </div>
                  <div style={{ fontSize: '24px', fontWeight: '700', color: '#e74c3c' }}>
                    â‚¹{expenses.reduce((sum, e) => sum + e.cost, 0).toFixed(2)}
                  </div>
                </div>
                <div>
                  <div style={{ fontSize: '14px', color: '#7f8c8d', marginBottom: '4px' }}>
                    Total Items
                  </div>
                  <div style={{ fontSize: '24px', fontWeight: '700', color: '#2c3e50' }}>
                    {expenses.length}
                  </div>
                </div>
              </div>
            </div>
          )}

          {expenses.length === 0 ? (
            <div style={{
              background: 'white',
              borderRadius: '16px',
              padding: '60px 20px',
              textAlign: 'center',
              boxShadow: '0 2px 12px rgba(0,0,0,0.08)'
            }}>
              <div style={{ fontSize: '48px', marginBottom: '16px' }}>ðŸ’°</div>
              <h3 style={{ margin: '0 0 8px 0', color: '#2c3e50' }}>No Expenses</h3>
              <p style={{ margin: 0, color: '#7f8c8d' }}>Track your farming expenses here</p>
            </div>
          ) : (
            <div style={{ display: 'flex', flexDirection: 'column', gap: '12px' }}>
              {expenses.sort((a, b) => new Date(b.purchaseDate) - new Date(a.purchaseDate)).map(expense => (
                <div key={expense.id} style={{
                  background: 'white',
                  borderRadius: '16px',
                  padding: '16px',
                  boxShadow: '0 2px 12px rgba(0,0,0,0.08)',
                  position: 'relative'
                }}>
                  {/* Edit/Delete buttons - positioned at top-right */}
                  <div style={{
                    position: 'absolute',
                    top: '12px',
                    right: '12px',
                    display: 'flex',
                    gap: '6px',
                    zIndex: 10
                  }}>
                    <button
                      onClick={() => {
                        setEditingExpense(expense);
                        setExpenseData({
                          title: expense.title,
                          cost: expense.cost.toString(),
                          purchaseDate: expense.purchaseDate,
                          unit: expense.unit,
                          quantity: expense.quantity.toString(),
                          notes: expense.notes || ''
                        });
                        setShowExpenseModal(true);
                      }}
                      style={{
                        background: '#3498db',
                        color: 'white',
                        border: 'none',
                        padding: '8px',
                        borderRadius: '8px',
                        cursor: 'pointer',
                        display: 'flex',
                        alignItems: 'center',
                        justifyContent: 'center',
                        width: '36px',
                        height: '36px',
                        flexShrink: 0
                      }}
                    >
                      <span style={{fontSize:"18px"}}>âœï¸</span>
                    </button>
                    <button
                      onClick={() => deleteExpense(expense.id)}
                      style={{
                        background: '#e74c3c',
                        color: 'white',
                        border: 'none',
                        padding: '8px',
                        borderRadius: '8px',
                        cursor: 'pointer',
                        display: 'flex',
                        alignItems: 'center',
                        justifyContent: 'center',
                        width: '36px',
                        height: '36px',
                        flexShrink: 0
                      }}
                    >
                      <span style={{fontSize:"18px"}}>ðŸ—‘ï¸</span>
                    </button>
                  </div>

                  {/* Content - with padding-right to avoid button overlap */}
                  <div style={{ paddingRight: '90px' }}>
                    <h3 style={{ margin: '0 0 8px 0', fontSize: '17px', fontWeight: '700', color: '#2c3e50', lineHeight: '1.3' }}>
                      {expense.title}
                    </h3>
                    <div style={{ fontSize: '13px', color: '#7f8c8d', marginBottom: '3px' }}>
                      ðŸ“… {new Date(expense.purchaseDate).toLocaleDateString()}
                    </div>
                    <div style={{ fontSize: '13px', color: '#7f8c8d', marginBottom: '10px' }}>
                      ðŸ“¦ {expense.quantity} {expense.unit}
                    </div>
                    
                    {/* Price info */}
                    <div style={{
                      padding: '10px 12px',
                      background: '#fee2e2',
                      borderRadius: '10px',
                      border: '2px solid #fca5a5',
                      display: 'inline-block'
                    }}>
                      <div style={{ fontSize: '22px', fontWeight: '700', color: '#e74c3c', marginBottom: '2px' }}>
                        â‚¹{expense.cost.toFixed(2)}
                      </div>
                      <div style={{ fontSize: '12px', color: '#7f8c8d' }}>
                        â‚¹{(expense.cost / expense.quantity).toFixed(2)}/{expense.unit}
                      </div>
                    </div>
                  </div>

                  {/* Notes */}
                  {expense.notes && (
                    <div style={{
                      padding: '12px',
                      background: '#fff9e6',
                      borderRadius: '8px',
                      marginTop: '12px',
                      border: '2px solid #ffd54f'
                    }}>
                      <div style={{
                        fontSize: '14px',
                        color: '#5d4037',
                        fontWeight: '600',
                        marginBottom: '6px',
                        display: 'flex',
                        alignItems: 'center',
                        gap: '6px'
                      }}>
                        <span style={{fontSize:'16px'}}>ðŸ“</span>
                        Notes
                      </div>
                      <div style={{
                        fontSize: '14px',
                        color: '#4e342e',
                        lineHeight: '1.5',
                        whiteSpace: 'pre-wrap'
                      }}>
                        {expense.notes}
                      </div>
                    </div>
                  )}
                </div>
              ))}
            </div>
          )}
        </div>
      )}

      {/* Contract Work View */}
      {activeView === 'contract' && (
        <div style={{ padding: '20px' }}>
          <div style={{
            display: 'flex',
            justifyContent: 'space-between',
            alignItems: 'center',
            marginBottom: '20px'
          }}>
            <h2 style={{ margin: 0, fontSize: '22px', fontWeight: '700', color: '#2c3e50' }}>
              ðŸ“‹ Project Works
            </h2>
            <button
              onClick={() => {
                setEditingContract(null);
                setContractData({
                  workTitle: '',
                  supervisor: '',
                  numberOfPeople: '',
                  date: formatLocalDate(new Date()),
                  paymentDone: '',
                  contractCost: '',
                  totalItemCost: '',
                  totalLaborCost: '',
                  notes: '',
                  items: [{ name: '', qty: '', unit: '', cost: '' }]
                });
                setShowContractModal(true);
              }}
              style={{
                padding: '12px 24px',
                background: 'linear-gradient(135deg, #9b59b6 0%, #8e44ad 100%)',
                color: 'white',
                border: 'none',
                borderRadius: '12px',
                cursor: 'pointer',
                fontSize: '16px',
                fontWeight: '600',
                display: 'flex',
                alignItems: 'center',
                gap: '8px',
                boxShadow: '0 4px 12px rgba(155,89,182,0.3)'
              }}
            >
              <span style={{fontSize:'20px'}}>+</span>
              Add Project
            </button>
          </div>

          {contractWorks.length === 0 ? (
            <div style={{
              background: 'white',
              borderRadius: '16px',
              padding: '60px 20px',
              textAlign: 'center',
              boxShadow: '0 2px 12px rgba(0,0,0,0.08)'
            }}>
              <div style={{ fontSize: '64px', marginBottom: '16px' }}>ðŸ“‹</div>
              <h3 style={{ margin: '0 0 8px 0', fontSize: '20px', fontWeight: '700', color: '#2c3e50' }}>
                No Projects Yet
              </h3>
              <p style={{ margin: 0, color: '#7f8c8d' }}>Add projects to track external work</p>
            </div>
          ) : (
            <div style={{ display: 'flex', flexDirection: 'column', gap: '16px' }}>
              {contractWorks.sort((a, b) => new Date(b.date) - new Date(a.date)).map(contract => (
                <div key={contract.id} style={{
                  background: 'white',
                  borderRadius: '16px',
                  padding: '20px',
                  boxShadow: '0 2px 12px rgba(0,0,0,0.08)',
                  border: '2px solid #f0f0f0'
                }}>
                  {/* Header with Title and Actions */}
                  <div style={{
                    display: 'flex',
                    justifyContent: 'space-between',
                    alignItems: 'flex-start',
                    marginBottom: '16px',
                    paddingBottom: '16px',
                    borderBottom: '2px solid #f5f5f5'
                  }}>
                    <div style={{ flex: 1 }}>
                      <h3 style={{
                        margin: '0 0 8px 0',
                        fontSize: '20px',
                        fontWeight: '700',
                        color: '#2c3e50'
                      }}>
                        {contract.workTitle}
                      </h3>
                      <div style={{
                        display: 'flex',
                        alignItems: 'center',
                        gap: '12px',
                        flexWrap: 'wrap'
                      }}>
                        <span style={{
                          fontSize: '14px',
                          color: '#7f8c8d',
                          display: 'flex',
                          alignItems: 'center',
                          gap: '4px'
                        }}>
                          <span style={{fontSize:'16px'}}>ðŸ“…</span>
                          {new Date(contract.date).toLocaleDateString('en-IN', {
                            day: 'numeric',
                            month: 'short',
                            year: 'numeric'
                          })}
                        </span>
                        {contract.supervisor && (
                          <span style={{
                            padding: '4px 12px',
                            background: '#e3f2fd',
                            color: '#1976d2',
                            borderRadius: '12px',
                            fontSize: '13px',
                            fontWeight: '600'
                          }}>
                            ðŸ‘· {contract.supervisor}
                          </span>
                        )}
                        {contract.numberOfPeople && (
                          <span style={{
                            padding: '4px 12px',
                            background: '#f3e5f5',
                            color: '#7b1fa2',
                            borderRadius: '12px',
                            fontSize: '13px',
                            fontWeight: '600'
                          }}>
                            ðŸ‘¥ {contract.numberOfPeople} People
                          </span>
                        )}
                      </div>
                    </div>
                    <div style={{ display: 'flex', gap: '8px' }}>
                      <button
                        onClick={() => editContract(contract)}
                        style={{
                          padding: '8px 12px',
                          background: '#3498db',
                          color: 'white',
                          border: 'none',
                          borderRadius: '8px',
                          cursor: 'pointer',
                          fontSize: '14px',
                          fontWeight: '600'
                        }}
                      >
                        <span style={{fontSize:'18px'}}>âœï¸</span>
                      </button>
                      <button
                        onClick={() => deleteContract(contract.id)}
                        style={{
                          padding: '8px 12px',
                          background: '#e74c3c',
                          color: 'white',
                          border: 'none',
                          borderRadius: '8px',
                          cursor: 'pointer',
                          fontSize: '14px',
                          fontWeight: '600'
                        }}
                      >
                        <span style={{fontSize:'18px'}}>ðŸ—‘ï¸</span>
                      </button>
                    </div>
                  </div>

                  {/* Items / Inventory Table */}
                  {contract.items && contract.items.filter(i => i.name).length > 0 && (
                    <div style={{
                      padding: '14px',
                      background: '#f0f4ff',
                      borderRadius: '10px',
                      marginBottom: '14px',
                      border: '2px solid #c7d2fe'
                    }}>
                      <div style={{ fontSize: '13px', fontWeight: '700', color: '#4f46e5', marginBottom: '10px', display: 'flex', alignItems: 'center', gap: '6px' }}>
                        <span>ðŸ“¦</span> Items / Inventory Used
                      </div>
                      {/* Table Header */}
                      <div style={{ display: 'grid', gridTemplateColumns: '2fr 1fr 1fr 1fr', gap: '6px', marginBottom: '6px', padding: '0 2px' }}>
                        {['Item Name', 'Qty', 'Unit', 'Cost (â‚¹)'].map((h, i) => (
                          <div key={i} style={{ fontSize: '11px', fontWeight: '700', color: '#6366f1', textTransform: 'uppercase', letterSpacing: '0.4px' }}>{h}</div>
                        ))}
                      </div>
                      {/* Table Rows */}
                      {contract.items.filter(i => i.name).map((item, idx) => (
                        <div key={idx} style={{
                          display: 'grid', gridTemplateColumns: '2fr 1fr 1fr 1fr', gap: '6px',
                          padding: '8px', background: 'white', borderRadius: '8px', marginBottom: '4px',
                          border: '1px solid #e0e7ff'
                        }}>
                          <div style={{ fontSize: '13px', fontWeight: '600', color: '#1e1b4b' }}>{item.name}</div>
                          <div style={{ fontSize: '13px', color: '#374151' }}>{item.qty || 'â€”'}</div>
                          <div style={{ fontSize: '13px', color: '#374151' }}>{item.unit || 'â€”'}</div>
                          <div style={{ fontSize: '13px', fontWeight: '600', color: '#4f46e5' }}>
                            {item.cost ? `â‚¹${parseFloat(item.cost).toLocaleString()}` : 'â€”'}
                          </div>
                        </div>
                      ))}
                    </div>
                  )}

                  {/* Financial Summary Cards */}
                  <div style={{
                    display: 'grid',
                    gridTemplateColumns: 'repeat(auto-fit, minmax(130px, 1fr))',
                    gap: '10px',
                    marginBottom: '12px'
                  }}>
                    {contract.totalItemCost > 0 && (
                      <div style={{ padding: '14px', background: 'linear-gradient(135deg, #ede9fe 0%, #ddd6fe 100%)', borderRadius: '12px', border: '2px solid #8b5cf6' }}>
                        <div style={{ fontSize: '11px', color: '#5b21b6', fontWeight: '700', marginBottom: '4px', textTransform: 'uppercase', letterSpacing: '0.4px' }}>Total Item Cost</div>
                        <div style={{ fontSize: '20px', fontWeight: '700', color: '#7c3aed' }}>â‚¹{contract.totalItemCost.toLocaleString()}</div>
                      </div>
                    )}
                    {contract.totalLaborCost > 0 && (
                      <div style={{ padding: '14px', background: 'linear-gradient(135deg, #fef3c7 0%, #fde68a 100%)', borderRadius: '12px', border: '2px solid #f59e0b' }}>
                        <div style={{ fontSize: '11px', color: '#92400e', fontWeight: '700', marginBottom: '4px', textTransform: 'uppercase', letterSpacing: '0.4px' }}>Total Labor Cost</div>
                        <div style={{ fontSize: '20px', fontWeight: '700', color: '#d97706' }}>â‚¹{contract.totalLaborCost.toLocaleString()}</div>
                      </div>
                    )}
                    {contract.contractCost > 0 && (
                      <div style={{ padding: '14px', background: 'linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%)', borderRadius: '12px', border: '2px solid #3b82f6' }}>
                        <div style={{ fontSize: '11px', color: '#1e40af', fontWeight: '700', marginBottom: '4px', textTransform: 'uppercase', letterSpacing: '0.4px' }}>Contract Cost</div>
                        <div style={{ fontSize: '20px', fontWeight: '700', color: '#2563eb' }}>â‚¹{contract.contractCost.toLocaleString()}</div>
                      </div>
                    )}
                    {contract.paymentDone > 0 && (
                      <div style={{ padding: '14px', background: 'linear-gradient(135deg, #d1fae5 0%, #a7f3d0 100%)', borderRadius: '12px', border: '2px solid #10b981' }}>
                        <div style={{ fontSize: '11px', color: '#065f46', fontWeight: '700', marginBottom: '4px', textTransform: 'uppercase', letterSpacing: '0.4px' }}>Advance Amount</div>
                        <div style={{ fontSize: '20px', fontWeight: '700', color: '#059669' }}>â‚¹{contract.paymentDone.toLocaleString()}</div>
                      </div>
                    )}
                  </div>

                  {/* Notes */}
                  {contract.notes && (
                    <div style={{
                      padding: '12px',
                      background: '#fff9e6',
                      borderRadius: '8px',
                      marginTop: '4px',
                      border: '2px solid #ffd54f'
                    }}>
                      <div style={{
                        fontSize: '14px',
                        color: '#5d4037',
                        fontWeight: '600',
                        marginBottom: '6px',
                        display: 'flex',
                        alignItems: 'center',
                        gap: '6px'
                      }}>
                        <span style={{fontSize:'16px'}}>ðŸ“</span>
                        Notes
                      </div>
                      <div style={{
                        fontSize: '14px',
                        color: '#4e342e',
                        lineHeight: '1.5',
                        whiteSpace: 'pre-wrap'
                      }}>
                        {contract.notes}
                      </div>
                    </div>
                  )}
                </div>
              ))}
            </div>
          )}
        </div>
      )}

      {/* Phonebook View */}
      {activeView === 'phonebook' && (
        <div style={{ padding: '20px' }}>
          {/* Header */}
          <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '20px' }}>
            <h2 style={{ margin: 0, fontSize: '22px', fontWeight: '700', color: '#2c3e50' }}>
              ðŸ“ž Phonebook
            </h2>
            <button
              onClick={() => {
                setEditingContact(null);
                setContactData({ name: '', location: '', phone: '', whatsapp: '', rate: '', notes: '' });
                setShowContactModal(true);
              }}
              style={{
                padding: '12px 20px',
                background: 'linear-gradient(135deg, #1abc9c 0%, #16a085 100%)',
                color: 'white',
                border: 'none',
                borderRadius: '12px',
                display: 'flex',
                alignItems: 'center',
                gap: '8px',
                fontSize: '15px',
                fontWeight: '600',
                cursor: 'pointer',
                boxShadow: '0 4px 12px rgba(26,188,156,0.35)'
              }}
            >
              <span style={{ fontSize: '18px' }}>+</span> Add Contact
            </button>
          </div>

          {/* Search Bar */}
          {contacts.length > 0 && (
            <div style={{ marginBottom: '16px', position: 'relative' }}>
              <span style={{ position: 'absolute', left: '14px', top: '50%', transform: 'translateY(-50%)', fontSize: '18px' }}>ðŸ”</span>
              <input
                type="text"
                value={contactSearch}
                onChange={(e) => setContactSearch(e.target.value)}
                placeholder="Search contacts by name, location or phone..."
                style={{
                  width: '100%',
                  padding: '12px 14px 12px 42px',
                  border: '2px solid #e0e0e0',
                  borderRadius: '12px',
                  fontSize: '15px',
                  fontFamily: 'inherit',
                  outline: 'none'
                }}
              />
            </div>
          )}

          {/* Empty State */}
          {contacts.length === 0 ? (
            <div style={{
              background: 'white',
              borderRadius: '16px',
              padding: '48px 24px',
              textAlign: 'center',
              boxShadow: '0 2px 12px rgba(0,0,0,0.08)'
            }}>
              <div style={{ fontSize: '64px', marginBottom: '16px' }}>ðŸ“ž</div>
              <h3 style={{ margin: '0 0 8px 0', fontSize: '20px', color: '#2c3e50' }}>No Contacts Yet</h3>
              <p style={{ margin: '0 0 24px 0', color: '#7f8c8d', fontSize: '15px' }}>
                Add farm worker contacts for quick access
              </p>
              <button
                onClick={() => {
                  setEditingContact(null);
                  setContactData({ name: '', location: '', phone: '', whatsapp: '', rate: '', notes: '' });
                  setShowContactModal(true);
                }}
                style={{
                  padding: '14px 32px',
                  background: 'linear-gradient(135deg, #1abc9c 0%, #16a085 100%)',
                  color: 'white', border: 'none', borderRadius: '12px',
                  fontSize: '16px', fontWeight: '600', cursor: 'pointer'
                }}
              >
                + Add First Contact
              </button>
            </div>
          ) : (
            <div style={{ display: 'flex', flexDirection: 'column', gap: '12px' }}>
              {contacts
                .filter(c => {
                  const q = contactSearch.toLowerCase();
                  return !q ||
                    (c.name && c.name.toLowerCase().includes(q)) ||
                    (c.location && c.location.toLowerCase().includes(q)) ||
                    (c.phone && c.phone.includes(q)) ||
                    (c.whatsapp && c.whatsapp.includes(q));
                })
                .sort((a, b) => (a.name || '').localeCompare(b.name || ''))
                .map(contact => (
                  <div key={contact.id} style={{
                    background: 'white',
                    borderRadius: '16px',
                    padding: '16px',
                    boxShadow: '0 2px 12px rgba(0,0,0,0.08)',
                    borderLeft: '4px solid #1abc9c',
                    position: 'relative'
                  }}>
                    {/* Edit / Delete buttons - positioned at top-right */}
                    <div style={{
                      position: 'absolute',
                      top: '12px',
                      right: '12px',
                      display: 'flex',
                      gap: '6px',
                      zIndex: 10
                    }}>
                      <button
                        onClick={() => editContactFn(contact)}
                        style={{
                          background: '#3498db',
                          color: 'white',
                          border: 'none',
                          padding: '8px',
                          borderRadius: '8px',
                          cursor: 'pointer',
                          display: 'flex',
                          alignItems: 'center',
                          justifyContent: 'center',
                          width: '36px',
                          height: '36px',
                          flexShrink: 0
                        }}
                      >
                        <span style={{ fontSize: '18px' }}>âœï¸</span>
                      </button>
                      <button
                        onClick={() => deleteContact(contact.id)}
                        style={{
                          background: '#e74c3c',
                          color: 'white',
                          border: 'none',
                          padding: '8px',
                          borderRadius: '8px',
                          cursor: 'pointer',
                          display: 'flex',
                          alignItems: 'center',
                          justifyContent: 'center',
                          width: '36px',
                          height: '36px',
                          flexShrink: 0
                        }}
                      >
                        <span style={{ fontSize: '18px' }}>ðŸ—‘ï¸</span>
                      </button>
                    </div>

                    {/* Contact info - with padding-right to avoid button overlap */}
                    <div style={{ paddingRight: '90px', marginBottom: '14px' }}>
                      <div style={{ display: 'flex', alignItems: 'center', gap: '12px' }}>
                        {/* Avatar Circle */}
                        <div style={{
                          width: '48px', height: '48px', borderRadius: '50%',
                          background: 'linear-gradient(135deg, #1abc9c 0%, #16a085 100%)',
                          display: 'flex', alignItems: 'center', justifyContent: 'center',
                          fontSize: '20px', fontWeight: '700', color: 'white',
                          flexShrink: 0
                        }}>
                          {(contact.name || '?').charAt(0).toUpperCase()}
                        </div>
                        <div style={{ flex: 1, minWidth: 0 }}>
                          <h3 style={{ margin: '0 0 4px 0', fontSize: '17px', fontWeight: '700', color: '#2c3e50', lineHeight: '1.3', wordBreak: 'break-word' }}>
                            {contact.name}
                          </h3>
                          {contact.location && (
                            <div style={{ fontSize: '13px', color: '#7f8c8d', display: 'flex', alignItems: 'center', gap: '4px' }}>
                              <span>ðŸ“</span> {contact.location}
                            </div>
                          )}
                        </div>
                      </div>
                    </div>

                    {/* Contact Details Grid */}
                    <div style={{ display: 'flex', flexDirection: 'column', gap: '8px' }}>
                      {contact.phone && (
                        <div style={{
                          display: 'flex', alignItems: 'center', gap: '10px',
                          padding: '10px 14px', background: '#f0fdf4', borderRadius: '10px',
                          border: '1px solid #bbf7d0'
                        }}>
                          <span style={{ fontSize: '18px' }}>ðŸ“±</span>
                          <div style={{ flex: 1 }}>
                            <div style={{ fontSize: '11px', color: '#6b7280', fontWeight: '600', textTransform: 'uppercase', letterSpacing: '0.5px' }}>Phone</div>
                            <div style={{ fontSize: '16px', fontWeight: '700', color: '#1a1a1a' }}>{contact.phone}</div>
                          </div>
                          <a href={`tel:${contact.phone}`} style={{
                            padding: '6px 14px', background: '#1abc9c', color: 'white',
                            borderRadius: '8px', textDecoration: 'none', fontSize: '13px', fontWeight: '600'
                          }}>Call</a>
                        </div>
                      )}

                      {contact.whatsapp && (
                        <div style={{
                          display: 'flex', alignItems: 'center', gap: '10px',
                          padding: '10px 14px', background: '#f0fdf4', borderRadius: '10px',
                          border: '1px solid #bbf7d0'
                        }}>
                          <span style={{ fontSize: '18px' }}>ðŸ’¬</span>
                          <div style={{ flex: 1 }}>
                            <div style={{ fontSize: '11px', color: '#6b7280', fontWeight: '600', textTransform: 'uppercase', letterSpacing: '0.5px' }}>WhatsApp</div>
                            <div style={{ fontSize: '16px', fontWeight: '700', color: '#1a1a1a' }}>{contact.whatsapp}</div>
                          </div>
                          <a href={`https://wa.me/${contact.whatsapp.replace(/\D/g, '')}`} target="_blank" rel="noopener noreferrer" style={{
                            padding: '6px 14px', background: '#25d366', color: 'white',
                            borderRadius: '8px', textDecoration: 'none', fontSize: '13px', fontWeight: '600'
                          }}>Chat</a>
                        </div>
                      )}

                      {contact.rate && (
                        <div style={{
                          display: 'flex', alignItems: 'center', gap: '10px',
                          padding: '10px 14px', background: '#fffbeb', borderRadius: '10px',
                          border: '1px solid #fde68a'
                        }}>
                          <span style={{ fontSize: '18px' }}>ðŸ’°</span>
                          <div>
                            <div style={{ fontSize: '11px', color: '#6b7280', fontWeight: '600', textTransform: 'uppercase', letterSpacing: '0.5px' }}>Latest Rate / Wage</div>
                            <div style={{ fontSize: '16px', fontWeight: '700', color: '#92400e' }}>{contact.rate}</div>
                          </div>
                        </div>
                      )}

                      {contact.notes && (
                        <div style={{
                          padding: '10px 14px', background: '#fff9e6', borderRadius: '10px',
                          border: '1px solid #fde68a'
                        }}>
                          <div style={{ fontSize: '11px', color: '#6b7280', fontWeight: '600', textTransform: 'uppercase', letterSpacing: '0.5px', marginBottom: '4px', display: 'flex', alignItems: 'center', gap: '6px' }}>
                            <span style={{ fontSize: '14px' }}>ðŸ“</span> Notes
                          </div>
                          <div style={{ fontSize: '14px', color: '#4e342e', lineHeight: '1.5', whiteSpace: 'pre-wrap' }}>
                            {contact.notes}
                          </div>
                        </div>
                      )}
                    </div>
                  </div>
                ))
              }
              {/* No search results */}
              {contacts.filter(c => {
                const q = contactSearch.toLowerCase();
                return !q ||
                  (c.name && c.name.toLowerCase().includes(q)) ||
                  (c.location && c.location.toLowerCase().includes(q)) ||
                  (c.phone && c.phone.includes(q)) ||
                  (c.whatsapp && c.whatsapp.includes(q));
              }).length === 0 && (
                <div style={{ textAlign: 'center', padding: '40px', color: '#7f8c8d', background: 'white', borderRadius: '16px', boxShadow: '0 2px 8px rgba(0,0,0,0.06)' }}>
                  <div style={{ fontSize: '40px', marginBottom: '12px' }}>ðŸ”</div>
                  <p style={{ margin: 0, fontSize: '16px' }}>No contacts match "<strong>{contactSearch}</strong>"</p>
                </div>
              )}
            </div>
          )}
        </div>
      )}

      {/* Contact Modal */}
      {showContactModal && (
        <div style={{
          position: 'fixed', top: 0, left: 0, right: 0, bottom: 0,
          background: 'rgba(0,0,0,0.5)', display: 'flex',
          alignItems: 'center', justifyContent: 'center', zIndex: 1000, padding: '20px'
        }}>
          <div style={{
            background: 'white', borderRadius: '20px', maxWidth: '450px',
            width: '100%', maxHeight: '90vh', display: 'flex', flexDirection: 'column',
            boxShadow: '0 20px 60px rgba(0,0,0,0.3)'
          }}>
            {/* Modal Header */}
            <div style={{
              padding: '20px 24px 16px', borderBottom: '2px solid #f0f0f0',
              position: 'sticky', top: 0, background: 'white', borderRadius: '20px 20px 0 0'
            }}>
              <div style={{ display: 'flex', alignItems: 'center', gap: '12px' }}>
                <div style={{
                  width: '40px', height: '40px', borderRadius: '10px',
                  background: 'linear-gradient(135deg, #1abc9c 0%, #16a085 100%)',
                  display: 'flex', alignItems: 'center', justifyContent: 'center', fontSize: '20px'
                }}>ðŸ“ž</div>
                <h3 style={{ margin: 0, fontSize: '20px', fontWeight: '700', color: '#2c3e50' }}>
                  {editingContact ? 'Edit Contact' : 'New Contact'}
                </h3>
              </div>
            </div>

            {/* Modal Body */}
            <div style={{ padding: '20px 24px', overflowY: 'auto', flex: 1 }}>
              <div style={{ display: 'flex', flexDirection: 'column', gap: '16px' }}>
                {/* Name */}
                <div>
                  <label style={{ display: 'block', fontSize: '14px', fontWeight: '600', color: '#2c3e50', marginBottom: '8px' }}>
                    Name <span style={{ color: '#e74c3c' }}>*</span>
                  </label>
                  <input
                    type="text"
                    value={contactData.name}
                    onChange={(e) => setContactData({ ...contactData, name: e.target.value })}
                    placeholder="e.g., Ramesh Kumar"
                    style={{
                      width: '100%', padding: '12px 14px', border: '2px solid #e0e0e0',
                      borderRadius: '12px', fontSize: '15px', fontFamily: 'inherit', outline: 'none'
                    }}
                  />
                </div>

                {/* Location */}
                <div>
                  <label style={{ display: 'block', fontSize: '14px', fontWeight: '600', color: '#2c3e50', marginBottom: '8px' }}>
                    Location
                  </label>
                  <input
                    type="text"
                    value={contactData.location}
                    onChange={(e) => setContactData({ ...contactData, location: e.target.value })}
                    placeholder="e.g., Village, District"
                    style={{
                      width: '100%', padding: '12px 14px', border: '2px solid #e0e0e0',
                      borderRadius: '12px', fontSize: '15px', fontFamily: 'inherit', outline: 'none'
                    }}
                  />
                </div>

                {/* Phone & WhatsApp side by side */}
                <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '12px' }}>
                  <div>
                    <label style={{ display: 'block', fontSize: '14px', fontWeight: '600', color: '#2c3e50', marginBottom: '8px' }}>
                      ðŸ“± Phone Number
                    </label>
                    <input
                      type="tel"
                      value={contactData.phone}
                      onChange={(e) => setContactData({ ...contactData, phone: e.target.value })}
                      placeholder="e.g., 9876543210"
                      style={{
                        width: '100%', padding: '12px 14px', border: '2px solid #e0e0e0',
                        borderRadius: '12px', fontSize: '15px', fontFamily: 'inherit', outline: 'none'
                      }}
                    />
                  </div>
                  <div>
                    <label style={{ display: 'block', fontSize: '14px', fontWeight: '600', color: '#2c3e50', marginBottom: '8px' }}>
                      ðŸ’¬ WhatsApp
                    </label>
                    <input
                      type="tel"
                      value={contactData.whatsapp}
                      onChange={(e) => setContactData({ ...contactData, whatsapp: e.target.value })}
                      placeholder="e.g., 9876543210"
                      style={{
                        width: '100%', padding: '12px 14px', border: '2px solid #e0e0e0',
                        borderRadius: '12px', fontSize: '15px', fontFamily: 'inherit', outline: 'none'
                      }}
                    />
                  </div>
                </div>

                {/* Latest Rate */}
                <div>
                  <label style={{ display: 'block', fontSize: '14px', fontWeight: '600', color: '#2c3e50', marginBottom: '8px' }}>
                    ðŸ’° Latest Rate / Wage
                  </label>
                  <input
                    type="text"
                    value={contactData.rate}
                    onChange={(e) => setContactData({ ...contactData, rate: e.target.value })}
                    placeholder="e.g., â‚¹600/day, â‚¹80/hour"
                    style={{
                      width: '100%', padding: '12px 14px', border: '2px solid #e0e0e0',
                      borderRadius: '12px', fontSize: '15px', fontFamily: 'inherit', outline: 'none'
                    }}
                  />
                </div>

                {/* Notes */}
                <div>
                  <label style={{ display: 'block', fontSize: '14px', fontWeight: '600', color: '#2c3e50', marginBottom: '8px' }}>
                    ðŸ“ Notes
                  </label>
                  <textarea
                    value={contactData.notes}
                    onChange={(e) => setContactData({ ...contactData, notes: e.target.value })}
                    placeholder="Additional notes about this worker..."
                    rows="3"
                    style={{
                      width: '100%', padding: '12px 14px', border: '2px solid #e0e0e0',
                      borderRadius: '12px', fontSize: '15px', fontFamily: 'inherit', outline: 'none',
                      resize: 'vertical'
                    }}
                  />
                </div>
              </div>
            </div>

            {/* Modal Footer */}
            <div style={{
              padding: '16px 24px', borderTop: '2px solid #f0f0f0',
              display: 'flex', gap: '12px',
              position: 'sticky', bottom: 0, background: 'white', borderRadius: '0 0 20px 20px'
            }}>
              <button
                onClick={() => {
                  setShowContactModal(false);
                  setEditingContact(null);
                  setContactData({ name: '', location: '', phone: '', whatsapp: '', rate: '', notes: '' });
                }}
                style={{
                  flex: 1, padding: '14px', border: '2px solid #e0e0e0', background: 'white',
                  borderRadius: '12px', fontSize: '15px', fontWeight: '600', color: '#2c3e50', cursor: 'pointer'
                }}
              >
                Cancel
              </button>
              <button
                onClick={saveContact}
                style={{
                  flex: 1, padding: '14px', border: 'none',
                  background: 'linear-gradient(135deg, #1abc9c 0%, #16a085 100%)',
                  borderRadius: '12px', fontSize: '15px', fontWeight: '600', color: 'white',
                  cursor: 'pointer', boxShadow: '0 4px 12px rgba(26,188,156,0.35)'
                }}
              >
                {editingContact ? 'âœ“ Update Contact' : '+ Save Contact'}
              </button>
            </div>
          </div>
        </div>
      )}

      {/* Reports View */}
      {activeView === 'reports' && (
        <div style={{ padding: '20px' }}>
          <h2 style={{ margin: '0 0 20px 0', fontSize: '22px', fontWeight: '700', color: '#2c3e50' }}>
            Reports
          </h2>

          {/* Report Type Selector */}
          <div style={{
            background: 'white',
            borderRadius: '16px',
            padding: '16px',
            marginBottom: '20px',
            boxShadow: '0 2px 12px rgba(0,0,0,0.08)'
          }}>
            <div style={{ display: 'flex', gap: '12px' }}>
              <button
                onClick={() => setReportType('regular')}
                style={{
                  flex: 1,
                  padding: '14px',
                  border: reportType === 'regular' ? '2px solid #0077b6' : '2px solid #e0e0e0',
                  background: reportType === 'regular' ? '#d4edda' : 'white',
                  borderRadius: '12px',
                  fontSize: '15px',
                  fontWeight: '600',
                  color: reportType === 'regular' ? '#155724' : '#7f8c8d',
                  cursor: 'pointer'
                }}
              >
                ðŸ‘· Regular Work
              </button>
              <button
                onClick={() => setReportType('seasonal')}
                style={{
                  flex: 1,
                  padding: '14px',
                  border: reportType === 'seasonal' ? '2px solid #f39c12' : '2px solid #e0e0e0',
                  background: reportType === 'seasonal' ? '#fff3cd' : 'white',
                  borderRadius: '12px',
                  fontSize: '15px',
                  fontWeight: '600',
                  color: reportType === 'seasonal' ? '#856404' : '#7f8c8d',
                  cursor: 'pointer'
                }}
              >
                ðŸŒ¾ Seasonal Work
              </button>
            </div>
          </div>

          {reportType === 'regular' ? (
            <>
              {/* Month Navigation for Regular Reports */}
              <div style={{
                background: 'white',
                borderRadius: '16px',
                padding: '16px',
                marginBottom: '20px',
                display: 'flex',
                justifyContent: 'space-between',
                alignItems: 'center',
                boxShadow: '0 2px 12px rgba(0,0,0,0.08)'
              }}>
                <button
                  onClick={() => navigateReportMonth('prev')}
                  style={{
                    background: '#8b6f47',
                    color: 'white',
                border: 'none',
                padding: '10px 16px',
                borderRadius: '10px',
                fontSize: '14px',
                fontWeight: '600',
                cursor: 'pointer'
              }}
            >
              â† Previous
            </button>
            <div style={{ fontSize: '18px', fontWeight: '700', color: '#2c3e50' }}>
              {reportMonth.toLocaleDateString('en-IN', { month: 'long', year: 'numeric' })}
            </div>
            <button
              onClick={() => navigateReportMonth('next')}
              disabled={reportMonth.getMonth() >= new Date().getMonth() && reportMonth.getFullYear() >= new Date().getFullYear()}
              style={{
                background: (reportMonth.getMonth() >= new Date().getMonth() && reportMonth.getFullYear() >= new Date().getFullYear()) ? '#bdc3c7' : '#8b6f47',
                color: 'white',
                border: 'none',
                padding: '10px 16px',
                borderRadius: '10px',
                fontSize: '14px',
                fontWeight: '600',
                cursor: (reportMonth.getMonth() >= new Date().getMonth() && reportMonth.getFullYear() >= new Date().getFullYear()) ? 'not-allowed' : 'pointer'
              }}
            >
              Next â†’
            </button>
          </div>

          {workers.filter(w => (w.type === 'regular' || !w.type) && w.active !== false).length === 0 ? (
            <div style={{
              background: 'white',
              borderRadius: '16px',
              padding: '60px 20px',
              textAlign: 'center',
              boxShadow: '0 2px 12px rgba(0,0,0,0.08)'
            }}>
              <div style={{ fontSize: '48px', marginBottom: '16px' }}>ðŸ“Š</div>
              <h3 style={{ margin: '0 0 8px 0', color: '#2c3e50' }}>No Regular Workers</h3>
              <p style={{ margin: 0, color: '#7f8c8d' }}>Add regular workers to generate reports</p>
            </div>
          ) : (
            <>
              {/* Summary Cards */}
              <div style={{
                display: 'grid',
                gridTemplateColumns: 'repeat(2, 1fr)',
                gap: '12px',
                marginBottom: '20px'
              }}>
                {(() => {
                  const reportData = getMonthReport(reportMonth, 'regular');
                  const totalEarned = reportData.reduce((sum, r) => sum + r.earned, 0);
                  const totalBalance = reportData.reduce((sum, r) => sum + r.finalBalance, 0);
                  const totalDays = reportData.reduce((sum, r) => sum + r.totalDays, 0);
                  
                  return (
                    <>
                      <StatCard 
                        icon={<span style={{fontSize:"20px"}}>ðŸ’°</span>}
                        label="Total Earned"
                        value={`â‚¹${Math.round(totalEarned)}`}
                        color="#0077b6"
                      />
                      <StatCard 
                        icon={<span style={{fontSize:"20px"}}>ðŸ“ˆ</span>}
                        label="Net Payable"
                        value={`â‚¹${Math.round(totalBalance)}`}
                        color={totalBalance > 0 ? '#0077b6' : totalBalance < 0 ? '#e74c3c' : '#7f8c8d'}
                      />
                      <StatCard 
                        icon={<span style={{fontSize:"20px"}}>ðŸ“…</span>}
                        label="Total Days"
                        value={totalDays}
                        color="#3498db"
                      />
                      <StatCard 
                        icon={<span style={{fontSize:"20px"}}>ðŸ‘¥</span>}
                        label="Regular Workers"
                        value={reportData.length}
                        color="#9b59b6"
                      />
                    </>
                  );
                })()}
              </div>

              {/* Worker Reports */}
              <div style={{ display: 'flex', flexDirection: 'column', gap: '16px' }}>
                {getMonthReport(reportMonth, 'regular').map(report => (
                  <div key={report.worker.id} style={{
                    background: 'white',
                    borderRadius: '16px',
                    padding: '20px',
                    boxShadow: '0 2px 12px rgba(0,0,0,0.08)'
                  }}>
                    {/* Header */}
                    <div style={{
                      display: 'flex',
                      justifyContent: 'space-between',
                      alignItems: 'flex-start',
                      marginBottom: '16px',
                      paddingBottom: '16px',
                      borderBottom: '2px solid #f0f0f0'
                    }}>
                      <div>
                        <h3 style={{ margin: '0 0 4px 0', fontSize: '18px', fontWeight: '700', color: '#2c3e50' }}>
                          {report.worker.name}
                        </h3>
                        <p style={{ margin: 0, fontSize: '14px', color: '#7f8c8d' }}>
                          â‚¹{report.worker.dailyWage}/day
                        </p>
                      </div>
                      <div style={{ textAlign: 'right' }}>
                        <div style={{ 
                          fontSize: '24px', 
                          fontWeight: '700', 
                          color: report.finalBalance > 0 ? '#0077b6' : report.finalBalance < 0 ? '#e74c3c' : '#7f8c8d'
                        }}>
                          â‚¹{Math.round(report.finalBalance)}
                        </div>
                        <div style={{ fontSize: '12px', color: '#7f8c8d' }}>
                          Current Balance
                        </div>
                      </div>
                    </div>

                    {/* Attendance Summary */}
                    <div style={{
                      background: '#f8f9fa',
                      borderRadius: '12px',
                      padding: '16px',
                      marginBottom: '12px'
                    }}>
                      <h4 style={{
                        margin: '0 0 12px 0',
                        fontSize: '14px',
                        fontWeight: '600',
                        color: '#2c3e50'
                      }}>
                        Attendance Summary
                      </h4>
                      <div style={{
                        display: 'grid',
                        gridTemplateColumns: 'repeat(3, 1fr)',
                        gap: '12px'
                      }}>
                        <div style={{ textAlign: 'center' }}>
                          <div style={{ fontSize: '24px', fontWeight: '700', color: '#0077b6' }}>
                            {report.fullDays}
                          </div>
                          <div style={{ fontSize: '12px', color: '#7f8c8d', marginTop: '4px' }}>
                            Full Days
                          </div>
                        </div>
                        <div style={{ textAlign: 'center' }}>
                          <div style={{ fontSize: '24px', fontWeight: '700', color: '#f39c12' }}>
                            {report.halfDays}
                          </div>
                          <div style={{ fontSize: '12px', color: '#7f8c8d', marginTop: '4px' }}>
                            Half Days
                          </div>
                        </div>
                        <div style={{ textAlign: 'center' }}>
                          <div style={{ fontSize: '24px', fontWeight: '700', color: '#e74c3c' }}>
                            {report.absentDays}
                          </div>
                          <div style={{ fontSize: '12px', color: '#7f8c8d', marginTop: '4px' }}>
                            Absent
                          </div>
                        </div>
                      </div>
                    </div>

                    {/* Payment Summary */}
                    <div style={{
                      background: '#f8f9fa',
                      borderRadius: '12px',
                      padding: '16px',
                      marginBottom: report.payments?.length > 0 || report.credits?.length > 0 ? '12px' : '0'
                    }}>
                      <h4 style={{
                        margin: '0 0 12px 0',
                        fontSize: '14px',
                        fontWeight: '600',
                        color: '#2c3e50'
                      }}>
                        Payment Summary
                      </h4>
                      <div style={{ display: 'flex', flexDirection: 'column', gap: '8px' }}>
                        {report.carriedForward !== 0 && (
                          <div style={{
                            display: 'flex',
                            justifyContent: 'space-between',
                            alignItems: 'center'
                          }}>
                            <span style={{ fontSize: '14px', color: '#7f8c8d' }}>Opening Balance (O)</span>
                            <span style={{ 
                              fontSize: '16px', 
                              fontWeight: '600',
                              color: report.carriedForward > 0 ? '#0077b6' : '#e74c3c'
                            }}>
                              â‚¹{Math.round(report.carriedForward)}
                            </span>
                          </div>
                        )}
                        <div style={{
                          display: 'flex',
                          justifyContent: 'space-between',
                          alignItems: 'center'
                        }}>
                          <span style={{ fontSize: '14px', color: '#7f8c8d' }}>Earnings (E)</span>
                          <span style={{ fontSize: '16px', fontWeight: '600', color: '#0077b6' }}>
                            +â‚¹{Math.round(report.earned)}
                          </span>
                        </div>
                        {report.totalPaid > 0 && (
                          <div style={{
                            display: 'flex',
                            justifyContent: 'space-between',
                            alignItems: 'center'
                          }}>
                            <span style={{ fontSize: '14px', color: '#7f8c8d' }}>Payments (P)</span>
                            <span style={{ fontSize: '16px', fontWeight: '600', color: '#e74c3c' }}>
                              -â‚¹{Math.round(report.totalPaid)}
                            </span>
                          </div>
                        )}
                        {report.totalCredits > 0 && (
                          <div style={{
                            display: 'flex',
                            justifyContent: 'space-between',
                            alignItems: 'center'
                          }}>
                            <span style={{ fontSize: '14px', color: '#7f8c8d' }}>Credit Deposit (D)</span>
                            <span style={{ fontSize: '16px', fontWeight: '600', color: '#e74c3c' }}>
                              -â‚¹{Math.round(report.totalCredits)}
                            </span>
                          </div>
                        )}
                        <div style={{
                          borderTop: '2px solid #e0e0e0',
                          paddingTop: '8px',
                          marginTop: '4px'
                        }}>
                          <div style={{
                            display: 'flex',
                            justifyContent: 'space-between',
                            alignItems: 'center'
                          }}>
                            <span style={{ fontSize: '15px', fontWeight: '600', color: '#2c3e50' }}>
                              Closing Balance (C)
                            </span>
                            <span style={{ 
                              fontSize: '18px', 
                              fontWeight: '700',
                              color: report.finalBalance > 0 ? '#0077b6' : report.finalBalance < 0 ? '#e74c3c' : '#7f8c8d'
                            }}>
                              â‚¹{Math.round(report.finalBalance)}
                            </span>
                          </div>
                        </div>
                      </div>
                    </div>

                    {/* Transaction History */}
                    {((report.payments && report.payments.length > 0) || (report.credits && report.credits.length > 0)) && (
                      <div style={{
                        background: '#f8f9fa',
                        borderRadius: '12px',
                        padding: '16px'
                      }}>
                        <h4 style={{
                          margin: '0 0 12px 0',
                          fontSize: '14px',
                          fontWeight: '600',
                          color: '#2c3e50'
                        }}>
                          Transactions This Month
                        </h4>
                        <div style={{ display: 'flex', flexDirection: 'column', gap: '10px' }}>
                          {report.payments && report.payments.map(payment => (
                            <div key={payment.id} style={{
                              background: 'white',
                              padding: '12px',
                              borderRadius: '8px',
                              borderLeft: '4px solid #3498db'
                            }}>
                              <div style={{
                                display: 'flex',
                                justifyContent: 'space-between',
                                alignItems: 'center',
                                marginBottom: payment.notes ? '8px' : '0'
                              }}>
                                <div>
                                  <div style={{ display: 'flex', alignItems: 'center', gap: '8px', marginBottom: '2px' }}>
                                    <div style={{ fontSize: '16px', fontWeight: '700', color: '#3498db' }}>
                                      ðŸ’° â‚¹{payment.amount}
                                    </div>
                                    <span style={{
                                      fontSize: '10px',
                                      padding: '2px 6px',
                                      borderRadius: '8px',
                                      background: '#ebf5fb',
                                      color: '#2874a6',
                                      fontWeight: '600'
                                    }}>
                                      PAYMENT
                                    </span>
                                  </div>
                                  <div style={{ fontSize: '12px', color: '#7f8c8d' }}>
                                    {new Date(payment.date).toLocaleDateString('en-IN', { 
                                      day: 'numeric', 
                                      month: 'short', 
                                      year: 'numeric' 
                                    })}
                                  </div>
                                </div>
                              </div>
                              {payment.notes && (
                                <div style={{
                                  fontSize: '13px',
                                  color: '#2c3e50',
                                  fontStyle: 'italic',
                                  paddingTop: '8px',
                                  borderTop: '1px solid #e0e0e0'
                                }}>
                                  ðŸ’¬ {payment.notes}
                                </div>
                              )}
                            </div>
                          ))}
                          
                          {report.credits && report.credits.map(credit => (
                            <div key={credit.id} style={{
                              background: 'white',
                              padding: '12px',
                              borderRadius: '8px',
                              borderLeft: '4px solid #0077b6'
                            }}>
                              <div style={{
                                display: 'flex',
                                justifyContent: 'space-between',
                                alignItems: 'center',
                                marginBottom: credit.notes ? '8px' : '0'
                              }}>
                                <div>
                                  <div style={{ display: 'flex', alignItems: 'center', gap: '8px', marginBottom: '2px' }}>
                                    <div style={{ fontSize: '16px', fontWeight: '700', color: '#0077b6' }}>
                                      ðŸ“¥ â‚¹{credit.amount}
                                    </div>
                                    <span style={{
                                      fontSize: '10px',
                                      padding: '2px 6px',
                                      borderRadius: '8px',
                                      background: '#d4edda',
                                      color: '#155724',
                                      fontWeight: '600'
                                    }}>
                                      CREDIT
                                    </span>
                                  </div>
                                  <div style={{ fontSize: '12px', color: '#7f8c8d' }}>
                                    {new Date(credit.date).toLocaleDateString('en-IN', { 
                                      day: 'numeric', 
                                      month: 'short', 
                                      year: 'numeric' 
                                    })}
                                  </div>
                                </div>
                              </div>
                              {credit.notes && (
                                <div style={{
                                  fontSize: '13px',
                                  color: '#2c3e50',
                                  fontStyle: 'italic',
                                  paddingTop: '8px',
                                  borderTop: '1px solid #e0e0e0'
                                }}>
                                  ðŸ’¬ {credit.notes}
                                </div>
                              )}
                            </div>
                          ))}
                        </div>
                      </div>
                    )}
                  </div>
                ))}
              </div>
            </>
          )}
            </>
          ) : (
            /* Seasonal Reports - Yearly View */
            <>
              {/* Year Navigation */}
              <div style={{
                background: 'white',
                borderRadius: '16px',
                padding: '16px',
                marginBottom: '20px',
                display: 'flex',
                justifyContent: 'space-between',
                alignItems: 'center',
                boxShadow: '0 2px 12px rgba(0,0,0,0.08)'
              }}>
                <button
                  onClick={() => setSeasonalReportYear(seasonalReportYear - 1)}
                  style={{
                    background: theme.primary,
                    color: 'white',
                    border: 'none',
                    padding: '10px 16px',
                    borderRadius: '10px',
                    fontSize: '14px',
                    fontWeight: '600',
                    cursor: 'pointer',
                    display: 'flex',
                    alignItems: 'center',
                    gap: '6px'
                  }}
                >
                  <span style={{fontSize:"20px"}}>â€¹</span> Previous Year
                </button>
                <div style={{
                  fontSize: '20px',
                  fontWeight: '700',
                  color: theme.primary
                }}>
                  {seasonalReportYear}
                </div>
                <button
                  onClick={() => setSeasonalReportYear(seasonalReportYear + 1)}
                  disabled={seasonalReportYear >= new Date().getFullYear()}
                  style={{
                    background: seasonalReportYear >= new Date().getFullYear() ? '#bdc3c7' : theme.primary,
                    color: 'white',
                    border: 'none',
                    padding: '10px 16px',
                    borderRadius: '10px',
                    fontSize: '14px',
                    fontWeight: '600',
                    cursor: seasonalReportYear >= new Date().getFullYear() ? 'not-allowed' : 'pointer',
                    display: 'flex',
                    alignItems: 'center',
                    gap: '6px'
                  }}
                >
                  Next Year <span style={{fontSize:"24px"}}>â€º</span>
                </button>
              </div>

              {/* Seasonal Work Summary */}
              <div style={{
                background: 'white',
                borderRadius: '16px',
                padding: '20px',
                marginBottom: '20px',
                boxShadow: '0 2px 12px rgba(0,0,0,0.08)'
              }}>
                <h3 style={{ margin: '0 0 16px 0', fontSize: '18px', fontWeight: '700', color: '#2c3e50' }}>
                  Seasonal Work Summary - {seasonalReportYear}
                </h3>
                
                {(() => {
                  const yearWorks = seasonalWorks.filter(sw => {
                    const workYear = new Date(sw.startDate).getFullYear();
                    return workYear === seasonalReportYear;
                  });
                  
                  return yearWorks.length === 0 ? (
                    <div style={{ textAlign: 'center', padding: '40px 20px' }}>
                      <div style={{ fontSize: '36px', marginBottom: '12px' }}>ðŸŒ¾</div>
                      <p style={{ margin: 0, color: '#7f8c8d' }}>No seasonal work recorded for {seasonalReportYear}</p>
                    </div>
                  ) : (
                    <>
                      <div style={{
                        display: 'grid',
                        gridTemplateColumns: 'repeat(2, 1fr)',
                        gap: '16px',
                        marginBottom: '20px'
                      }}>
                        <div style={{
                          padding: '16px',
                          background: '#fff3cd',
                          borderRadius: '12px'
                        }}>
                          <div style={{ fontSize: '14px', color: '#856404', marginBottom: '4px' }}>
                            Total Projects
                          </div>
                          <div style={{ fontSize: '28px', fontWeight: '700', color: '#856404' }}>
                            {yearWorks.length}
                          </div>
                        </div>
                        <div style={{
                          padding: '16px',
                          background: '#d4edda',
                          borderRadius: '12px'
                        }}>
                          <div style={{ fontSize: '14px', color: '#155724', marginBottom: '4px' }}>
                            Total Cost
                          </div>
                          <div style={{ fontSize: '28px', fontWeight: '700', color: '#155724' }}>
                            â‚¹{yearWorks.reduce((sum, w) => sum + (w.rate * w.totalConsumed), 0).toFixed(0)}
                          </div>
                        </div>
                      </div>
                      
                      {/* Project-wise Cost Details */}
                      <div style={{
                        padding: '16px',
                        background: '#f8f9fa',
                        borderRadius: '12px',
                        marginTop: '16px'
                      }}>
                        <h4 style={{ margin: '0 0 16px 0', fontSize: '16px', fontWeight: '700', color: '#2c3e50' }}>
                          Project-wise Cost Breakdown
                        </h4>
                        <div style={{ display: 'flex', flexDirection: 'column', gap: '12px' }}>
                          {yearWorks.map(work => (
                            <div key={work.id} style={{
                              background: 'white',
                              padding: '16px',
                              borderRadius: '10px',
                              borderLeft: '4px solid #f39c12',
                              boxShadow: '0 2px 8px rgba(0,0,0,0.06)'
                            }}>
                              <div style={{
                                display: 'flex',
                                justifyContent: 'space-between',
                                alignItems: 'flex-start',
                                marginBottom: '12px'
                              }}>
                                <div style={{ flex: 1 }}>
                                  <div style={{ fontSize: '16px', fontWeight: '700', color: '#2c3e50', marginBottom: '4px' }}>
                                    {work.title}
                                  </div>
                                  <div style={{ fontSize: '13px', color: '#7f8c8d' }}>
                                    {new Date(work.startDate).toLocaleDateString()} - {new Date(work.endDate).toLocaleDateString()}
                                  </div>
                                </div>
                                <div style={{ textAlign: 'right' }}>
                                  <div style={{ fontSize: '22px', fontWeight: '700', color: '#f39c12' }}>
                                    â‚¹{(work.rate * work.totalConsumed).toFixed(0)}
                                  </div>
                                  <div style={{ fontSize: '11px', color: '#7f8c8d' }}>
                                    Total Cost
                                  </div>
                                </div>
                              </div>
                              
                              <div style={{
                                display: 'grid',
                                gridTemplateColumns: 'repeat(3, 1fr)',
                                gap: '12px',
                                paddingTop: '12px',
                                borderTop: '1px solid #e0e0e0'
                              }}>
                                <div>
                                  <div style={{ fontSize: '11px', color: '#7f8c8d', marginBottom: '2px' }}>
                                    {work.rateType === 'hourly' ? 'Hours Consumed' : 'Days Consumed'}
                                  </div>
                                  <div style={{ fontSize: '16px', fontWeight: '700', color: '#2c3e50' }}>
                                    {work.totalConsumed}
                                  </div>
                                </div>
                                <div>
                                  <div style={{ fontSize: '11px', color: '#7f8c8d', marginBottom: '2px' }}>
                                    {work.rateType === 'hourly' ? 'Hourly Rate' : 'Daily Rate'}
                                  </div>
                                  <div style={{ fontSize: '16px', fontWeight: '700', color: '#2c3e50' }}>
                                    â‚¹{work.rate}/{work.rateType === 'hourly' ? 'hr' : 'day'}
                                  </div>
                                </div>
                                <div>
                                  <div style={{ fontSize: '11px', color: '#7f8c8d', marginBottom: '2px' }}>
                                    Workers Assigned
                                  </div>
                                  <div style={{ fontSize: '16px', fontWeight: '700', color: '#2c3e50' }}>
                                    {work.assignedWorkers?.length || 0}
                                  </div>
                                </div>
                              </div>
                            </div>
                          ))}
                        </div>
                      </div>
                    </>
                  );
                })()}
              </div>

              {/* Seasonal Workers Performance */}
              {workers.filter(w => w.type === 'seasonal' && w.active !== false).length === 0 ? (
                <div style={{
                  background: 'white',
                  borderRadius: '16px',
                  padding: '60px 20px',
                  textAlign: 'center',
                  boxShadow: '0 2px 12px rgba(0,0,0,0.08)'
                }}>
                  <div style={{ fontSize: '48px', marginBottom: '16px' }}>ðŸŒ¾</div>
                  <h3 style={{ margin: '0 0 8px 0', color: '#2c3e50' }}>No Seasonal Workers</h3>
                  <p style={{ margin: 0, color: '#7f8c8d' }}>Add seasonal workers to track their performance</p>
                </div>
              ) : (
                <div style={{ display: 'flex', flexDirection: 'column', gap: '16px' }}>
                  {workers.filter(w => w.type === 'seasonal' && w.active !== false).map(worker => {
                    const assignedWorks = seasonalWorks.filter(sw => 
                      sw.assignedWorkers && sw.assignedWorkers.includes(worker.id)
                    );
                    const totalWorkCost = assignedWorks.reduce((sum, w) => 
                      sum + (w.rate * w.totalConsumed), 0
                    );

                    return (
                      <div key={worker.id} style={{
                        background: 'white',
                        borderRadius: '16px',
                        padding: '20px',
                        boxShadow: '0 2px 12px rgba(0,0,0,0.08)'
                      }}>
                        <div style={{
                          display: 'flex',
                          justifyContent: 'space-between',
                          alignItems: 'center',
                          marginBottom: '16px',
                          paddingBottom: '16px',
                          borderBottom: '2px solid #f0f0f0'
                        }}>
                          <div>
                            <h3 style={{ margin: '0 0 4px 0', fontSize: '18px', fontWeight: '700', color: '#2c3e50' }}>
                              {worker.name}
                            </h3>
                            <span style={{
                              fontSize: '12px',
                              padding: '3px 8px',
                              borderRadius: '10px',
                              background: '#fff3cd',
                              color: '#856404',
                              fontWeight: '700'
                            }}>
                              ðŸŒ¾ SEASONAL
                            </span>
                          </div>
                          <div style={{ textAlign: 'right' }}>
                            <div style={{ fontSize: '14px', color: '#7f8c8d', marginBottom: '4px' }}>
                              Projects Assigned
                            </div>
                            <div style={{ fontSize: '24px', fontWeight: '700', color: '#f39c12' }}>
                              {assignedWorks.length}
                            </div>
                          </div>
                        </div>

                        {assignedWorks.length > 0 ? (
                          <div style={{ display: 'flex', flexDirection: 'column', gap: '12px' }}>
                            {assignedWorks.map(work => (
                              <div key={work.id} style={{
                                padding: '12px',
                                background: '#f8f9fa',
                                borderRadius: '10px',
                                borderLeft: '4px solid #f39c12'
                              }}>
                                <div style={{
                                  display: 'flex',
                                  justifyContent: 'space-between',
                                  alignItems: 'center'
                                }}>
                                  <div>
                                    <div style={{ fontSize: '15px', fontWeight: '600', color: '#2c3e50', marginBottom: '4px' }}>
                                      {work.title}
                                    </div>
                                    <div style={{ fontSize: '12px', color: '#7f8c8d' }}>
                                      {new Date(work.startDate).toLocaleDateString()} - {new Date(work.endDate).toLocaleDateString()}
                                    </div>
                                  </div>
                                  <div style={{ textAlign: 'right' }}>
                                    <div style={{ fontSize: '18px', fontWeight: '700', color: '#f39c12' }}>
                                      â‚¹{(work.rate * work.totalConsumed).toFixed(0)}
                                    </div>
                                    <div style={{ fontSize: '11px', color: '#7f8c8d' }}>
                                      {work.totalConsumed} {work.rateType === 'hourly' ? 'hrs' : 'days'}
                                    </div>
                                  </div>
                                </div>
                              </div>
                            ))}
                            <div style={{
                              padding: '12px',
                              background: '#fff3cd',
                              borderRadius: '10px',
                              display: 'flex',
                              justifyContent: 'space-between',
                              alignItems: 'center'
                            }}>
                              <span style={{ fontSize: '15px', fontWeight: '600', color: '#856404' }}>
                                Total Work Value
                              </span>
                              <span style={{ fontSize: '20px', fontWeight: '700', color: '#856404' }}>
                                â‚¹{totalWorkCost.toFixed(0)}
                              </span>
                            </div>
                          </div>
                        ) : (
                          <div style={{
                            padding: '20px',
                            textAlign: 'center',
                            color: '#7f8c8d',
                            fontSize: '14px'
                          }}>
                            No projects assigned yet
                          </div>
                        )}
                      </div>
                    );
                  })}
                </div>
              )}
            </>
          )}

          {/* Yearly Summary Report */}
          <div style={{ marginTop: '24px' }}>
            <h2 style={{
              margin: '0 0 20px 0',
              fontSize: '24px',
              fontWeight: '700',
              color: '#2c3e50'
            }}>
              ðŸ“Š Yearly Summary
            </h2>

            {/* Year Navigation */}
            <div style={{
              display: 'flex',
              alignItems: 'center',
              justifyContent: 'center',
              gap: '20px',
              marginBottom: '24px',
              background: 'white',
              padding: '16px',
              borderRadius: '12px',
              boxShadow: '0 2px 8px rgba(0,0,0,0.08)'
            }}>
              <button
                onClick={() => setYearlySummaryYear(yearlySummaryYear - 1)}
                style={{
                  padding: '8px 16px',
                  background: 'linear-gradient(135deg, #3498db 0%, #2980b9 100%)',
                  color: 'white',
                  border: 'none',
                  borderRadius: '8px',
                  cursor: 'pointer',
                  fontSize: '14px',
                  fontWeight: '600',
                  display: 'flex',
                  alignItems: 'center',
                  gap: '6px'
                }}
              >
                <span style={{fontSize:"20px"}}>â€¹</span>
                Previous Year
              </button>
              <div style={{
                fontSize: '24px',
                fontWeight: '700',
                color: '#2c3e50',
                minWidth: '100px',
                textAlign: 'center'
              }}>
                {yearlySummaryYear}
              </div>
              <button
                onClick={() => setYearlySummaryYear(yearlySummaryYear + 1)}
                disabled={yearlySummaryYear >= new Date().getFullYear()}
                style={{
                  padding: '8px 16px',
                  background: yearlySummaryYear >= new Date().getFullYear()
                    ? '#bdc3c7'
                    : 'linear-gradient(135deg, #3498db 0%, #2980b9 100%)',
                  color: 'white',
                  border: 'none',
                  borderRadius: '8px',
                  cursor: yearlySummaryYear >= new Date().getFullYear() ? 'not-allowed' : 'pointer',
                  fontSize: '14px',
                  fontWeight: '600',
                  display: 'flex',
                  alignItems: 'center',
                  gap: '6px'
                }}
              >
                Next Year
                <span style={{fontSize:"24px"}}>â€º</span>
              </button>
            </div>

            {/* View 1: Worker Costs */}
            <div style={{
              background: 'white',
              borderRadius: '16px',
              padding: '24px',
              marginBottom: '16px',
              boxShadow: '0 2px 12px rgba(0,0,0,0.08)'
            }}>
              <h3 style={{
                margin: '0 0 20px 0',
                fontSize: '20px',
                fontWeight: '700',
                color: '#2c3e50',
                display: 'flex',
                alignItems: 'center',
                gap: '8px'
              }}>
                ðŸ‘¥ Worker Costs
              </h3>

              {(() => {
                // Calculate worker costs for the year
                const yearStart = `${yearlySummaryYear}-01`;
                const yearEnd = `${yearlySummaryYear}-12`;
                
                let totalEarnings = 0;
                let totalPayments = 0;
                
                // Calculate for each month of the year
                for (let month = 1; month <= 12; month++) {
                  const monthStr = `${yearlySummaryYear}-${String(month).padStart(2, '0')}`;
                  
                  // Calculate earnings for this month
                  workers.forEach(worker => {
                    const monthAttendance = attendance.filter(a => 
                      a.workerId === worker.id && a.date.startsWith(monthStr)
                    );
                    const fullDays = monthAttendance.filter(a => a.status === 'present').length;
                    const halfDays = monthAttendance.filter(a => a.status === 'half_day').length;
                    const monthEarnings = (fullDays * worker.dailyWage) + (halfDays * worker.dailyWage * 0.5);
                    totalEarnings += monthEarnings;
                  });
                  
                  // Calculate payments for this month
                  const monthPayments = payments.filter(p => 
                    p.date.startsWith(monthStr) && p.type === 'payment'
                  );
                  totalPayments += monthPayments.reduce((sum, p) => sum + p.amount, 0);
                }
                
                return (
                  <>
                    <div style={{
                      display: 'grid',
                      gridTemplateColumns: 'repeat(2, 1fr)',
                      gap: '16px',
                      marginBottom: '20px'
                    }}>
                      <div style={{
                        padding: '20px',
                        background: 'linear-gradient(135deg, #0077b6 0%, #005f8e 100%)',
                        borderRadius: '12px',
                        color: 'white'
                      }}>
                        <div style={{ fontSize: '14px', marginBottom: '8px', opacity: 0.9 }}>
                          Total Earnings
                        </div>
                        <div style={{ fontSize: '32px', fontWeight: '700' }}>
                          â‚¹{Math.round(totalEarnings).toLocaleString()}
                        </div>
                        <div style={{ fontSize: '12px', marginTop: '4px', opacity: 0.8 }}>
                          Worker wages earned in {yearlySummaryYear}
                        </div>
                      </div>
                      
                      <div style={{
                        padding: '20px',
                        background: 'linear-gradient(135deg, #3498db 0%, #2980b9 100%)',
                        borderRadius: '12px',
                        color: 'white'
                      }}>
                        <div style={{ fontSize: '14px', marginBottom: '8px', opacity: 0.9 }}>
                          Total Payments
                        </div>
                        <div style={{ fontSize: '32px', fontWeight: '700' }}>
                          â‚¹{Math.round(totalPayments).toLocaleString()}
                        </div>
                        <div style={{ fontSize: '12px', marginTop: '4px', opacity: 0.8 }}>
                          Paid to workers in {yearlySummaryYear}
                        </div>
                      </div>
                    </div>
                    
                    <div style={{
                      padding: '16px',
                      background: totalEarnings - totalPayments > 0 ? '#fff3cd' : '#d4edda',
                      borderRadius: '12px',
                      border: `2px solid ${totalEarnings - totalPayments > 0 ? '#f39c12' : '#0077b6'}`
                    }}>
                      <div style={{
                        display: 'flex',
                        justifyContent: 'space-between',
                        alignItems: 'center'
                      }}>
                        <div style={{ fontSize: '16px', fontWeight: '600', color: '#2c3e50' }}>
                          {totalEarnings - totalPayments > 0 ? 'Outstanding Balance' : 'Overpaid Amount'}
                        </div>
                        <div style={{
                          fontSize: '24px',
                          fontWeight: '700',
                          color: totalEarnings - totalPayments > 0 ? '#f39c12' : '#0077b6'
                        }}>
                          â‚¹{Math.abs(totalEarnings - totalPayments).toLocaleString()}
                        </div>
                      </div>
                    </div>
                  </>
                );
              })()}
            </div>

            {/* View 2: Item Costs */}
            <div style={{
              background: 'white',
              borderRadius: '16px',
              padding: '24px',
              boxShadow: '0 2px 12px rgba(0,0,0,0.08)'
            }}>
              <h3 style={{
                margin: '0 0 20px 0',
                fontSize: '20px',
                fontWeight: '700',
                color: '#2c3e50',
                display: 'flex',
                alignItems: 'center',
                gap: '8px'
              }}>
                ðŸ’° Item Costs
              </h3>

              {(() => {
                // Calculate item costs for the year
                const yearExpenses = expenses.filter(e => {
                  const expenseYear = new Date(e.purchaseDate).getFullYear();
                  return expenseYear === yearlySummaryYear;
                });
                
                const totalExpenses = yearExpenses.reduce((sum, e) => sum + e.cost, 0);
                
                // Group by item title
                const expensesByItem = {};
                yearExpenses.forEach(expense => {
                  if (!expensesByItem[expense.title]) {
                    expensesByItem[expense.title] = {
                      totalCost: 0,
                      count: 0,
                      totalQuantity: 0,
                      unit: expense.unit
                    };
                  }
                  expensesByItem[expense.title].totalCost += expense.cost;
                  expensesByItem[expense.title].count += 1;
                  expensesByItem[expense.title].totalQuantity += expense.quantity;
                });
                
                return (
                  <>
                    <div style={{
                      padding: '20px',
                      background: 'linear-gradient(135deg, #e74c3c 0%, #c0392b 100%)',
                      borderRadius: '12px',
                      color: 'white',
                      marginBottom: '20px'
                    }}>
                      <div style={{ fontSize: '14px', marginBottom: '8px', opacity: 0.9 }}>
                        Total Expenses
                      </div>
                      <div style={{ fontSize: '32px', fontWeight: '700' }}>
                        â‚¹{Math.round(totalExpenses).toLocaleString()}
                      </div>
                      <div style={{ fontSize: '12px', marginTop: '4px', opacity: 0.8 }}>
                        {yearExpenses.length} purchases in {yearlySummaryYear}
                      </div>
                    </div>

                    {Object.keys(expensesByItem).length === 0 ? (
                      <div style={{
                        textAlign: 'center',
                        padding: '40px 20px',
                        color: '#7f8c8d'
                      }}>
                        <div style={{ fontSize: '48px', marginBottom: '12px' }}>ðŸ“¦</div>
                        <div style={{ fontSize: '16px', fontWeight: '600' }}>No Expenses</div>
                        <div style={{ fontSize: '14px' }}>No items purchased in {yearlySummaryYear}</div>
                      </div>
                    ) : (
                      <div style={{ display: 'flex', flexDirection: 'column', gap: '12px' }}>
                        {Object.entries(expensesByItem)
                          .sort((a, b) => b[1].totalCost - a[1].totalCost)
                          .map(([itemName, data]) => (
                          <div key={itemName} style={{
                            padding: '16px',
                            background: '#f8f9fa',
                            borderRadius: '12px',
                            display: 'flex',
                            justifyContent: 'space-between',
                            alignItems: 'center'
                          }}>
                            <div>
                              <div style={{ fontSize: '16px', fontWeight: '700', color: '#2c3e50', marginBottom: '4px' }}>
                                {itemName}
                              </div>
                              <div style={{ fontSize: '13px', color: '#7f8c8d' }}>
                                {data.totalQuantity} {data.unit} â€¢ {data.count} purchase{data.count > 1 ? 's' : ''}
                              </div>
                            </div>
                            <div style={{
                              fontSize: '20px',
                              fontWeight: '700',
                              color: '#e74c3c'
                            }}>
                              â‚¹{Math.round(data.totalCost).toLocaleString()}
                            </div>
                          </div>
                        ))}
                      </div>
                    )}
                  </>
                );
              })()}
            </div>
          </div>
        </div>
      )}

      {/* General Notes View */}
      {activeView === 'generalnotes' && (
        <div style={{ padding: '20px' }}>
          {/* Header */}
          <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '20px' }}>
            <h2 style={{ margin: 0, fontSize: '22px', fontWeight: '700', color: '#2c3e50' }}>
              ðŸ—’ï¸ General Notes
            </h2>
            <button
              onClick={() => {
                setEditingGeneralNote(null);
                setGeneralNoteData({ title: '', body: '' });
                setShowGeneralNoteModal(true);
              }}
              style={{
                padding: '12px 20px',
                background: 'linear-gradient(135deg, #f39c12 0%, #e67e22 100%)',
                color: 'white', border: 'none', borderRadius: '12px',
                display: 'flex', alignItems: 'center', gap: '8px',
                fontSize: '15px', fontWeight: '600', cursor: 'pointer',
                boxShadow: '0 4px 12px rgba(243,156,18,0.35)'
              }}
            >
              <span style={{ fontSize: '18px' }}>+</span> Add New Note
            </button>
          </div>

          {/* Empty state */}
          {generalNotes.length === 0 ? (
            <div style={{
              background: 'white', borderRadius: '16px', padding: '60px 24px',
              textAlign: 'center', boxShadow: '0 2px 12px rgba(0,0,0,0.08)'
            }}>
              <div style={{ fontSize: '64px', marginBottom: '16px' }}>ðŸ—’ï¸</div>
              <h3 style={{ margin: '0 0 8px 0', fontSize: '20px', color: '#2c3e50' }}>No Notes Yet</h3>
              <p style={{ margin: '0 0 24px 0', color: '#7f8c8d', fontSize: '15px' }}>
                Use General Notes for reminders, ideas, or any farm-related information
              </p>
              <button
                onClick={() => {
                  setEditingGeneralNote(null);
                  setGeneralNoteData({ title: '', body: '' });
                  setShowGeneralNoteModal(true);
                }}
                style={{
                  padding: '14px 32px',
                  background: 'linear-gradient(135deg, #f39c12 0%, #e67e22 100%)',
                  color: 'white', border: 'none', borderRadius: '12px',
                  fontSize: '16px', fontWeight: '600', cursor: 'pointer'
                }}
              >
                + Add First Note
              </button>
            </div>
          ) : (
            <div style={{ display: 'flex', flexDirection: 'column', gap: '14px' }}>
              {generalNotes.map(note => (
                <div key={note.id} style={{
                  background: 'white', borderRadius: '16px', padding: '20px',
                  boxShadow: '0 2px 12px rgba(0,0,0,0.08)',
                  borderLeft: '4px solid #f39c12'
                }}>
                  {/* Card header */}
                  <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'flex-start', marginBottom: note.body ? '12px' : '0' }}>
                    <div style={{ flex: 1 }}>
                      {note.title && (
                        <h3 style={{ margin: '0 0 4px 0', fontSize: '17px', fontWeight: '700', color: '#2c3e50' }}>
                          {note.title}
                        </h3>
                      )}
                      <div style={{ fontSize: '12px', color: '#7f8c8d', display: 'flex', gap: '12px' }}>
                        <span>ðŸ“… {new Date(note.createdAt).toLocaleDateString('en-IN', { day: 'numeric', month: 'short', year: 'numeric' })}</span>
                        {note.updatedAt !== note.createdAt && (
                          <span>âœï¸ Edited {new Date(note.updatedAt).toLocaleDateString('en-IN', { day: 'numeric', month: 'short', year: 'numeric' })}</span>
                        )}
                      </div>
                    </div>
                    {/* Edit / Delete buttons */}
                    <div style={{ display: 'flex', gap: '8px', flexShrink: 0, marginLeft: '12px' }}>
                      <button
                        onClick={() => editGeneralNote(note)}
                        style={{ background: '#3498db', color: 'white', border: 'none', padding: '8px', borderRadius: '8px', cursor: 'pointer' }}
                      >
                        <span style={{ fontSize: '16px' }}>âœï¸</span>
                      </button>
                      <button
                        onClick={() => deleteGeneralNote(note.id)}
                        style={{ background: '#e74c3c', color: 'white', border: 'none', padding: '8px', borderRadius: '8px', cursor: 'pointer' }}
                      >
                        <span style={{ fontSize: '16px' }}>ðŸ—‘ï¸</span>
                      </button>
                    </div>
                  </div>
                  {/* Note body */}
                  {note.body && (
                    <div style={{
                      fontSize: '15px', color: '#2c3e50', lineHeight: '1.6',
                      whiteSpace: 'pre-wrap', padding: '14px', background: '#fffdf5',
                      borderRadius: '10px', border: '1px solid #fde68a'
                    }}>
                      {note.body}
                    </div>
                  )}
                </div>
              ))}
            </div>
          )}
        </div>
      )}

      {/* General Notes Modal */}
      {showGeneralNoteModal && (
        <div style={{
          position: 'fixed', top: 0, left: 0, right: 0, bottom: 0,
          background: 'rgba(0,0,0,0.5)', display: 'flex',
          alignItems: 'center', justifyContent: 'center', zIndex: 1000, padding: '20px'
        }}>
          <div style={{
            background: 'white', borderRadius: '20px', maxWidth: '480px',
            width: '100%', maxHeight: '90vh', display: 'flex', flexDirection: 'column',
            boxShadow: '0 20px 60px rgba(0,0,0,0.3)'
          }}>
            {/* Modal Header */}
            <div style={{
              padding: '20px 24px 16px', borderBottom: '2px solid #f0f0f0',
              position: 'sticky', top: 0, background: 'white', borderRadius: '20px 20px 0 0',
              display: 'flex', alignItems: 'center', gap: '12px'
            }}>
              <div style={{
                width: '40px', height: '40px', borderRadius: '10px',
                background: 'linear-gradient(135deg, #f39c12 0%, #e67e22 100%)',
                display: 'flex', alignItems: 'center', justifyContent: 'center', fontSize: '20px'
              }}>ðŸ—’ï¸</div>
              <h3 style={{ margin: 0, fontSize: '20px', fontWeight: '700', color: '#2c3e50' }}>
                {editingGeneralNote ? 'Edit Note' : 'Add New Note'}
              </h3>
            </div>

            {/* Modal Body */}
            <div style={{ padding: '20px 24px', overflowY: 'auto', flex: 1 }}>
              <div style={{ display: 'flex', flexDirection: 'column', gap: '16px' }}>
                {/* Title */}
                <div>
                  <label style={{ display: 'block', fontSize: '14px', fontWeight: '600', color: '#2c3e50', marginBottom: '8px' }}>
                    Title
                  </label>
                  <input
                    type="text"
                    value={generalNoteData.title}
                    onChange={(e) => setGeneralNoteData({ ...generalNoteData, title: e.target.value })}
                    placeholder="e.g., Irrigation Schedule, Supplier Contact..."
                    style={{
                      width: '100%', padding: '12px 14px', border: '2px solid #e0e0e0',
                      borderRadius: '12px', fontSize: '15px', fontFamily: 'inherit', outline: 'none'
                    }}
                  />
                </div>
                {/* Notes Body */}
                <div>
                  <label style={{ display: 'block', fontSize: '14px', fontWeight: '600', color: '#2c3e50', marginBottom: '8px' }}>
                    Notes
                  </label>
                  <textarea
                    value={generalNoteData.body}
                    onChange={(e) => setGeneralNoteData({ ...generalNoteData, body: e.target.value })}
                    placeholder="Write your note here..."
                    rows="8"
                    style={{
                      width: '100%', padding: '12px 14px', border: '2px solid #e0e0e0',
                      borderRadius: '12px', fontSize: '15px', fontFamily: 'inherit', outline: 'none',
                      resize: 'vertical', lineHeight: '1.6'
                    }}
                  />
                </div>
              </div>
            </div>

            {/* Modal Footer */}
            <div style={{
              padding: '16px 24px', borderTop: '2px solid #f0f0f0',
              display: 'flex', gap: '12px',
              position: 'sticky', bottom: 0, background: 'white', borderRadius: '0 0 20px 20px'
            }}>
              <button
                onClick={() => {
                  setShowGeneralNoteModal(false);
                  setEditingGeneralNote(null);
                  setGeneralNoteData({ title: '', body: '' });
                }}
                style={{
                  flex: 1, padding: '14px', border: '2px solid #e0e0e0', background: 'white',
                  borderRadius: '12px', fontSize: '15px', fontWeight: '600', color: '#2c3e50', cursor: 'pointer'
                }}
              >
                Cancel
              </button>
              <button
                onClick={saveGeneralNote}
                style={{
                  flex: 1, padding: '14px', border: 'none',
                  background: 'linear-gradient(135deg, #f39c12 0%, #e67e22 100%)',
                  borderRadius: '12px', fontSize: '15px', fontWeight: '600', color: 'white',
                  cursor: 'pointer', boxShadow: '0 4px 12px rgba(243,156,18,0.35)'
                }}
              >
                {editingGeneralNote ? 'âœ“ Update Note' : '+ Save Note'}
              </button>
            </div>
          </div>
        </div>
      )}

      {/* Settings View */}
      {activeView === 'settings' && (
        <div style={{ padding: '20px' }}>
          <h2 style={{ margin: '0 0 20px 0', fontSize: '22px', fontWeight: '700', color: '#2c3e50' }}>
            Settings
          </h2>

          {/* Theme Switcher */}
          <div style={{
            background: 'white',
            borderRadius: '16px',
            padding: '20px',
            marginBottom: '16px',
            boxShadow: '0 2px 12px rgba(0,0,0,0.08)'
          }}>
            <h3 style={{
              margin: '0 0 16px 0',
              fontSize: '18px',
              fontWeight: '700',
              color: '#2c3e50',
              display: 'flex',
              alignItems: 'center',
              gap: '8px'
            }}>
              <span style={{ fontSize: '24px' }}>ðŸŽ¨</span>
              Color Theme
            </h3>
            
            <p style={{ margin: '0 0 16px 0', fontSize: '14px', color: '#7f8c8d' }}>
              Choose a color theme that suits your style
            </p>

            <div style={{ display: 'grid', gridTemplateColumns: 'repeat(2, 1fr)', gap: '12px' }}>
              {Object.entries(themes).map(([key, themeOption]) => (
                <button
                  key={key}
                  onClick={() => setCurrentTheme(key)}
                  style={{
                    padding: '16px',
                    border: currentTheme === key ? `3px solid ${themeOption.primary}` : '2px solid #e0e0e0',
                    background: themeOption.background,
                    borderRadius: '12px',
                    cursor: 'pointer',
                    transition: 'all 0.2s',
                    position: 'relative',
                    overflow: 'hidden'
                  }}
                >
                  {currentTheme === key && (
                    <div style={{
                      position: 'absolute',
                      top: '8px',
                      right: '8px',
                      width: '24px',
                      height: '24px',
                      borderRadius: '50%',
                      background: themeOption.primary,
                      color: 'white',
                      display: 'flex',
                      alignItems: 'center',
                      justifyContent: 'center',
                      fontSize: '14px',
                      fontWeight: '700'
                    }}>
                      âœ“
                    </div>
                  )}
                  
                  <div style={{
                    fontSize: '16px',
                    fontWeight: '700',
                    color: themeOption.textPrimary,
                    marginBottom: '8px'
                  }}>
                    {themeOption.name}
                  </div>
                  
                  <div style={{ display: 'flex', gap: '4px', marginTop: '8px' }}>
                    <div style={{
                      width: '30px',
                      height: '30px',
                      borderRadius: '6px',
                      background: themeOption.primary,
                      boxShadow: '0 2px 4px rgba(0,0,0,0.1)'
                    }} />
                    <div style={{
                      width: '30px',
                      height: '30px',
                      borderRadius: '6px',
                      background: themeOption.accent,
                      boxShadow: '0 2px 4px rgba(0,0,0,0.1)'
                    }} />
                    <div style={{
                      width: '30px',
                      height: '30px',
                      borderRadius: '6px',
                      background: themeOption.success,
                      boxShadow: '0 2px 4px rgba(0,0,0,0.1)'
                    }} />
                  </div>
                </button>
              ))}
            </div>
          </div>

          {/* Backup & Restore */}
          <div style={{
            background: 'white',
            borderRadius: '16px',
            padding: '20px',
            marginBottom: '16px',
            boxShadow: '0 2px 12px rgba(0,0,0,0.08)'
          }}>
            <h3 style={{
              margin: '0 0 16px 0',
              fontSize: '18px',
              fontWeight: '700',
              color: '#2c3e50'
            }}>
              Backup & Restore
            </h3>
            
            <div style={{ display: 'flex', flexDirection: 'column', gap: '12px' }}>
              <button
                onClick={backupData}
                style={{
                  width: '100%',
                  padding: '16px',
                  border: 'none',
                  background: 'linear-gradient(135deg, #0077b6 0%, #005f8e 100%)',
                  borderRadius: '12px',
                  display: 'flex',
                  alignItems: 'center',
                  justifyContent: 'center',
                  gap: '12px',
                  cursor: 'pointer',
                  color: 'white',
                  fontSize: '16px',
                  fontWeight: '600',
                  boxShadow: '0 4px 12px rgba(0,119,182,0.3)'
                }}
              >
                <span style={{ fontSize: '20px' }}>ðŸ’¾</span>
                Download Backup
              </button>

              <label style={{
                width: '100%',
                padding: '16px',
                border: '2px solid #3498db',
                background: 'white',
                borderRadius: '12px',
                display: 'flex',
                alignItems: 'center',
                justifyContent: 'center',
                gap: '12px',
                cursor: 'pointer',
                color: '#3498db',
                fontSize: '16px',
                fontWeight: '600'
              }}>
                <span style={{ fontSize: '20px' }}>ðŸ“¤</span>
                Restore from Backup
                <input
                  type="file"
                  accept=".json"
                  onChange={restoreData}
                  style={{ display: 'none' }}
                />
              </label>

              <div style={{
                padding: '12px',
                background: '#fff3cd',
                borderRadius: '8px',
                fontSize: '13px',
                color: '#856404',
                lineHeight: '1.5'
              }}>
                <strong>Note:</strong> Backup files contain all your workers, attendance, payments, and notes data.
              </div>
            </div>
          </div>

          {/* Online Backup (Google Drive) */}
          <div style={{
            background: 'white',
            borderRadius: '16px',
            padding: '20px',
            marginBottom: '16px',
            boxShadow: '0 2px 12px rgba(0,0,0,0.08)'
          }}>
            <h3 style={{
              margin: '0 0 16px 0',
              fontSize: '18px',
              fontWeight: '700',
              color: '#2c3e50',
              display: 'flex',
              alignItems: 'center',
              gap: '8px'
            }}>
              <span style={{ fontSize: '24px' }}>â˜ï¸</span>
              Online Backup (Google Drive)
            </h3>
            
            <p style={{ margin: '0 0 16px 0', fontSize: '14px', color: '#7f8c8d', lineHeight: '1.5' }}>
              Save and restore backups directly to/from your Google Drive
            </p>

            {!googleClientId || !googleApiKey ? (
              <div style={{
                padding: '16px',
                background: '#fff3cd',
                borderRadius: '12px',
                marginBottom: '16px',
                border: '2px solid #f39c12'
              }}>
                <div style={{
                  fontSize: '14px',
                  color: '#856404',
                  marginBottom: '12px',
                  fontWeight: '600'
                }}>
                  âš™ï¸ Configuration Required
                </div>
                <div style={{
                  fontSize: '13px',
                  color: '#856404',
                  lineHeight: '1.5',
                  marginBottom: '12px'
                }}>
                  To use Google Drive backup, you need to:
                  <br/>1. Create a Google Cloud Project
                  <br/>2. Enable Google Drive API
                  <br/>3. Get Client ID and API Key
                </div>
                <button
                  onClick={() => setShowGoogleConfig(!showGoogleConfig)}
                  style={{
                    padding: '10px 16px',
                    background: '#f39c12',
                    color: 'white',
                    border: 'none',
                    borderRadius: '8px',
                    fontSize: '14px',
                    fontWeight: '600',
                    cursor: 'pointer'
                  }}
                >
                  {showGoogleConfig ? 'Hide Configuration' : 'ðŸ“ Configure Google Drive'}
                </button>
              </div>
            ) : (
              <div style={{
                padding: '12px 16px',
                background: '#d4edda',
                borderRadius: '8px',
                fontSize: '13px',
                color: '#155724',
                marginBottom: '16px',
                display: 'flex',
                alignItems: 'center',
                gap: '8px'
              }}>
                <span>âœ…</span>
                <span>Google Drive configured and ready</span>
                <button
                  onClick={() => setShowGoogleConfig(!showGoogleConfig)}
                  style={{
                    marginLeft: 'auto',
                    padding: '4px 8px',
                    background: 'transparent',
                    border: '1px solid #155724',
                    borderRadius: '6px',
                    fontSize: '12px',
                    color: '#155724',
                    cursor: 'pointer'
                  }}
                >
                  {showGoogleConfig ? 'Hide' : 'Edit'}
                </button>
              </div>
            )}

            {showGoogleConfig && (
              <div style={{
                padding: '16px',
                background: '#f8f9fa',
                borderRadius: '12px',
                marginBottom: '16px'
              }}>
                <div style={{ marginBottom: '12px' }}>
                  <label style={{
                    display: 'block',
                    fontSize: '13px',
                    fontWeight: '600',
                    color: '#2c3e50',
                    marginBottom: '6px'
                  }}>
                    Google Client ID *
                  </label>
                  <input
                    type="text"
                    value={googleClientId}
                    onChange={(e) => setGoogleClientId(e.target.value)}
                    placeholder="xxxxx.apps.googleusercontent.com"
                    style={{
                      width: '100%',
                      padding: '10px',
                      border: '2px solid #e0e0e0',
                      borderRadius: '8px',
                      fontSize: '14px',
                      fontFamily: 'inherit'
                    }}
                  />
                </div>
                <div style={{ marginBottom: '12px' }}>
                  <label style={{
                    display: 'block',
                    fontSize: '13px',
                    fontWeight: '600',
                    color: '#2c3e50',
                    marginBottom: '6px'
                  }}>
                    Google API Key *
                  </label>
                  <input
                    type="text"
                    value={googleApiKey}
                    onChange={(e) => setGoogleApiKey(e.target.value)}
                    placeholder="AIzaSy..."
                    style={{
                      width: '100%',
                      padding: '10px',
                      border: '2px solid #e0e0e0',
                      borderRadius: '8px',
                      fontSize: '14px',
                      fontFamily: 'inherit'
                    }}
                  />
                </div>
                <div style={{
                  padding: '12px',
                  background: '#e3f2fd',
                  borderRadius: '8px',
                  fontSize: '12px',
                  color: '#1565c0',
                  lineHeight: '1.5'
                }}>
                  <strong>ðŸ“š Setup Guide:</strong>
                  <br/>1. Go to <a href="https://console.cloud.google.com" target="_blank" rel="noopener" style={{color: '#1565c0', textDecoration: 'underline'}}>Google Cloud Console</a>
                  <br/>2. Create a new project
                  <br/>3. Enable "Google Drive API" and "Google Picker API"
                  <br/>4. Create OAuth 2.0 Client ID (Web application)
                  <br/>5. Add authorized origin: <code style={{background: '#fff', padding: '2px 6px', borderRadius: '4px'}}>https://claude.ai</code>
                  <br/>6. Create API Key (no restrictions needed for testing)
                  <br/>7. Copy Client ID and API Key here
                </div>
              </div>
            )}
            
            <div style={{ display: 'flex', flexDirection: 'column', gap: '12px' }}>
              <button
                onClick={saveToGoogleDrive}
                disabled={!googleClientId || !googleApiKey}
                style={{
                  width: '100%',
                  padding: '16px',
                  border: 'none',
                  background: (!googleClientId || !googleApiKey) 
                    ? '#bdc3c7' 
                    : 'linear-gradient(135deg, #3498db 0%, #2980b9 100%)',
                  borderRadius: '12px',
                  display: 'flex',
                  alignItems: 'center',
                  justifyContent: 'center',
                  gap: '12px',
                  cursor: (!googleClientId || !googleApiKey) ? 'not-allowed' : 'pointer',
                  color: 'white',
                  fontSize: '16px',
                  fontWeight: '600',
                  boxShadow: (!googleClientId || !googleApiKey) ? 'none' : '0 4px 12px rgba(52,152,219,0.3)'
                }}
              >
                <span style={{ fontSize: '20px' }}>â˜ï¸</span>
                Backup to Google Drive
              </button>

              <button
                onClick={restoreFromGoogleDrive}
                disabled={!googleClientId || !googleApiKey}
                style={{
                  width: '100%',
                  padding: '16px',
                  border: (!googleClientId || !googleApiKey) ? '2px solid #bdc3c7' : '2px solid #0077b6',
                  background: 'white',
                  borderRadius: '12px',
                  display: 'flex',
                  alignItems: 'center',
                  justifyContent: 'center',
                  gap: '12px',
                  cursor: (!googleClientId || !googleApiKey) ? 'not-allowed' : 'pointer',
                  color: (!googleClientId || !googleApiKey) ? '#bdc3c7' : '#0077b6',
                  fontSize: '16px',
                  fontWeight: '600'
                }}
              >
                <span style={{ fontSize: '20px' }}>ðŸ“¥</span>
                Restore from Google Drive
              </button>

              <div style={{
                padding: '12px',
                background: '#f0f9ff',
                borderRadius: '8px',
                fontSize: '13px',
                color: '#0369a1',
                lineHeight: '1.5'
              }}>
                <strong>â„¹ï¸ How it works:</strong>
                <br/>â€¢ Backup: Saves JSON file directly to your Google Drive
                <br/>â€¢ Restore: Opens picker to select backup file from your Drive
                <br/>â€¢ Your data never leaves your control
              </div>
            </div>
          </div>

          {/* Data Management */}
          <div style={{
            background: 'white',
            borderRadius: '16px',
            padding: '20px',
            boxShadow: '0 2px 12px rgba(0,0,0,0.08)'
          }}>
            <h3 style={{
              margin: '0 0 16px 0',
              fontSize: '18px',
              fontWeight: '700',
              color: '#2c3e50'
            }}>
              Data Management
            </h3>

            <div style={{
              padding: '16px',
              background: '#f8f9fa',
              borderRadius: '12px',
              marginBottom: '16px'
            }}>
              <div style={{
                display: 'flex',
                justifyContent: 'space-between',
                alignItems: 'center',
                marginBottom: '8px'
              }}>
                <span style={{ fontSize: '14px', color: '#7f8c8d' }}>Total Workers</span>
                <span style={{ fontSize: '18px', fontWeight: '700', color: '#2c3e50' }}>
                  {workers.length}
                </span>
              </div>
              <div style={{
                display: 'flex',
                justifyContent: 'space-between',
                alignItems: 'center',
                marginBottom: '8px'
              }}>
                <span style={{ fontSize: '14px', color: '#7f8c8d' }}>Attendance Records</span>
                <span style={{ fontSize: '18px', fontWeight: '700', color: '#2c3e50' }}>
                  {attendance.length}
                </span>
              </div>
              <div style={{
                display: 'flex',
                justifyContent: 'space-between',
                alignItems: 'center',
                marginBottom: '8px'
              }}>
                <span style={{ fontSize: '14px', color: '#7f8c8d' }}>Payment Records</span>
                <span style={{ fontSize: '18px', fontWeight: '700', color: '#2c3e50' }}>
                  {payments.length}
                </span>
              </div>
              <div style={{
                display: 'flex',
                justifyContent: 'space-between',
                alignItems: 'center'
              }}>
                <span style={{ fontSize: '14px', color: '#7f8c8d' }}>Special Notes</span>
                <span style={{ fontSize: '18px', fontWeight: '700', color: '#2c3e50' }}>
                  {specialNotes.length}
                </span>
              </div>
              <div style={{
                display: 'flex',
                justifyContent: 'space-between',
                alignItems: 'center',
                marginTop: '8px'
              }}>
                <span style={{ fontSize: '14px', color: '#7f8c8d' }}>Seasonal Works</span>
                <span style={{ fontSize: '18px', fontWeight: '700', color: '#2c3e50' }}>
                  {seasonalWorks.length}
                </span>
              </div>
              <div style={{
                display: 'flex',
                justifyContent: 'space-between',
                alignItems: 'center',
                marginTop: '8px'
              }}>
                <span style={{ fontSize: '14px', color: '#7f8c8d' }}>Expenses</span>
                <span style={{ fontSize: '18px', fontWeight: '700', color: '#2c3e50' }}>
                  {expenses.length}
                </span>
              </div>
              <div style={{
                display: 'flex',
                justifyContent: 'space-between',
                alignItems: 'center',
                marginTop: '8px'
              }}>
                <span style={{ fontSize: '14px', color: '#7f8c8d' }}>Contracts</span>
                <span style={{ fontSize: '18px', fontWeight: '700', color: '#2c3e50' }}>
                  {contractWorks.length}
                </span>
              </div>
              <div style={{
                display: 'flex',
                justifyContent: 'space-between',
                alignItems: 'center',
                marginTop: '8px'
              }}>
                <span style={{ fontSize: '14px', color: '#7f8c8d' }}>Phonebook Entries</span>
                <span style={{ fontSize: '18px', fontWeight: '700', color: '#2c3e50' }}>
                  {contacts.length}
                </span>
              </div>
              <div style={{
                display: 'flex',
                justifyContent: 'space-between',
                alignItems: 'center',
                marginTop: '8px'
              }}>
                <span style={{ fontSize: '14px', color: '#7f8c8d' }}>General Notes</span>
                <span style={{ fontSize: '18px', fontWeight: '700', color: '#2c3e50' }}>
                  {generalNotes.length}
                </span>
              </div>
            </div>

            <button
              onClick={clearAllData}
              style={{
                width: '100%',
                padding: '16px',
                border: '2px solid #e74c3c',
                background: 'white',
                borderRadius: '12px',
                display: 'flex',
                alignItems: 'center',
                justifyContent: 'center',
                gap: '12px',
                cursor: 'pointer',
                color: '#e74c3c',
                fontSize: '16px',
                fontWeight: '600'
              }}
            >
              <span style={{ fontSize: '20px' }}>ðŸ—‘ï¸</span>
              Clear All Data
            </button>

            <div style={{
              padding: '12px',
              background: '#f8d7da',
              borderRadius: '8px',
              fontSize: '13px',
              color: '#721c24',
              marginTop: '12px',
              lineHeight: '1.5'
            }}>
              <strong>Warning:</strong> Clearing data will permanently delete everything. Make sure to backup first!
            </div>
          </div>

          {/* App Info */}
          <div style={{
            background: 'white',
            borderRadius: '16px',
            padding: '20px',
            marginTop: '16px',
            boxShadow: '0 2px 12px rgba(0,0,0,0.08)',
            textAlign: 'center'
          }}>
            <div style={{ fontSize: '32px', marginBottom: '8px' }}>ðŸŒ¾</div>
            <h3 style={{ margin: '0 0 4px 0', fontSize: '16px', fontWeight: '700', color: '#2c3e50' }}>
              Farm Manager
            </h3>
            <p style={{ margin: 0, fontSize: '13px', color: '#7f8c8d' }}>
              Version 2.0
            </p>
          </div>
        </div>
      )}

      {/* Left Sidebar Navigation */}
      <div style={{
        position: 'fixed',
        left: 0,
        top: 0,
        bottom: 0,
        width: '80px',
        background: 'white',
        borderRight: '1px solid #e0e0e0',
        display: 'flex',
        flexDirection: 'column',
        paddingTop: '16px',
        paddingBottom: '16px',
        boxShadow: '2px 0 10px rgba(0,0,0,0.05)',
        zIndex: 100,
        overflowY: 'auto'
      }}>
        <NavButton
          icon={<span style={{fontSize:"20px"}}>ðŸ“ˆ</span>}
          label="Home"
          active={activeView === 'attendance'}
          onClick={() => setActiveView('attendance')}
        />
        <NavButton
          icon={<span style={{fontSize:"20px"}}>ðŸ‘¥</span>}
          label="Workers"
          active={activeView === 'workers'}
          onClick={() => setActiveView('workers')}
        />
        <NavButton
          icon={<span style={{fontSize:"20px"}}>ðŸ“…</span>}
          label="Attend"
          active={activeView === 'attendance'}
          onClick={() => setActiveView('attendance')}
        />
        <NavButton
          icon={<span style={{fontSize:"20px"}}>ðŸ’°</span>}
          label="Payments"
          active={activeView === 'payments'}
          onClick={() => setActiveView('payments')}
        />
        <NavButton
          icon="ðŸ“"
          label="Worker Notes"
          active={activeView === 'notes'}
          onClick={() => setActiveView('notes')}
          isEmoji={true}
        />
        <NavButton
          icon="ðŸŒ¾"
          label="Seasonal"
          active={activeView === 'seasonal'}
          onClick={() => setActiveView('seasonal')}
          isEmoji={true}
        />
        <NavButton
          icon="ðŸ’°"
          label="Expenses"
          active={activeView === 'expenses'}
          onClick={() => setActiveView('expenses')}
          isEmoji={true}
        />
        <NavButton
          icon="ðŸ“‹"
          label="Project"
          active={activeView === 'contract'}
          onClick={() => setActiveView('contract')}
          isEmoji={true}
        />
        <NavButton
          icon="ðŸ“ž"
          label="Phonebook"
          active={activeView === 'phonebook'}
          onClick={() => setActiveView('phonebook')}
          isEmoji={true}
        />
        <NavButton
          icon="ðŸ“Š"
          label="Reports"
          active={activeView === 'reports'}
          onClick={() => setActiveView('reports')}
          isEmoji={true}
        />
        <NavButton
          icon="ðŸ—’ï¸"
          label="Gen Notes"
          active={activeView === 'generalnotes'}
          onClick={() => setActiveView('generalnotes')}
          isEmoji={true}
        />
        <NavButton
          icon="âš™ï¸"
          label="Settings"
          active={activeView === 'settings'}
          onClick={() => setActiveView('settings')}
          isEmoji={true}
        />
      </div>

      {/* Confirmation Dialog Modal */}
      {confirmDialog.show && (
        <div style={{
          position: 'fixed',
          top: 0,
          left: 0,
          right: 0,
          bottom: 0,
          background: 'rgba(0,0,0,0.5)',
          display: 'flex',
          alignItems: 'center',
          justifyContent: 'center',
          zIndex: 10000,
          padding: '20px'
        }}>
          <div style={{
            background: 'white',
            borderRadius: '20px',
            padding: '24px',
            maxWidth: '400px',
            width: '100%',
            boxShadow: '0 10px 40px rgba(0,0,0,0.3)'
          }}>
            <h3 style={{ 
              margin: '0 0 16px 0', 
              fontSize: '20px', 
              fontWeight: '700', 
              color: '#2c3e50',
              textAlign: 'center'
            }}>
              âš ï¸ Confirmation Required
            </h3>
            
            <p style={{
              margin: '0 0 24px 0',
              fontSize: '16px',
              color: '#2c3e50',
              lineHeight: '1.5',
              textAlign: 'center'
            }}>
              {confirmDialog.message}
            </p>

            <div style={{ display: 'flex', gap: '12px' }}>
              <button
                onClick={() => setConfirmDialog({ show: false, message: '', onConfirm: null })}
                style={{
                  flex: 1,
                  padding: '14px',
                  border: '2px solid #e0e0e0',
                  background: 'white',
                  borderRadius: '12px',
                  fontSize: '15px',
                  fontWeight: '600',
                  color: '#2c3e50',
                  cursor: 'pointer'
                }}
              >
                No
              </button>
              <button
                onClick={confirmDialog.onConfirm}
                style={{
                  flex: 1,
                  padding: '14px',
                  border: 'none',
                  background: 'linear-gradient(135deg, #e74c3c 0%, #c0392b 100%)',
                  borderRadius: '12px',
                  fontSize: '15px',
                  fontWeight: '600',
                  color: 'white',
                  cursor: 'pointer',
                  boxShadow: '0 4px 12px rgba(231,76,60,0.3)'
                }}
              >
                Yes
              </button>
            </div>
          </div>
        </div>
      )}
    </div>
  );
}

// Helper Components
function MonthCell({ date, day, status, isFuture, isToday, isCurrentMonth = true, onClick, workerId, workers, getCarriedForwardBalance, specialNotes }) {
  const [showMenu, setShowMenu] = useState(false);
  const [showCarryForward, setShowCarryForward] = useState(false);
  const [showNotes, setShowNotes] = useState(false);
  
  // Check if this is the first day of the month
  const isFirstOfMonth = day === 1 && !isFuture && isCurrentMonth;
  const carriedForward = isFirstOfMonth && workerId ? getCarriedForwardBalance(workerId, new Date(date)) : 0;
  const hasNotes = specialNotes && specialNotes.length > 0;
  
  return (
    <div style={{ position: 'relative' }}>
      <button
        onClick={() => {
          if (isFuture || !isCurrentMonth) return;
          // Priority: Special Notes > Carry Forward > Attendance Menu
          if (hasNotes) {
            setShowNotes(true);
          } else if (isFirstOfMonth && carriedForward !== 0) {
            setShowCarryForward(true);
          } else {
            setShowMenu(!showMenu);
          }
        }}
        style={{
          width: '100%',
          aspectRatio: '1',
          display: 'flex',
          flexDirection: 'column',
          alignItems: 'center',
          justifyContent: 'center',
          fontSize: '11px',
          borderRadius: '8px',
          border: isToday ? '2px solid #0077b6' : 
                 hasNotes ? '2px solid #9b59b6' :
                 isFirstOfMonth && carriedForward !== 0 ? '2px solid #f39c12' : '1px solid #e0e0e0',
          background: !isCurrentMonth ? '#fafafa' :
            isFuture ? '#f8f9fa' : 
            status === 'present' ? '#1e7d32' :      // Dark green
            status === 'half_day' ? '#f9a825' :     // Dark yellow
            status === 'absent' ? '#b71c1c' : 'white',  // Blood red
          color: !isCurrentMonth ? '#bdc3c7' : 
                 isFuture ? '#bdc3c7' : 
                 (status === 'present' || status === 'half_day' || status === 'absent') ? 'white' : '#2c3e50',
          fontWeight: '600',
          cursor: (isFuture || !isCurrentMonth) ? 'not-allowed' : 'pointer',
          transition: 'all 0.2s',
          position: 'relative',
          padding: '4px',
          opacity: !isCurrentMonth ? 0.4 : 1
        }}
      >
        {/* Big notepad icon in top right corner for special notes */}
        {hasNotes && isCurrentMonth && (
          <div style={{ 
            position: 'absolute',
            top: '0',
            right: '0',
            background: '#9b59b6',
            borderRadius: '0 8px 0 8px',
            padding: '2px 4px',
            fontSize: '14px',
            lineHeight: '1',
            color: 'white',
            boxShadow: '0 2px 4px rgba(155,89,182,0.4)',
            zIndex: 2,
            display: 'flex',
            alignItems: 'center',
            justifyContent: 'center'
          }}>
            ðŸ“
          </div>
        )}
        
        <div>{day}</div>
        {status && !isFuture && isCurrentMonth && (
          <div style={{ fontSize: '9px', marginTop: '2px' }}>
            {status === 'present' ? 'â—' : status === 'half_day' ? 'â—' : 'â—‹'}
          </div>
        )}
        {!hasNotes && isFirstOfMonth && carriedForward !== 0 && isCurrentMonth && (
          <div style={{ fontSize: '8px', marginTop: '1px', color: '#f39c12' }}>
            ðŸ’°
          </div>
        )}
      </button>
      
      {/* Special Notes Display */}
      {showNotes && hasNotes && (
        <>
          <div 
            style={{
              position: 'fixed',
              top: 0,
              left: 0,
              right: 0,
              bottom: 0,
              zIndex: 999
            }}
            onClick={() => setShowNotes(false)}
          />
          <div style={{
            position: 'absolute',
            top: '100%',
            left: '50%',
            transform: 'translateX(-50%)',
            marginTop: '4px',
            background: 'white',
            borderRadius: '12px',
            boxShadow: '0 4px 16px rgba(0,0,0,0.2)',
            zIndex: 1000,
            minWidth: '200px',
            maxWidth: '250px',
            overflow: 'hidden',
            border: '2px solid #9b59b6'
          }}>
            <div style={{
              padding: '12px',
              background: '#f4ecf7',
              borderBottom: '1px solid #9b59b6'
            }}>
              <div style={{ fontSize: '13px', fontWeight: '700', color: '#6c3483', marginBottom: '4px' }}>
                ðŸ“ Special Note
              </div>
              <div style={{ fontSize: '11px', color: '#6c3483' }}>
                {new Date(date).toLocaleDateString('en-IN', { day: 'numeric', month: 'short', year: 'numeric' })}
              </div>
            </div>
            <div style={{
              padding: '12px',
              maxHeight: '150px',
              overflowY: 'auto'
            }}>
              {specialNotes.map((note, index) => (
                <div key={note.id} style={{
                  fontSize: '13px',
                  color: '#2c3e50',
                  lineHeight: '1.5',
                  marginBottom: index < specialNotes.length - 1 ? '8px' : '0',
                  paddingBottom: index < specialNotes.length - 1 ? '8px' : '0',
                  borderBottom: index < specialNotes.length - 1 ? '1px solid #e0e0e0' : 'none'
                }}>
                  {note.note}
                </div>
              ))}
            </div>
            <button
              onClick={() => {
                setShowNotes(false);
                if (isFirstOfMonth && carriedForward !== 0) {
                  setShowCarryForward(true);
                } else {
                  setShowMenu(true);
                }
              }}
              style={{
                width: '100%',
                padding: '10px',
                border: 'none',
                background: '#9b59b6',
                color: 'white',
                fontSize: '13px',
                fontWeight: '600',
                cursor: 'pointer'
              }}
            >
              Mark Attendance
            </button>
          </div>
        </>
      )}
      
      {/* Carry Forward Notification */}
      {showCarryForward && isFirstOfMonth && (
        <>
          <div 
            style={{
              position: 'fixed',
              top: 0,
              left: 0,
              right: 0,
              bottom: 0,
              zIndex: 999
            }}
            onClick={() => setShowCarryForward(false)}
          />
          <div style={{
            position: 'absolute',
            top: '100%',
            left: '50%',
            transform: 'translateX(-50%)',
            marginTop: '4px',
            background: 'white',
            borderRadius: '12px',
            boxShadow: '0 4px 16px rgba(0,0,0,0.2)',
            zIndex: 1000,
            minWidth: '180px',
            overflow: 'hidden',
            border: '2px solid #f39c12'
          }}>
            <div style={{
              padding: '12px',
              background: '#fff3cd',
              borderBottom: '1px solid #f39c12'
            }}>
              <div style={{ fontSize: '13px', fontWeight: '700', color: '#856404', marginBottom: '4px' }}>
                ðŸ’° Opening Balance (O)
              </div>
              <div style={{ fontSize: '12px', color: '#856404' }}>
                {(() => {
                  const currentDate = new Date(date);
                  const monthNames = ['January', 'February', 'March', 'April', 'May', 'June', 
                                     'July', 'August', 'September', 'October', 'November', 'December'];
                  return `For ${monthNames[currentDate.getMonth()]} ${currentDate.getFullYear()}`;
                })()}
              </div>
            </div>
            <div style={{
              padding: '12px'
            }}>
              <div style={{ 
                fontSize: '24px', 
                fontWeight: '700',
                color: carriedForward > 0 ? '#0077b6' : '#e74c3c',
                textAlign: 'center'
              }}>
                â‚¹{Math.round(carriedForward)}
              </div>
              <div style={{ 
                fontSize: '11px', 
                color: '#7f8c8d',
                textAlign: 'center',
                marginTop: '4px',
                lineHeight: '1.4'
              }}>
                {carriedForward > 0 
                  ? 'Amount owed to worker' 
                  : 'Worker advance received'}
              </div>
            </div>
            <button
              onClick={() => {
                setShowCarryForward(false);
                setShowMenu(true);
              }}
              style={{
                width: '100%',
                padding: '10px',
                border: 'none',
                background: '#f39c12',
                color: 'white',
                fontSize: '13px',
                fontWeight: '600',
                cursor: 'pointer'
              }}
            >
              Mark Attendance
            </button>
          </div>
        </>
      )}
      
      {showMenu && !isFuture && isCurrentMonth && (
        <>
          <div 
            style={{
              position: 'fixed',
              top: 0,
              left: 0,
              right: 0,
              bottom: 0,
              zIndex: 999
            }}
            onClick={() => setShowMenu(false)}
          />
          <div style={{
            position: 'absolute',
            top: '100%',
            left: '50%',
            transform: 'translateX(-50%)',
            marginTop: '4px',
            background: 'white',
            borderRadius: '8px',
            boxShadow: '0 4px 12px rgba(0,0,0,0.15)',
            zIndex: 1000,
            minWidth: '100px',
            overflow: 'hidden'
          }}>
            <button
              onClick={() => {
                onClick('present');
                setShowMenu(false);
              }}
              style={{
                width: '100%',
                padding: '10px 12px',
                border: 'none',
                background: status === 'present' ? '#d4edda' : 'white',
                textAlign: 'left',
                fontSize: '13px',
                fontWeight: '600',
                cursor: 'pointer',
                color: '#155724'
              }}
            >
              Full Day
            </button>
            <button
              onClick={() => {
                onClick('half_day');
                setShowMenu(false);
              }}
              style={{
                width: '100%',
                padding: '10px 12px',
                border: 'none',
                background: status === 'half_day' ? '#fff3cd' : 'white',
                textAlign: 'left',
                fontSize: '13px',
                fontWeight: '600',
                cursor: 'pointer',
                color: '#856404',
                borderTop: '1px solid #f0f0f0',
                borderBottom: '1px solid #f0f0f0'
              }}
            >
              Half Day
            </button>
            <button
              onClick={() => {
                onClick('absent');
                setShowMenu(false);
              }}
              style={{
                width: '100%',
                padding: '10px 12px',
                border: 'none',
                background: status === 'absent' ? '#f8d7da' : 'white',
                textAlign: 'left',
                fontSize: '13px',
                fontWeight: '600',
                cursor: 'pointer',
                color: '#721c24'
              }}
            >
              Absent
            </button>
          </div>
        </>
      )}
    </div>
  );
}

function AttendanceCell({ status, onClick, date }) {
  const [showMenu, setShowMenu] = useState(false);
  
  return (
    <div style={{ position: 'relative' }}>
      <button
        onClick={() => setShowMenu(!showMenu)}
        style={{
          width: '100%',
          aspectRatio: '1',
          minHeight: '45px',
          border: '1px solid #e0e0e0',
          borderRadius: '8px',
          background: status === 'present' ? '#d4edda' : 
                      status === 'half_day' ? '#fff3cd' : 
                      status === 'absent' ? '#f8d7da' : 'white',
          cursor: 'pointer',
          fontSize: '16px',
          display: 'flex',
          alignItems: 'center',
          justifyContent: 'center',
          transition: 'all 0.2s'
        }}
      >
        {status === 'present' ? 'âœ“' : status === 'half_day' ? 'Â½' : status === 'absent' ? 'âœ—' : 'âˆ’'}
      </button>
      
      {showMenu && (
        <>
          <div 
            style={{
              position: 'fixed',
              top: 0,
              left: 0,
              right: 0,
              bottom: 0,
              zIndex: 999
            }}
            onClick={() => setShowMenu(false)}
          />
          <div style={{
            position: 'absolute',
            top: '100%',
            left: '50%',
            transform: 'translateX(-50%)',
            marginTop: '4px',
            background: 'white',
            borderRadius: '8px',
            boxShadow: '0 4px 12px rgba(0,0,0,0.15)',
            zIndex: 1000,
            minWidth: '100px',
            overflow: 'hidden'
          }}>
            <button
              onClick={() => {
                onClick('present');
                setShowMenu(false);
              }}
              style={{
                width: '100%',
                padding: '10px 12px',
                border: 'none',
                background: status === 'present' ? '#d4edda' : 'white',
                textAlign: 'left',
                fontSize: '13px',
                fontWeight: '600',
                cursor: 'pointer',
                color: '#155724'
              }}
            >
              Full Day
            </button>
            <button
              onClick={() => {
                onClick('half_day');
                setShowMenu(false);
              }}
              style={{
                width: '100%',
                padding: '10px 12px',
                border: 'none',
                background: status === 'half_day' ? '#fff3cd' : 'white',
                textAlign: 'left',
                fontSize: '13px',
                fontWeight: '600',
                cursor: 'pointer',
                color: '#856404',
                borderTop: '1px solid #f0f0f0',
                borderBottom: '1px solid #f0f0f0'
              }}
            >
              Half Day
            </button>
            <button
              onClick={() => {
                onClick('absent');
                setShowMenu(false);
              }}
              style={{
                width: '100%',
                padding: '10px 12px',
                border: 'none',
                background: status === 'absent' ? '#f8d7da' : 'white',
                textAlign: 'left',
                fontSize: '13px',
                fontWeight: '600',
                cursor: 'pointer',
                color: '#721c24'
              }}
            >
              Absent
            </button>
          </div>
        </>
      )}
    </div>
  );
}

function StatCard({ icon, label, value, color }) {
  return (
    <div style={{
      background: 'white',
      borderRadius: '16px',
      padding: '20px',
      boxShadow: '0 2px 12px rgba(0,0,0,0.08)'
    }}>
      <div style={{
        width: '40px',
        height: '40px',
        borderRadius: '12px',
        background: `${color}15`,
        color: color,
        display: 'flex',
        alignItems: 'center',
        justifyContent: 'center',
        marginBottom: '12px'
      }}>
        {icon}
      </div>
      <div style={{
        fontSize: '13px',
        color: '#7f8c8d',
        marginBottom: '4px',
        fontWeight: '500'
      }}>
        {label}
      </div>
      <div style={{
        fontSize: '22px',
        fontWeight: '700',
        color: '#2c3e50'
      }}>
        {value}
      </div>
    </div>
  );
}

function ActionButton({ icon, label, onClick, color }) {
  return (
    <button
      onClick={onClick}
      style={{
        width: '100%',
        padding: '18px',
        border: `2px solid ${color}30`,
        background: `linear-gradient(135deg, ${color}15 0%, ${color}25 100%)`,
        borderRadius: '14px',
        display: 'flex',
        alignItems: 'center',
        justifyContent: 'space-between',
        cursor: 'pointer',
        transition: 'all 0.2s',
        boxShadow: `0 4px 12px ${color}20`
      }}
      onMouseDown={(e) => e.currentTarget.style.transform = 'scale(0.98)'}
      onMouseUp={(e) => e.currentTarget.style.transform = 'scale(1)'}
      onMouseLeave={(e) => e.currentTarget.style.transform = 'scale(1)'}
    >
      <div style={{ display: 'flex', alignItems: 'center', gap: '14px' }}>
        <div style={{
          width: '50px',
          height: '50px',
          borderRadius: '12px',
          background: `linear-gradient(135deg, ${color} 0%, ${color}dd 100%)`,
          color: 'white',
          display: 'flex',
          alignItems: 'center',
          justifyContent: 'center',
          fontSize: '24px',
          boxShadow: `0 4px 8px ${color}40`
        }}>
          {icon}
        </div>
        <span style={{ fontSize: '17px', fontWeight: '700', color: '#2c3e50' }}>
          {label}
        </span>
      </div>
      <span style={{fontSize:"24px"}}>â€º</span>
    </button>
  );
}

function NavButton({ icon, label, active, onClick, isEmoji }) {
  return (
    <button
      onClick={onClick}
      style={{
        background: active ? 'rgba(139,111,71,0.1)' : 'none',
        border: 'none',
        borderLeft: active ? '3px solid #8b6f47' : '3px solid transparent',
        display: 'flex',
        flexDirection: 'column',
        alignItems: 'center',
        gap: '4px',
        cursor: 'pointer',
        padding: '12px 4px',
        color: active ? '#8b6f47' : '#7f8c8d',
        transition: 'all 0.2s',
        minWidth: 0,
        width: '100%'
      }}
    >
      {isEmoji ? (
        <span style={{ fontSize: '22px' }}>{icon}</span>
      ) : (
        <div style={{ transform: 'scale(1.1)' }}>{icon}</div>
      )}
      <span style={{
        fontSize: '10px',
        fontWeight: active ? '700' : '500',
        whiteSpace: 'nowrap',
        textAlign: 'center',
        lineHeight: '1.2'
      }}>
        {label}
      </span>
    </button>
  );
}

// Render the application
if (typeof ReactDOM !== 'undefined' && document.getElementById('root')) {
  ReactDOM.render(
    React.createElement(FarmWageManager),
    document.getElementById('root')
  );
}
  </script>
  <script>
    window.addEventListener('load',()=>{setTimeout(()=>{const l=document.getElementById('loading');if(l)l.style.display='none';},500);});
    if('serviceWorker'in navigator){window.addEventListener('load',()=>{navigator.serviceWorker.register('https://apphosting-vh.github.io/farmxv9/sw.js').then(r=>console.log('SW registered')).catch(e=>console.log('SW failed:',e));});}
  </script>
</body>
</html>
